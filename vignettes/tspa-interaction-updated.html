<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="Jimmy Zhang" />

<meta name="date" content="2024-10-06" />

<title>tspa-interaction</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
</style>



<style type="text/css">
code {
white-space: pre;
}
.sourceCode {
overflow: visible;
}
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
{ counter-reset: source-line 0; }
pre.numberSource code > span
{ position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
{ content: counter(source-line);
position: relative; left: -1em; text-align: right; vertical-align: baseline;
border: none; display: inline-block;
-webkit-touch-callout: none; -webkit-user-select: none;
-khtml-user-select: none; -moz-user-select: none;
-ms-user-select: none; user-select: none;
padding: 0 4px; width: 4em;
color: #aaaaaa;
}
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa; padding-left: 4px; }
div.sourceCode
{ }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } 
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.at { color: #7d9029; } 
code span.bn { color: #40a070; } 
code span.bu { color: #008000; } 
code span.cf { color: #007020; font-weight: bold; } 
code span.ch { color: #4070a0; } 
code span.cn { color: #880000; } 
code span.co { color: #60a0b0; font-style: italic; } 
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.do { color: #ba2121; font-style: italic; } 
code span.dt { color: #902000; } 
code span.dv { color: #40a070; } 
code span.er { color: #ff0000; font-weight: bold; } 
code span.ex { } 
code span.fl { color: #40a070; } 
code span.fu { color: #06287e; } 
code span.im { color: #008000; font-weight: bold; } 
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.kw { color: #007020; font-weight: bold; } 
code span.op { color: #666666; } 
code span.ot { color: #007020; } 
code span.pp { color: #bc7a00; } 
code span.sc { color: #4070a0; } 
code span.ss { color: #bb6688; } 
code span.st { color: #4070a0; } 
code span.va { color: #19177c; } 
code span.vs { color: #4070a0; } 
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } 
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">tspa-interaction</h1>
<h4 class="author">Jimmy Zhang</h4>
<h4 class="date">2024-10-06</h4>



<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="fu">library</span>(lavaan)</span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a><span class="co">#&gt; This is lavaan 0.6-18</span></span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a><span class="co">#&gt; lavaan is FREE software! Please report any bugs.</span></span>
<span id="cb1-4"><a href="#cb1-4" tabindex="-1"></a><span class="fu">library</span>(semTools)</span>
<span id="cb1-5"><a href="#cb1-5" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb1-6"><a href="#cb1-6" tabindex="-1"></a><span class="co">#&gt; ###############################################################################</span></span>
<span id="cb1-7"><a href="#cb1-7" tabindex="-1"></a><span class="co">#&gt; This is semTools 0.5-6</span></span>
<span id="cb1-8"><a href="#cb1-8" tabindex="-1"></a><span class="co">#&gt; All users of R (or SEM) are invited to submit functions or ideas for functions.</span></span>
<span id="cb1-9"><a href="#cb1-9" tabindex="-1"></a><span class="co">#&gt; ###############################################################################</span></span>
<span id="cb1-10"><a href="#cb1-10" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb1-11"><a href="#cb1-11" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb1-12"><a href="#cb1-12" tabindex="-1"></a><span class="co">#&gt; Attaching package: &#39;dplyr&#39;</span></span>
<span id="cb1-13"><a href="#cb1-13" tabindex="-1"></a><span class="co">#&gt; The following objects are masked from &#39;package:stats&#39;:</span></span>
<span id="cb1-14"><a href="#cb1-14" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb1-15"><a href="#cb1-15" tabindex="-1"></a><span class="co">#&gt;     filter, lag</span></span>
<span id="cb1-16"><a href="#cb1-16" tabindex="-1"></a><span class="co">#&gt; The following objects are masked from &#39;package:base&#39;:</span></span>
<span id="cb1-17"><a href="#cb1-17" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb1-18"><a href="#cb1-18" tabindex="-1"></a><span class="co">#&gt;     intersect, setdiff, setequal, union</span></span>
<span id="cb1-19"><a href="#cb1-19" tabindex="-1"></a><span class="fu">library</span>(mnormt)</span>
<span id="cb1-20"><a href="#cb1-20" tabindex="-1"></a><span class="fu">library</span>(here)</span>
<span id="cb1-21"><a href="#cb1-21" tabindex="-1"></a><span class="co">#&gt; here() starts at /Users/jimmy_z/R Projects/2SPA-Int</span></span>
<span id="cb1-22"><a href="#cb1-22" tabindex="-1"></a><span class="fu">library</span>(semlrtp)</span>
<span id="cb1-23"><a href="#cb1-23" tabindex="-1"></a><span class="fu">library</span>(modsem)</span>
<span id="cb1-24"><a href="#cb1-24" tabindex="-1"></a>r_scripts <span class="ot">&lt;-</span> <span class="fu">list.files</span>(<span class="fu">here</span>(<span class="st">&quot;R&quot;</span>), <span class="at">pattern =</span> <span class="st">&quot;</span><span class="sc">\\</span><span class="st">.R$&quot;</span>, <span class="at">full.names =</span> <span class="cn">TRUE</span>)</span>
<span id="cb1-25"><a href="#cb1-25" tabindex="-1"></a><span class="fu">lapply</span>(r_scripts, source)</span>
<span id="cb1-26"><a href="#cb1-26" tabindex="-1"></a><span class="co">#&gt; [[1]]</span></span>
<span id="cb1-27"><a href="#cb1-27" tabindex="-1"></a><span class="co">#&gt; [[1]]$value</span></span>
<span id="cb1-28"><a href="#cb1-28" tabindex="-1"></a><span class="co">#&gt; function (fit, method = c(&quot;regression&quot;, &quot;Bartlett&quot;)) </span></span>
<span id="cb1-29"><a href="#cb1-29" tabindex="-1"></a><span class="co">#&gt; {</span></span>
<span id="cb1-30"><a href="#cb1-30" tabindex="-1"></a><span class="co">#&gt;     method &lt;- match.arg(method)</span></span>
<span id="cb1-31"><a href="#cb1-31" tabindex="-1"></a><span class="co">#&gt;     jac &lt;- compute_grad_ld_evfs(fit, method = method)</span></span>
<span id="cb1-32"><a href="#cb1-32" tabindex="-1"></a><span class="co">#&gt;     jac %*% lavaan::vcov(fit) %*% t(jac)</span></span>
<span id="cb1-33"><a href="#cb1-33" tabindex="-1"></a><span class="co">#&gt; }</span></span>
<span id="cb1-34"><a href="#cb1-34" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb1-35"><a href="#cb1-35" tabindex="-1"></a><span class="co">#&gt; [[1]]$visible</span></span>
<span id="cb1-36"><a href="#cb1-36" tabindex="-1"></a><span class="co">#&gt; [1] FALSE</span></span>
<span id="cb1-37"><a href="#cb1-37" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb1-38"><a href="#cb1-38" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb1-39"><a href="#cb1-39" tabindex="-1"></a><span class="co">#&gt; [[2]]</span></span>
<span id="cb1-40"><a href="#cb1-40" tabindex="-1"></a><span class="co">#&gt; [[2]]$value</span></span>
<span id="cb1-41"><a href="#cb1-41" tabindex="-1"></a><span class="co">#&gt; function (model, data) </span></span>
<span id="cb1-42"><a href="#cb1-42" tabindex="-1"></a><span class="co">#&gt; {</span></span>
<span id="cb1-43"><a href="#cb1-43" tabindex="-1"></a><span class="co">#&gt;     pairs &lt;- parseInteractionTerms(model)</span></span>
<span id="cb1-44"><a href="#cb1-44" tabindex="-1"></a><span class="co">#&gt;     pairs_count &lt;- length(pairs)</span></span>
<span id="cb1-45"><a href="#cb1-45" tabindex="-1"></a><span class="co">#&gt;     updated_data &lt;- data</span></span>
<span id="cb1-46"><a href="#cb1-46" tabindex="-1"></a><span class="co">#&gt;     column_names &lt;- colnames(updated_data)</span></span>
<span id="cb1-47"><a href="#cb1-47" tabindex="-1"></a><span class="co">#&gt;     get_fs_int &lt;- function(pairs, updated_data) {</span></span>
<span id="cb1-48"><a href="#cb1-48" tabindex="-1"></a><span class="co">#&gt;         fs_int &lt;- updated_data[, paste0(&quot;fs_&quot;, pairs[[1]][1])] * </span></span>
<span id="cb1-49"><a href="#cb1-49" tabindex="-1"></a><span class="co">#&gt;             updated_data[, paste0(&quot;fs_&quot;, pairs[[1]][2])]</span></span>
<span id="cb1-50"><a href="#cb1-50" tabindex="-1"></a><span class="co">#&gt;         fs_int &lt;- fs_int - mean(fs_int)</span></span>
<span id="cb1-51"><a href="#cb1-51" tabindex="-1"></a><span class="co">#&gt;         return(fs_int)</span></span>
<span id="cb1-52"><a href="#cb1-52" tabindex="-1"></a><span class="co">#&gt;     }</span></span>
<span id="cb1-53"><a href="#cb1-53" tabindex="-1"></a><span class="co">#&gt;     get_fs_int_se &lt;- function(pairs, updated_data) {</span></span>
<span id="cb1-54"><a href="#cb1-54" tabindex="-1"></a><span class="co">#&gt;         fs_int_se &lt;- sqrt(1 * updated_data[, paste0(&quot;fs_&quot;, pairs[[1]][1], </span></span>
<span id="cb1-55"><a href="#cb1-55" tabindex="-1"></a><span class="co">#&gt;             &quot;_se&quot;)][1]^2 + 1 * updated_data[, paste0(&quot;fs_&quot;, pairs[[1]][2], </span></span>
<span id="cb1-56"><a href="#cb1-56" tabindex="-1"></a><span class="co">#&gt;             &quot;_se&quot;)][1]^2 + updated_data[, paste0(&quot;fs_&quot;, pairs[[1]][1], </span></span>
<span id="cb1-57"><a href="#cb1-57" tabindex="-1"></a><span class="co">#&gt;             &quot;_se&quot;)][1]^2 * updated_data[, paste0(&quot;fs_&quot;, pairs[[1]][2], </span></span>
<span id="cb1-58"><a href="#cb1-58" tabindex="-1"></a><span class="co">#&gt;             &quot;_se&quot;)][1]^2)</span></span>
<span id="cb1-59"><a href="#cb1-59" tabindex="-1"></a><span class="co">#&gt;         fs_int_se &lt;- matrix(rep(fs_int_se, nrow(updated_data)))</span></span>
<span id="cb1-60"><a href="#cb1-60" tabindex="-1"></a><span class="co">#&gt;         return(fs_int_se)</span></span>
<span id="cb1-61"><a href="#cb1-61" tabindex="-1"></a><span class="co">#&gt;     }</span></span>
<span id="cb1-62"><a href="#cb1-62" tabindex="-1"></a><span class="co">#&gt;     while (pairs_count &gt; 0) {</span></span>
<span id="cb1-63"><a href="#cb1-63" tabindex="-1"></a><span class="co">#&gt;         updated_data &lt;- cbind(updated_data, get_fs_int(pairs, </span></span>
<span id="cb1-64"><a href="#cb1-64" tabindex="-1"></a><span class="co">#&gt;             updated_data), get_fs_int_se(pairs, updated_data))</span></span>
<span id="cb1-65"><a href="#cb1-65" tabindex="-1"></a><span class="co">#&gt;         colnames(updated_data) &lt;- c(column_names, paste0(&quot;fs_&quot;, </span></span>
<span id="cb1-66"><a href="#cb1-66" tabindex="-1"></a><span class="co">#&gt;             paste(pairs[[pairs_count]], collapse = &quot;.&quot;)), paste0(&quot;fs_&quot;, </span></span>
<span id="cb1-67"><a href="#cb1-67" tabindex="-1"></a><span class="co">#&gt;             paste(pairs[[pairs_count]], collapse = &quot;.&quot;), &quot;_se&quot;))</span></span>
<span id="cb1-68"><a href="#cb1-68" tabindex="-1"></a><span class="co">#&gt;         pairs_count &lt;- pairs_count - 1</span></span>
<span id="cb1-69"><a href="#cb1-69" tabindex="-1"></a><span class="co">#&gt;     }</span></span>
<span id="cb1-70"><a href="#cb1-70" tabindex="-1"></a><span class="co">#&gt;     updated_data &lt;- updated_data %&gt;% select_if(~!any(is.na(.)))</span></span>
<span id="cb1-71"><a href="#cb1-71" tabindex="-1"></a><span class="co">#&gt;     return(updated_data)</span></span>
<span id="cb1-72"><a href="#cb1-72" tabindex="-1"></a><span class="co">#&gt; }</span></span>
<span id="cb1-73"><a href="#cb1-73" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb1-74"><a href="#cb1-74" tabindex="-1"></a><span class="co">#&gt; [[2]]$visible</span></span>
<span id="cb1-75"><a href="#cb1-75" tabindex="-1"></a><span class="co">#&gt; [1] FALSE</span></span>
<span id="cb1-76"><a href="#cb1-76" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb1-77"><a href="#cb1-77" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb1-78"><a href="#cb1-78" tabindex="-1"></a><span class="co">#&gt; [[3]]</span></span>
<span id="cb1-79"><a href="#cb1-79" tabindex="-1"></a><span class="co">#&gt; [[3]]$value</span></span>
<span id="cb1-80"><a href="#cb1-80" tabindex="-1"></a><span class="co">#&gt; function (model) </span></span>
<span id="cb1-81"><a href="#cb1-81" tabindex="-1"></a><span class="co">#&gt; {</span></span>
<span id="cb1-82"><a href="#cb1-82" tabindex="-1"></a><span class="co">#&gt;     indicators &lt;- function(model) {</span></span>
<span id="cb1-83"><a href="#cb1-83" tabindex="-1"></a><span class="co">#&gt;         model_elements &lt;- unlist(strsplit(model, &quot;\n&quot;))</span></span>
<span id="cb1-84"><a href="#cb1-84" tabindex="-1"></a><span class="co">#&gt;         indicator_terms &lt;- unlist(strsplit(gsub(&quot; &quot;, &quot;&quot;, model_elements[grep(&quot;=~&quot;, </span></span>
<span id="cb1-85"><a href="#cb1-85" tabindex="-1"></a><span class="co">#&gt;             unlist(strsplit(model, &quot;\n&quot;)))]), split = &quot;=~&quot;))</span></span>
<span id="cb1-86"><a href="#cb1-86" tabindex="-1"></a><span class="co">#&gt;         indicator_vars &lt;- indicator_terms[grepl(&quot;+&quot;, indicator_terms, </span></span>
<span id="cb1-87"><a href="#cb1-87" tabindex="-1"></a><span class="co">#&gt;             fixed = TRUE) == &quot;FALSE&quot;]</span></span>
<span id="cb1-88"><a href="#cb1-88" tabindex="-1"></a><span class="co">#&gt;         indicator_items &lt;- indicator_terms[grepl(&quot;+&quot;, indicator_terms, </span></span>
<span id="cb1-89"><a href="#cb1-89" tabindex="-1"></a><span class="co">#&gt;             fixed = TRUE) == &quot;TRUE&quot;]</span></span>
<span id="cb1-90"><a href="#cb1-90" tabindex="-1"></a><span class="co">#&gt;         indicators &lt;- list()</span></span>
<span id="cb1-91"><a href="#cb1-91" tabindex="-1"></a><span class="co">#&gt;         for (i in seq(indicator_items)) {</span></span>
<span id="cb1-92"><a href="#cb1-92" tabindex="-1"></a><span class="co">#&gt;             indicators[[i]] &lt;- unlist(strsplit(indicator_items[[i]], </span></span>
<span id="cb1-93"><a href="#cb1-93" tabindex="-1"></a><span class="co">#&gt;                 split = &quot;+&quot;, fixed = TRUE))</span></span>
<span id="cb1-94"><a href="#cb1-94" tabindex="-1"></a><span class="co">#&gt;             names(indicators)[i] &lt;- paste0(indicator_vars[[i]])</span></span>
<span id="cb1-95"><a href="#cb1-95" tabindex="-1"></a><span class="co">#&gt;         }</span></span>
<span id="cb1-96"><a href="#cb1-96" tabindex="-1"></a><span class="co">#&gt;         return(indicators)</span></span>
<span id="cb1-97"><a href="#cb1-97" tabindex="-1"></a><span class="co">#&gt;     }</span></span>
<span id="cb1-98"><a href="#cb1-98" tabindex="-1"></a><span class="co">#&gt;     indics &lt;- indicators(model)</span></span>
<span id="cb1-99"><a href="#cb1-99" tabindex="-1"></a><span class="co">#&gt;     return(indics)</span></span>
<span id="cb1-100"><a href="#cb1-100" tabindex="-1"></a><span class="co">#&gt; }</span></span>
<span id="cb1-101"><a href="#cb1-101" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb1-102"><a href="#cb1-102" tabindex="-1"></a><span class="co">#&gt; [[3]]$visible</span></span>
<span id="cb1-103"><a href="#cb1-103" tabindex="-1"></a><span class="co">#&gt; [1] FALSE</span></span>
<span id="cb1-104"><a href="#cb1-104" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb1-105"><a href="#cb1-105" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb1-106"><a href="#cb1-106" tabindex="-1"></a><span class="co">#&gt; [[4]]</span></span>
<span id="cb1-107"><a href="#cb1-107" tabindex="-1"></a><span class="co">#&gt; [[4]]$value</span></span>
<span id="cb1-108"><a href="#cb1-108" tabindex="-1"></a><span class="co">#&gt; function (model) </span></span>
<span id="cb1-109"><a href="#cb1-109" tabindex="-1"></a><span class="co">#&gt; {</span></span>
<span id="cb1-110"><a href="#cb1-110" tabindex="-1"></a><span class="co">#&gt;     str_elements &lt;- gsub(&quot; &quot;, &quot;&quot;, unlist(strsplit(unlist(strsplit(model, </span></span>
<span id="cb1-111"><a href="#cb1-111" tabindex="-1"></a><span class="co">#&gt;         split = &quot;\n|=~|~&quot;)), split = &quot;+&quot;, fixed = TRUE)))</span></span>
<span id="cb1-112"><a href="#cb1-112" tabindex="-1"></a><span class="co">#&gt;     inter_terms &lt;- gsub(&quot;\n&quot;, &quot;&quot;, str_elements[intersect(grep(&quot;:&quot;, </span></span>
<span id="cb1-113"><a href="#cb1-113" tabindex="-1"></a><span class="co">#&gt;         str_elements), grep(&quot;:=&quot;, str_elements, invert = T))])</span></span>
<span id="cb1-114"><a href="#cb1-114" tabindex="-1"></a><span class="co">#&gt;     if (grepl(&quot;*&quot;, inter_terms, fixed = TRUE)) {</span></span>
<span id="cb1-115"><a href="#cb1-115" tabindex="-1"></a><span class="co">#&gt;         int_label &lt;- unlist(strsplit(inter_terms, split = &quot;\\*&quot;))[1]</span></span>
<span id="cb1-116"><a href="#cb1-116" tabindex="-1"></a><span class="co">#&gt;         inter_terms &lt;- as.list(unlist(strsplit(inter_terms, split = &quot;\\*&quot;))[2])</span></span>
<span id="cb1-117"><a href="#cb1-117" tabindex="-1"></a><span class="co">#&gt;     }</span></span>
<span id="cb1-118"><a href="#cb1-118" tabindex="-1"></a><span class="co">#&gt;     interpairs &lt;- function(inter_terms) {</span></span>
<span id="cb1-119"><a href="#cb1-119" tabindex="-1"></a><span class="co">#&gt;         inter_vars &lt;- list()</span></span>
<span id="cb1-120"><a href="#cb1-120" tabindex="-1"></a><span class="co">#&gt;         for (i in seq(inter_terms)) {</span></span>
<span id="cb1-121"><a href="#cb1-121" tabindex="-1"></a><span class="co">#&gt;             terms &lt;- strsplit(inter_terms[[i]], split = &quot;:&quot;)</span></span>
<span id="cb1-122"><a href="#cb1-122" tabindex="-1"></a><span class="co">#&gt;             inter_vars[[i]] &lt;- unlist(terms)</span></span>
<span id="cb1-123"><a href="#cb1-123" tabindex="-1"></a><span class="co">#&gt;             names(inter_vars)[i] &lt;- paste0(&quot;inter_pair_&quot;, i)</span></span>
<span id="cb1-124"><a href="#cb1-124" tabindex="-1"></a><span class="co">#&gt;         }</span></span>
<span id="cb1-125"><a href="#cb1-125" tabindex="-1"></a><span class="co">#&gt;         return(inter_vars)</span></span>
<span id="cb1-126"><a href="#cb1-126" tabindex="-1"></a><span class="co">#&gt;     }</span></span>
<span id="cb1-127"><a href="#cb1-127" tabindex="-1"></a><span class="co">#&gt;     pairs &lt;- interpairs(inter_terms)</span></span>
<span id="cb1-128"><a href="#cb1-128" tabindex="-1"></a><span class="co">#&gt;     return(pairs)</span></span>
<span id="cb1-129"><a href="#cb1-129" tabindex="-1"></a><span class="co">#&gt; }</span></span>
<span id="cb1-130"><a href="#cb1-130" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb1-131"><a href="#cb1-131" tabindex="-1"></a><span class="co">#&gt; [[4]]$visible</span></span>
<span id="cb1-132"><a href="#cb1-132" tabindex="-1"></a><span class="co">#&gt; [1] FALSE</span></span>
<span id="cb1-133"><a href="#cb1-133" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb1-134"><a href="#cb1-134" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb1-135"><a href="#cb1-135" tabindex="-1"></a><span class="co">#&gt; [[5]]</span></span>
<span id="cb1-136"><a href="#cb1-136" tabindex="-1"></a><span class="co">#&gt; [[5]]$value</span></span>
<span id="cb1-137"><a href="#cb1-137" tabindex="-1"></a><span class="co">#&gt; function (model, data, ...) </span></span>
<span id="cb1-138"><a href="#cb1-138" tabindex="-1"></a><span class="co">#&gt; {</span></span>
<span id="cb1-139"><a href="#cb1-139" tabindex="-1"></a><span class="co">#&gt;     processData &lt;- function(data, pairs, indics) {</span></span>
<span id="cb1-140"><a href="#cb1-140" tabindex="-1"></a><span class="co">#&gt;         data_centered &lt;- data %&gt;% mutate(across(unname(unlist(indics)), </span></span>
<span id="cb1-141"><a href="#cb1-141" tabindex="-1"></a><span class="co">#&gt;             ~. - mean(., na.rm = T)))</span></span>
<span id="cb1-142"><a href="#cb1-142" tabindex="-1"></a><span class="co">#&gt;         for (i in seq_along(pairs)) {</span></span>
<span id="cb1-143"><a href="#cb1-143" tabindex="-1"></a><span class="co">#&gt;             pair_name &lt;- unname(unlist(pairs))</span></span>
<span id="cb1-144"><a href="#cb1-144" tabindex="-1"></a><span class="co">#&gt;             first_set &lt;- indics[[pair_name[1]]]</span></span>
<span id="cb1-145"><a href="#cb1-145" tabindex="-1"></a><span class="co">#&gt;             second_set &lt;- indics[[pair_name[2]]]</span></span>
<span id="cb1-146"><a href="#cb1-146" tabindex="-1"></a><span class="co">#&gt;             first_mean &lt;- paste0(pair_name[1], &quot;_mean&quot;)</span></span>
<span id="cb1-147"><a href="#cb1-147" tabindex="-1"></a><span class="co">#&gt;             second_mean &lt;- paste0(pair_name[2], &quot;_mean&quot;)</span></span>
<span id="cb1-148"><a href="#cb1-148" tabindex="-1"></a><span class="co">#&gt;             data_centered &lt;- data_centered %&gt;% rowwise %&gt;% mutate(`:=`(!!first_mean, </span></span>
<span id="cb1-149"><a href="#cb1-149" tabindex="-1"></a><span class="co">#&gt;                 mean(c_across(all_of(first_set)), na.rm = TRUE)), </span></span>
<span id="cb1-150"><a href="#cb1-150" tabindex="-1"></a><span class="co">#&gt;                 `:=`(!!second_mean, mean(c_across(all_of(second_set)), </span></span>
<span id="cb1-151"><a href="#cb1-151" tabindex="-1"></a><span class="co">#&gt;                   na.rm = TRUE))) %&gt;% ungroup()</span></span>
<span id="cb1-152"><a href="#cb1-152" tabindex="-1"></a><span class="co">#&gt;             int_name &lt;- paste0(pair_name[1], &quot;_int_&quot;, pair_name[2])</span></span>
<span id="cb1-153"><a href="#cb1-153" tabindex="-1"></a><span class="co">#&gt;             data_centered &lt;- data_centered %&gt;% mutate(`:=`(!!int_name, </span></span>
<span id="cb1-154"><a href="#cb1-154" tabindex="-1"></a><span class="co">#&gt;                 !!sym(first_mean) * !!sym(second_mean)))</span></span>
<span id="cb1-155"><a href="#cb1-155" tabindex="-1"></a><span class="co">#&gt;         }</span></span>
<span id="cb1-156"><a href="#cb1-156" tabindex="-1"></a><span class="co">#&gt;         return(data_centered)</span></span>
<span id="cb1-157"><a href="#cb1-157" tabindex="-1"></a><span class="co">#&gt;     }</span></span>
<span id="cb1-158"><a href="#cb1-158" tabindex="-1"></a><span class="co">#&gt;     user_alpha &lt;- function(x) {</span></span>
<span id="cb1-159"><a href="#cb1-159" tabindex="-1"></a><span class="co">#&gt;         covx &lt;- cov(x, use = &quot;complete.obs&quot;)</span></span>
<span id="cb1-160"><a href="#cb1-160" tabindex="-1"></a><span class="co">#&gt;         p &lt;- ncol(x)</span></span>
<span id="cb1-161"><a href="#cb1-161" tabindex="-1"></a><span class="co">#&gt;         p/(p - 1) * (1 - sum(diag(covx))/sum(covx))</span></span>
<span id="cb1-162"><a href="#cb1-162" tabindex="-1"></a><span class="co">#&gt;     }</span></span>
<span id="cb1-163"><a href="#cb1-163" tabindex="-1"></a><span class="co">#&gt;     pairs &lt;- parseInteractionTerms(model)</span></span>
<span id="cb1-164"><a href="#cb1-164" tabindex="-1"></a><span class="co">#&gt;     indics &lt;- parseIndicators(model)</span></span>
<span id="cb1-165"><a href="#cb1-165" tabindex="-1"></a><span class="co">#&gt;     pairs_count &lt;- length(pairs)</span></span>
<span id="cb1-166"><a href="#cb1-166" tabindex="-1"></a><span class="co">#&gt;     data_int &lt;- processData(data, pairs, indics)</span></span>
<span id="cb1-167"><a href="#cb1-167" tabindex="-1"></a><span class="co">#&gt;     first_rel &lt;- user_alpha(data_int[, unlist(indics[1])])</span></span>
<span id="cb1-168"><a href="#cb1-168" tabindex="-1"></a><span class="co">#&gt;     second_rel &lt;- user_alpha(data_int[, unlist(indics[2])])</span></span>
<span id="cb1-169"><a href="#cb1-169" tabindex="-1"></a><span class="co">#&gt;     lat_names &lt;- c(pairs[[1]], paste0(pairs[[1]], collapse = &quot;_&quot;))</span></span>
<span id="cb1-170"><a href="#cb1-170" tabindex="-1"></a><span class="co">#&gt;     obs_names &lt;- setdiff(colnames(data_int), colnames(data))</span></span>
<span id="cb1-171"><a href="#cb1-171" tabindex="-1"></a><span class="co">#&gt;     def_lab &lt;- sub(&quot;.*~~\\s*(\\w+)\\*.*&quot;, &quot;\\1&quot;, trimws(unlist(strsplit(model, </span></span>
<span id="cb1-172"><a href="#cb1-172" tabindex="-1"></a><span class="co">#&gt;         split = &quot;\n&quot;))[grep(&quot;~~&quot;, unlist(strsplit(model, split = &quot;\n&quot;)), </span></span>
<span id="cb1-173"><a href="#cb1-173" tabindex="-1"></a><span class="co">#&gt;         fixed = TRUE)]))</span></span>
<span id="cb1-174"><a href="#cb1-174" tabindex="-1"></a><span class="co">#&gt;     fac_cstr &lt;- vector()</span></span>
<span id="cb1-175"><a href="#cb1-175" tabindex="-1"></a><span class="co">#&gt;     ev_cstr &lt;- vector()</span></span>
<span id="cb1-176"><a href="#cb1-176" tabindex="-1"></a><span class="co">#&gt;     err_cstr &lt;- vector()</span></span>
<span id="cb1-177"><a href="#cb1-177" tabindex="-1"></a><span class="co">#&gt;     for (x in 1:length(lat_names)) {</span></span>
<span id="cb1-178"><a href="#cb1-178" tabindex="-1"></a><span class="co">#&gt;         fac_cstr[x] &lt;- paste0(lat_names[x], &quot; =~ &quot;, &quot;1 * &quot;, obs_names[x], </span></span>
<span id="cb1-179"><a href="#cb1-179" tabindex="-1"></a><span class="co">#&gt;             &quot;\n&quot;)</span></span>
<span id="cb1-180"><a href="#cb1-180" tabindex="-1"></a><span class="co">#&gt;         ev_cstr[x] &lt;- paste0(obs_names[x], &quot; ~~ &quot;, &quot;ev_&quot;, lat_names[x], </span></span>
<span id="cb1-181"><a href="#cb1-181" tabindex="-1"></a><span class="co">#&gt;             &quot; * &quot;, obs_names[x], &quot;\n&quot;)</span></span>
<span id="cb1-182"><a href="#cb1-182" tabindex="-1"></a><span class="co">#&gt;         err_cstr[x] &lt;- paste0(&quot;ev_&quot;, lat_names[x], &quot; == &quot;, &quot;(1 - &quot;, </span></span>
<span id="cb1-183"><a href="#cb1-183" tabindex="-1"></a><span class="co">#&gt;             lat_names[x], &quot;_rel) * &quot;, def_lab[x], &quot; / &quot;, lat_names[x], </span></span>
<span id="cb1-184"><a href="#cb1-184" tabindex="-1"></a><span class="co">#&gt;             &quot;_rel\n&quot;)</span></span>
<span id="cb1-185"><a href="#cb1-185" tabindex="-1"></a><span class="co">#&gt;     }</span></span>
<span id="cb1-186"><a href="#cb1-186" tabindex="-1"></a><span class="co">#&gt;     err_cstr[3] &lt;- paste0(&quot;ev_&quot;, lat_names[3], &quot; == &quot;, &quot;ev_&quot;, </span></span>
<span id="cb1-187"><a href="#cb1-187" tabindex="-1"></a><span class="co">#&gt;         lat_names[1], &quot; * &quot;, def_lab[2], &quot; + &quot;, &quot;ev_&quot;, lat_names[2], </span></span>
<span id="cb1-188"><a href="#cb1-188" tabindex="-1"></a><span class="co">#&gt;         &quot; * &quot;, def_lab[1], &quot; + &quot;, &quot;ev_&quot;, lat_names[1], &quot; * &quot;, </span></span>
<span id="cb1-189"><a href="#cb1-189" tabindex="-1"></a><span class="co">#&gt;         &quot;ev_&quot;, lat_names[2])</span></span>
<span id="cb1-190"><a href="#cb1-190" tabindex="-1"></a><span class="co">#&gt;     if (length(setdiff(names(indics), lat_names)) &gt; 0) {</span></span>
<span id="cb1-191"><a href="#cb1-191" tabindex="-1"></a><span class="co">#&gt;         dep_name &lt;- setdiff(names(indics), lat_names)</span></span>
<span id="cb1-192"><a href="#cb1-192" tabindex="-1"></a><span class="co">#&gt;         dep_cstr &lt;- paste0(dep_name, &quot; =~ &quot;, paste(indics[[dep_name]], </span></span>
<span id="cb1-193"><a href="#cb1-193" tabindex="-1"></a><span class="co">#&gt;             collapse = &quot; + &quot;), collapse = &quot;&quot;)</span></span>
<span id="cb1-194"><a href="#cb1-194" tabindex="-1"></a><span class="co">#&gt;     }</span></span>
<span id="cb1-195"><a href="#cb1-195" tabindex="-1"></a><span class="co">#&gt;     else {</span></span>
<span id="cb1-196"><a href="#cb1-196" tabindex="-1"></a><span class="co">#&gt;         dep_cstr &lt;- &quot;&quot;</span></span>
<span id="cb1-197"><a href="#cb1-197" tabindex="-1"></a><span class="co">#&gt;     }</span></span>
<span id="cb1-198"><a href="#cb1-198" tabindex="-1"></a><span class="co">#&gt;     fac_cstr &lt;- paste(fac_cstr, collapse = &quot;&quot;)</span></span>
<span id="cb1-199"><a href="#cb1-199" tabindex="-1"></a><span class="co">#&gt;     ev_cstr &lt;- paste(ev_cstr, collapse = &quot;&quot;)</span></span>
<span id="cb1-200"><a href="#cb1-200" tabindex="-1"></a><span class="co">#&gt;     err_cstr &lt;- paste(err_cstr, collapse = &quot;&quot;)</span></span>
<span id="cb1-201"><a href="#cb1-201" tabindex="-1"></a><span class="co">#&gt;     lat_cstr &lt;- paste(trimws(unlist(strsplit(model, split = &quot;\n&quot;))[grep(&quot;~~&quot;, </span></span>
<span id="cb1-202"><a href="#cb1-202" tabindex="-1"></a><span class="co">#&gt;         unlist(strsplit(model, split = &quot;\n&quot;)), fixed = TRUE)]), </span></span>
<span id="cb1-203"><a href="#cb1-203" tabindex="-1"></a><span class="co">#&gt;         collapse = &quot;\n&quot;)</span></span>
<span id="cb1-204"><a href="#cb1-204" tabindex="-1"></a><span class="co">#&gt;     reg_str &lt;- gsub(&quot;:&quot;, &quot;_&quot;, trimws(unlist(strsplit(model, split = &quot;\n&quot;))[grep(paste0(lat_names[1], </span></span>
<span id="cb1-205"><a href="#cb1-205" tabindex="-1"></a><span class="co">#&gt;         &quot;:&quot;, lat_names[2]), unlist(strsplit(model, split = &quot;\n&quot;)))]))</span></span>
<span id="cb1-206"><a href="#cb1-206" tabindex="-1"></a><span class="co">#&gt;     defbeta_cstr &lt;- paste(trimws(unlist(strsplit(model, split = &quot;\n&quot;))[grep(&quot;:=&quot;, </span></span>
<span id="cb1-207"><a href="#cb1-207" tabindex="-1"></a><span class="co">#&gt;         unlist(strsplit(model, split = &quot;\n&quot;)), fixed = TRUE)]), </span></span>
<span id="cb1-208"><a href="#cb1-208" tabindex="-1"></a><span class="co">#&gt;         collapse = &quot;\n&quot;)</span></span>
<span id="cb1-209"><a href="#cb1-209" tabindex="-1"></a><span class="co">#&gt;     model_new &lt;- paste0(&quot;# Measurement Model (indicated by sum scores)\n&quot;, </span></span>
<span id="cb1-210"><a href="#cb1-210" tabindex="-1"></a><span class="co">#&gt;         fac_cstr, dep_cstr, &quot;\n# Error Variance\n&quot;, ev_cstr, </span></span>
<span id="cb1-211"><a href="#cb1-211" tabindex="-1"></a><span class="co">#&gt;         &quot;# Structural Model\n&quot;, reg_str, &quot;\n&quot;, &quot;# Latent Variance\n&quot;, </span></span>
<span id="cb1-212"><a href="#cb1-212" tabindex="-1"></a><span class="co">#&gt;         lat_cstr, &quot;\n&quot;, &quot;# Error Constraints\n&quot;, err_cstr, &quot;\n&quot;, </span></span>
<span id="cb1-213"><a href="#cb1-213" tabindex="-1"></a><span class="co">#&gt;         &quot;# Defined Betas\n&quot;, defbeta_cstr, &quot;\n&quot;)</span></span>
<span id="cb1-214"><a href="#cb1-214" tabindex="-1"></a><span class="co">#&gt;     model_new &lt;- gsub(paste0(lat_names[1], &quot;_rel&quot;), replacement = first_rel, </span></span>
<span id="cb1-215"><a href="#cb1-215" tabindex="-1"></a><span class="co">#&gt;         x = model_new)</span></span>
<span id="cb1-216"><a href="#cb1-216" tabindex="-1"></a><span class="co">#&gt;     model_new &lt;- gsub(paste0(lat_names[2], &quot;_rel&quot;), replacement = second_rel, </span></span>
<span id="cb1-217"><a href="#cb1-217" tabindex="-1"></a><span class="co">#&gt;         x = model_new)</span></span>
<span id="cb1-218"><a href="#cb1-218" tabindex="-1"></a><span class="co">#&gt;     fit_rapi &lt;- sem(model_new, data = data_int, ...)</span></span>
<span id="cb1-219"><a href="#cb1-219" tabindex="-1"></a><span class="co">#&gt;     return(fit_rapi)</span></span>
<span id="cb1-220"><a href="#cb1-220" tabindex="-1"></a><span class="co">#&gt; }</span></span>
<span id="cb1-221"><a href="#cb1-221" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb1-222"><a href="#cb1-222" tabindex="-1"></a><span class="co">#&gt; [[5]]$visible</span></span>
<span id="cb1-223"><a href="#cb1-223" tabindex="-1"></a><span class="co">#&gt; [1] FALSE</span></span>
<span id="cb1-224"><a href="#cb1-224" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb1-225"><a href="#cb1-225" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb1-226"><a href="#cb1-226" tabindex="-1"></a><span class="co">#&gt; [[6]]</span></span>
<span id="cb1-227"><a href="#cb1-227" tabindex="-1"></a><span class="co">#&gt; [[6]]$value</span></span>
<span id="cb1-228"><a href="#cb1-228" tabindex="-1"></a><span class="co">#&gt; function (model, data, se = NULL) </span></span>
<span id="cb1-229"><a href="#cb1-229" tabindex="-1"></a><span class="co">#&gt; {</span></span>
<span id="cb1-230"><a href="#cb1-230" tabindex="-1"></a><span class="co">#&gt;     if (nrow(se) != 0) {</span></span>
<span id="cb1-231"><a href="#cb1-231" tabindex="-1"></a><span class="co">#&gt;         ev &lt;- se^2</span></span>
<span id="cb1-232"><a href="#cb1-232" tabindex="-1"></a><span class="co">#&gt;         var &lt;- names(se)</span></span>
<span id="cb1-233"><a href="#cb1-233" tabindex="-1"></a><span class="co">#&gt;         len &lt;- length(se)</span></span>
<span id="cb1-234"><a href="#cb1-234" tabindex="-1"></a><span class="co">#&gt;         group &lt;- nrow(se)</span></span>
<span id="cb1-235"><a href="#cb1-235" tabindex="-1"></a><span class="co">#&gt;         col &lt;- colnames(data)</span></span>
<span id="cb1-236"><a href="#cb1-236" tabindex="-1"></a><span class="co">#&gt;         fs &lt;- paste0(&quot;fs_&quot;, var)</span></span>
<span id="cb1-237"><a href="#cb1-237" tabindex="-1"></a><span class="co">#&gt;         tspaModel &lt;- rep(NA, len)</span></span>
<span id="cb1-238"><a href="#cb1-238" tabindex="-1"></a><span class="co">#&gt;         latent_var &lt;- rep(NA, len)</span></span>
<span id="cb1-239"><a href="#cb1-239" tabindex="-1"></a><span class="co">#&gt;         error_constraint &lt;- rep(NA, len)</span></span>
<span id="cb1-240"><a href="#cb1-240" tabindex="-1"></a><span class="co">#&gt;         latent_variance &lt;- rep(NA, len)</span></span>
<span id="cb1-241"><a href="#cb1-241" tabindex="-1"></a><span class="co">#&gt;         for (x in 1:len) {</span></span>
<span id="cb1-242"><a href="#cb1-242" tabindex="-1"></a><span class="co">#&gt;             latent_var[x] &lt;- paste0(var[x], &quot;=~ c(&quot;, paste0(rep(1, </span></span>
<span id="cb1-243"><a href="#cb1-243" tabindex="-1"></a><span class="co">#&gt;                 group), collapse = &quot;, &quot;), &quot;) * &quot;, fs[x], &quot;\n&quot;)</span></span>
<span id="cb1-244"><a href="#cb1-244" tabindex="-1"></a><span class="co">#&gt;             error_constraint[x] &lt;- paste0(fs[x], &quot;~~ c(&quot;, paste(ev[x], </span></span>
<span id="cb1-245"><a href="#cb1-245" tabindex="-1"></a><span class="co">#&gt;                 collapse = &quot;, &quot;), &quot;) * &quot;, fs[x], &quot;\n&quot;)</span></span>
<span id="cb1-246"><a href="#cb1-246" tabindex="-1"></a><span class="co">#&gt;             latent_variance[x] &lt;- paste0(var[x], &quot; ~~ c(&quot;, paste0(paste0(rep(paste0(&quot;v&quot;, </span></span>
<span id="cb1-247"><a href="#cb1-247" tabindex="-1"></a><span class="co">#&gt;                 x), group), 1:group), collapse = &quot;, &quot;), &quot;) * &quot;, </span></span>
<span id="cb1-248"><a href="#cb1-248" tabindex="-1"></a><span class="co">#&gt;                 var[x], &quot;\n&quot;)</span></span>
<span id="cb1-249"><a href="#cb1-249" tabindex="-1"></a><span class="co">#&gt;         }</span></span>
<span id="cb1-250"><a href="#cb1-250" tabindex="-1"></a><span class="co">#&gt;         latent_var_str &lt;- paste(latent_var, collapse = &quot;&quot;)</span></span>
<span id="cb1-251"><a href="#cb1-251" tabindex="-1"></a><span class="co">#&gt;         error_constraint_str &lt;- paste(error_constraint, collapse = &quot;&quot;)</span></span>
<span id="cb1-252"><a href="#cb1-252" tabindex="-1"></a><span class="co">#&gt;         latent_variance_str &lt;- paste(latent_variance, collapse = &quot;&quot;)</span></span>
<span id="cb1-253"><a href="#cb1-253" tabindex="-1"></a><span class="co">#&gt;         tspaModel &lt;- gsub(&quot;:&quot;, &quot;.&quot;, paste0(&quot;# latent variables (indicated by factor scores)\n&quot;, </span></span>
<span id="cb1-254"><a href="#cb1-254" tabindex="-1"></a><span class="co">#&gt;             latent_var_str, &quot;# constrain the errors\n&quot;, error_constraint_str, </span></span>
<span id="cb1-255"><a href="#cb1-255" tabindex="-1"></a><span class="co">#&gt;             &quot;# latent variances\n&quot;, latent_variance_str, &quot;# regressions\n&quot;, </span></span>
<span id="cb1-256"><a href="#cb1-256" tabindex="-1"></a><span class="co">#&gt;             paste0(gsub(&quot;^\\s+&quot;, &quot;&quot;, unlist(strsplit(model, split = &quot;\n&quot;))), </span></span>
<span id="cb1-257"><a href="#cb1-257" tabindex="-1"></a><span class="co">#&gt;                 collapse = &quot;\n&quot;), &quot;\n&quot;))</span></span>
<span id="cb1-258"><a href="#cb1-258" tabindex="-1"></a><span class="co">#&gt;         tspaModel &lt;- gsub(&quot;.=&quot;, &quot;:=&quot;, tspaModel, fixed = T)</span></span>
<span id="cb1-259"><a href="#cb1-259" tabindex="-1"></a><span class="co">#&gt;         return(tspaModel)</span></span>
<span id="cb1-260"><a href="#cb1-260" tabindex="-1"></a><span class="co">#&gt;     }</span></span>
<span id="cb1-261"><a href="#cb1-261" tabindex="-1"></a><span class="co">#&gt; }</span></span>
<span id="cb1-262"><a href="#cb1-262" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb1-263"><a href="#cb1-263" tabindex="-1"></a><span class="co">#&gt; [[6]]$visible</span></span>
<span id="cb1-264"><a href="#cb1-264" tabindex="-1"></a><span class="co">#&gt; [1] FALSE</span></span>
<span id="cb1-265"><a href="#cb1-265" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb1-266"><a href="#cb1-266" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb1-267"><a href="#cb1-267" tabindex="-1"></a><span class="co">#&gt; [[7]]</span></span>
<span id="cb1-268"><a href="#cb1-268" tabindex="-1"></a><span class="co">#&gt; [[7]]$value</span></span>
<span id="cb1-269"><a href="#cb1-269" tabindex="-1"></a><span class="co">#&gt; function (model, data, mode = &quot;match&quot;, ...) </span></span>
<span id="cb1-270"><a href="#cb1-270" tabindex="-1"></a><span class="co">#&gt; {</span></span>
<span id="cb1-271"><a href="#cb1-271" tabindex="-1"></a><span class="co">#&gt;     pairs &lt;- parseInteractionTerms(model)</span></span>
<span id="cb1-272"><a href="#cb1-272" tabindex="-1"></a><span class="co">#&gt;     indics &lt;- parseIndicators(model)</span></span>
<span id="cb1-273"><a href="#cb1-273" tabindex="-1"></a><span class="co">#&gt;     pairs_count &lt;- length(pairs)</span></span>
<span id="cb1-274"><a href="#cb1-274" tabindex="-1"></a><span class="co">#&gt;     mode = mode</span></span>
<span id="cb1-275"><a href="#cb1-275" tabindex="-1"></a><span class="co">#&gt;     product_syntax &lt;- function(model, data, inter_pair, indicators, </span></span>
<span id="cb1-276"><a href="#cb1-276" tabindex="-1"></a><span class="co">#&gt;         mode) {</span></span>
<span id="cb1-277"><a href="#cb1-277" tabindex="-1"></a><span class="co">#&gt;         inter_names &lt;- inter_pair</span></span>
<span id="cb1-278"><a href="#cb1-278" tabindex="-1"></a><span class="co">#&gt;         vec1 &lt;- unname(unlist(indicators[inter_names][1]))</span></span>
<span id="cb1-279"><a href="#cb1-279" tabindex="-1"></a><span class="co">#&gt;         vec2 &lt;- unname(unlist(indicators[inter_names][2]))</span></span>
<span id="cb1-280"><a href="#cb1-280" tabindex="-1"></a><span class="co">#&gt;         if (mode == &quot;match&quot;) {</span></span>
<span id="cb1-281"><a href="#cb1-281" tabindex="-1"></a><span class="co">#&gt;             intNames &lt;- paste0(vec1, vec2)</span></span>
<span id="cb1-282"><a href="#cb1-282" tabindex="-1"></a><span class="co">#&gt;             model_indProd &lt;- paste0(&quot;\n          #Indicator Products&quot;, </span></span>
<span id="cb1-283"><a href="#cb1-283" tabindex="-1"></a><span class="co">#&gt;                 &quot;\n          &quot;, paste(&quot; &quot;, paste(inter_names, </span></span>
<span id="cb1-284"><a href="#cb1-284" tabindex="-1"></a><span class="co">#&gt;                   collapse = &quot;_int_&quot;), &quot;=~&quot;, paste(intNames, </span></span>
<span id="cb1-285"><a href="#cb1-285" tabindex="-1"></a><span class="co">#&gt;                   collapse = &quot; + &quot;)))</span></span>
<span id="cb1-286"><a href="#cb1-286" tabindex="-1"></a><span class="co">#&gt;         }</span></span>
<span id="cb1-287"><a href="#cb1-287" tabindex="-1"></a><span class="co">#&gt;         else {</span></span>
<span id="cb1-288"><a href="#cb1-288" tabindex="-1"></a><span class="co">#&gt;             intNames &lt;- paste0(rep(vec1, each = length(vec2)), </span></span>
<span id="cb1-289"><a href="#cb1-289" tabindex="-1"></a><span class="co">#&gt;                 vec2)</span></span>
<span id="cb1-290"><a href="#cb1-290" tabindex="-1"></a><span class="co">#&gt;             ind_1 &lt;- vector()</span></span>
<span id="cb1-291"><a href="#cb1-291" tabindex="-1"></a><span class="co">#&gt;             ind_syntax_vec &lt;- list()</span></span>
<span id="cb1-292"><a href="#cb1-292" tabindex="-1"></a><span class="co">#&gt;             ind_2 &lt;- vector()</span></span>
<span id="cb1-293"><a href="#cb1-293" tabindex="-1"></a><span class="co">#&gt;             ind_syntax_vec_2 &lt;- list()</span></span>
<span id="cb1-294"><a href="#cb1-294" tabindex="-1"></a><span class="co">#&gt;             count = 0</span></span>
<span id="cb1-295"><a href="#cb1-295" tabindex="-1"></a><span class="co">#&gt;             for (n in vec1) {</span></span>
<span id="cb1-296"><a href="#cb1-296" tabindex="-1"></a><span class="co">#&gt;                 comb &lt;- combn(c(intNames[grepl(n, intNames)]), </span></span>
<span id="cb1-297"><a href="#cb1-297" tabindex="-1"></a><span class="co">#&gt;                   2)</span></span>
<span id="cb1-298"><a href="#cb1-298" tabindex="-1"></a><span class="co">#&gt;                 for (i in seq(unique(comb[1, ]))) {</span></span>
<span id="cb1-299"><a href="#cb1-299" tabindex="-1"></a><span class="co">#&gt;                   ind_1[i] &lt;- paste0(&quot;\n           &quot;, unique(comb[1, </span></span>
<span id="cb1-300"><a href="#cb1-300" tabindex="-1"></a><span class="co">#&gt;                     ])[i], &quot; ~~ &quot;, paste0(&quot;th&quot;, which(vec1 == </span></span>
<span id="cb1-301"><a href="#cb1-301" tabindex="-1"></a><span class="co">#&gt;                     n), &quot;*&quot;, matrix(comb[, c(which(as.vector(comb[1, </span></span>
<span id="cb1-302"><a href="#cb1-302" tabindex="-1"></a><span class="co">#&gt;                     ]) == unique(comb[1, ])[i]))], nrow = 2)[2, </span></span>
<span id="cb1-303"><a href="#cb1-303" tabindex="-1"></a><span class="co">#&gt;                     ], collapse = &quot; + &quot;))</span></span>
<span id="cb1-304"><a href="#cb1-304" tabindex="-1"></a><span class="co">#&gt;                 }</span></span>
<span id="cb1-305"><a href="#cb1-305" tabindex="-1"></a><span class="co">#&gt;                 ind_syntax_vec[[n]] &lt;- ind_1</span></span>
<span id="cb1-306"><a href="#cb1-306" tabindex="-1"></a><span class="co">#&gt;                 count = count + 1</span></span>
<span id="cb1-307"><a href="#cb1-307" tabindex="-1"></a><span class="co">#&gt;             }</span></span>
<span id="cb1-308"><a href="#cb1-308" tabindex="-1"></a><span class="co">#&gt;             for (m in vec2) {</span></span>
<span id="cb1-309"><a href="#cb1-309" tabindex="-1"></a><span class="co">#&gt;                 comb &lt;- combn(c(intNames[grepl(m, intNames)]), </span></span>
<span id="cb1-310"><a href="#cb1-310" tabindex="-1"></a><span class="co">#&gt;                   2)</span></span>
<span id="cb1-311"><a href="#cb1-311" tabindex="-1"></a><span class="co">#&gt;                 for (i in seq(unique(comb[1, ]))) {</span></span>
<span id="cb1-312"><a href="#cb1-312" tabindex="-1"></a><span class="co">#&gt;                   ind_2[i] &lt;- paste0(&quot;\n           &quot;, unique(comb[1, </span></span>
<span id="cb1-313"><a href="#cb1-313" tabindex="-1"></a><span class="co">#&gt;                     ])[i], &quot; ~~ &quot;, paste0(&quot;th&quot;, which(vec2 == </span></span>
<span id="cb1-314"><a href="#cb1-314" tabindex="-1"></a><span class="co">#&gt;                     m) + count, &quot;*&quot;, matrix(comb[, c(which(as.vector(comb[1, </span></span>
<span id="cb1-315"><a href="#cb1-315" tabindex="-1"></a><span class="co">#&gt;                     ]) == unique(comb[1, ])[i]))], nrow = 2)[2, </span></span>
<span id="cb1-316"><a href="#cb1-316" tabindex="-1"></a><span class="co">#&gt;                     ], collapse = &quot; + &quot;))</span></span>
<span id="cb1-317"><a href="#cb1-317" tabindex="-1"></a><span class="co">#&gt;                 }</span></span>
<span id="cb1-318"><a href="#cb1-318" tabindex="-1"></a><span class="co">#&gt;                 ind_syntax_vec_2[[m]] &lt;- ind_2</span></span>
<span id="cb1-319"><a href="#cb1-319" tabindex="-1"></a><span class="co">#&gt;             }</span></span>
<span id="cb1-320"><a href="#cb1-320" tabindex="-1"></a><span class="co">#&gt;             model_indProd &lt;- paste0(&quot;\n          #Indicator Products&quot;, </span></span>
<span id="cb1-321"><a href="#cb1-321" tabindex="-1"></a><span class="co">#&gt;                 &quot;\n          &quot;, paste(&quot; &quot;, paste(inter_names, </span></span>
<span id="cb1-322"><a href="#cb1-322" tabindex="-1"></a><span class="co">#&gt;                   collapse = &quot;_int_&quot;), &quot;=~&quot;, paste(intNames, </span></span>
<span id="cb1-323"><a href="#cb1-323" tabindex="-1"></a><span class="co">#&gt;                   collapse = &quot; + &quot;)), &quot;\n          # Residual covariances in which same indicators have same constraint&quot;, </span></span>
<span id="cb1-324"><a href="#cb1-324" tabindex="-1"></a><span class="co">#&gt;                 paste(unlist(ind_syntax_vec), collapse = &quot; &quot;), </span></span>
<span id="cb1-325"><a href="#cb1-325" tabindex="-1"></a><span class="co">#&gt;                 &quot;\n          &quot;, paste(unlist(ind_syntax_vec_2), </span></span>
<span id="cb1-326"><a href="#cb1-326" tabindex="-1"></a><span class="co">#&gt;                   collapse = &quot; &quot;), &quot;\n          &quot;)</span></span>
<span id="cb1-327"><a href="#cb1-327" tabindex="-1"></a><span class="co">#&gt;         }</span></span>
<span id="cb1-328"><a href="#cb1-328" tabindex="-1"></a><span class="co">#&gt;         return(model_indProd)</span></span>
<span id="cb1-329"><a href="#cb1-329" tabindex="-1"></a><span class="co">#&gt;     }</span></span>
<span id="cb1-330"><a href="#cb1-330" tabindex="-1"></a><span class="co">#&gt;     while (pairs_count &gt; 0) {</span></span>
<span id="cb1-331"><a href="#cb1-331" tabindex="-1"></a><span class="co">#&gt;         ind_syntax &lt;- product_syntax(model, data, inter_pair = pairs[[pairs_count]], </span></span>
<span id="cb1-332"><a href="#cb1-332" tabindex="-1"></a><span class="co">#&gt;             indicators = indics, mode = mode)</span></span>
<span id="cb1-333"><a href="#cb1-333" tabindex="-1"></a><span class="co">#&gt;         model &lt;- paste(model, ind_syntax)</span></span>
<span id="cb1-334"><a href="#cb1-334" tabindex="-1"></a><span class="co">#&gt;         pairs_count &lt;- pairs_count - 1</span></span>
<span id="cb1-335"><a href="#cb1-335" tabindex="-1"></a><span class="co">#&gt;     }</span></span>
<span id="cb1-336"><a href="#cb1-336" tabindex="-1"></a><span class="co">#&gt;     model &lt;- gsub(&quot;:&quot;, &quot;_int_&quot;, model)</span></span>
<span id="cb1-337"><a href="#cb1-337" tabindex="-1"></a><span class="co">#&gt;     model &lt;- gsub(&quot;_int_=&quot;, &quot;:=&quot;, model)</span></span>
<span id="cb1-338"><a href="#cb1-338" tabindex="-1"></a><span class="co">#&gt;     pairs_count &lt;- length(pairs)</span></span>
<span id="cb1-339"><a href="#cb1-339" tabindex="-1"></a><span class="co">#&gt;     indprod_data &lt;- function(data, inter_pair, indicators, mode = mode) {</span></span>
<span id="cb1-340"><a href="#cb1-340" tabindex="-1"></a><span class="co">#&gt;         inter_names &lt;- inter_pair</span></span>
<span id="cb1-341"><a href="#cb1-341" tabindex="-1"></a><span class="co">#&gt;         vec1 &lt;- unname(unlist(indicators[inter_names][1]))</span></span>
<span id="cb1-342"><a href="#cb1-342" tabindex="-1"></a><span class="co">#&gt;         vec2 &lt;- unname(unlist(indicators[inter_names][2]))</span></span>
<span id="cb1-343"><a href="#cb1-343" tabindex="-1"></a><span class="co">#&gt;         if (mode == &quot;match&quot;) {</span></span>
<span id="cb1-344"><a href="#cb1-344" tabindex="-1"></a><span class="co">#&gt;             intNames &lt;- paste0(vec1, vec2)</span></span>
<span id="cb1-345"><a href="#cb1-345" tabindex="-1"></a><span class="co">#&gt;             inter_data &lt;- indProd(data = data, var1 = vec1, var2 = vec2, </span></span>
<span id="cb1-346"><a href="#cb1-346" tabindex="-1"></a><span class="co">#&gt;                 meanC = TRUE, match = TRUE, doubleMC = TRUE, </span></span>
<span id="cb1-347"><a href="#cb1-347" tabindex="-1"></a><span class="co">#&gt;                 namesProd = intNames)</span></span>
<span id="cb1-348"><a href="#cb1-348" tabindex="-1"></a><span class="co">#&gt;         }</span></span>
<span id="cb1-349"><a href="#cb1-349" tabindex="-1"></a><span class="co">#&gt;         else {</span></span>
<span id="cb1-350"><a href="#cb1-350" tabindex="-1"></a><span class="co">#&gt;             intNames &lt;- paste0(rep(vec1, each = length(vec2)), </span></span>
<span id="cb1-351"><a href="#cb1-351" tabindex="-1"></a><span class="co">#&gt;                 vec2)</span></span>
<span id="cb1-352"><a href="#cb1-352" tabindex="-1"></a><span class="co">#&gt;             inter_data &lt;- indProd(data = data, var1 = vec1, var2 = vec2, </span></span>
<span id="cb1-353"><a href="#cb1-353" tabindex="-1"></a><span class="co">#&gt;                 meanC = TRUE, match = FALSE, doubleMC = TRUE, </span></span>
<span id="cb1-354"><a href="#cb1-354" tabindex="-1"></a><span class="co">#&gt;                 namesProd = intNames)</span></span>
<span id="cb1-355"><a href="#cb1-355" tabindex="-1"></a><span class="co">#&gt;         }</span></span>
<span id="cb1-356"><a href="#cb1-356" tabindex="-1"></a><span class="co">#&gt;         inter_data &lt;- inter_data[, !names(inter_data) %in% names(data)]</span></span>
<span id="cb1-357"><a href="#cb1-357" tabindex="-1"></a><span class="co">#&gt;         return(inter_data)</span></span>
<span id="cb1-358"><a href="#cb1-358" tabindex="-1"></a><span class="co">#&gt;     }</span></span>
<span id="cb1-359"><a href="#cb1-359" tabindex="-1"></a><span class="co">#&gt;     while (pairs_count &gt; 0) {</span></span>
<span id="cb1-360"><a href="#cb1-360" tabindex="-1"></a><span class="co">#&gt;         interim_data &lt;- indprod_data(data, pairs[[pairs_count]], </span></span>
<span id="cb1-361"><a href="#cb1-361" tabindex="-1"></a><span class="co">#&gt;             indicators = indics, mode = mode)</span></span>
<span id="cb1-362"><a href="#cb1-362" tabindex="-1"></a><span class="co">#&gt;         data &lt;- as.data.frame(scale(data, center = TRUE, scale = FALSE))</span></span>
<span id="cb1-363"><a href="#cb1-363" tabindex="-1"></a><span class="co">#&gt;         data &lt;- cbind(data, interim_data)</span></span>
<span id="cb1-364"><a href="#cb1-364" tabindex="-1"></a><span class="co">#&gt;         pairs_count &lt;- pairs_count - 1</span></span>
<span id="cb1-365"><a href="#cb1-365" tabindex="-1"></a><span class="co">#&gt;     }</span></span>
<span id="cb1-366"><a href="#cb1-366" tabindex="-1"></a><span class="co">#&gt;     fit_indProd &lt;- sem(model, data = data, ...)</span></span>
<span id="cb1-367"><a href="#cb1-367" tabindex="-1"></a><span class="co">#&gt;     return(fit_indProd)</span></span>
<span id="cb1-368"><a href="#cb1-368" tabindex="-1"></a><span class="co">#&gt; }</span></span>
<span id="cb1-369"><a href="#cb1-369" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb1-370"><a href="#cb1-370" tabindex="-1"></a><span class="co">#&gt; [[7]]$visible</span></span>
<span id="cb1-371"><a href="#cb1-371" tabindex="-1"></a><span class="co">#&gt; [1] FALSE</span></span></code></pre></div>
<div id="introduction" class="section level1">
<h1>Introduction</h1>
<p>Recent widely used approaches of estimating latent interaction
effects are Unconstrained Product Indicator (UPI) and
Reliability-Adjusted Product Indicator (RAPI). We proposed a new
approach based on the Two-Stage Path Analysis (2S-PA) framework,
2S-PA-Interaction, and compared to the UPI and RAPI methods.</p>
<p>We begin by simulating a dataset under a hypothetical structural
model with two latent predictors, <span class="math inline">\(\xi_{X}\)</span> and <span class="math inline">\(\xi_{M}\)</span>, and one observed dependent
variable, <span class="math inline">\(Y\)</span>. Each latent predicted
is indicated by three items (i.e., [<span class="math inline">\(x1\)</span>, <span class="math inline">\(x2\)</span>, <span class="math inline">\(x3\)</span>]; [<span class="math inline">\(m1\)</span>, <span class="math inline">\(m2\)</span>, <span class="math inline">\(m3\)</span>]). The latent interaction term is
demonstrated by a multiplicative term, <span class="math inline">\(\xi_{XM}\)</span>.</p>
<p><span class="math display">\[\begin{equation}
y = \gamma_{1}\xi_{X} + \gamma_{2}\xi_{M} + \gamma_{3}\xi_{XM} + \zeta,
\end{equation}\]</span></p>
<p>The <span class="math inline">\(\zeta\)</span> is the disturbance of
regression model with a distribution of <span class="math inline">\(\zeta \sim N(0, \Psi)\)</span>.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a><span class="co"># Define a function of generating interaction data</span></span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a>generate_sem_data <span class="ot">&lt;-</span> <span class="cf">function</span>(N, model, Alpha, Phi, Lambda, Gamma, Theta, SD_y) {</span>
<span id="cb2-3"><a href="#cb2-3" tabindex="-1"></a>  <span class="co"># Generate scores for observed items: x1 - x3, m1 - m3</span></span>
<span id="cb2-4"><a href="#cb2-4" tabindex="-1"></a>  eta_scores <span class="ot">&lt;-</span> <span class="fu">rmnorm</span>(N, <span class="at">mean =</span> Alpha, <span class="at">varcov =</span> Phi) <span class="co"># Factor scores</span></span>
<span id="cb2-5"><a href="#cb2-5" tabindex="-1"></a>  <span class="co"># Generate eta scores with interaction</span></span>
<span id="cb2-6"><a href="#cb2-6" tabindex="-1"></a>  eta_scores_int <span class="ot">&lt;-</span> <span class="fu">cbind</span>(eta_scores, eta_scores[,<span class="dv">1</span>]<span class="sc">*</span>eta_scores[,<span class="dv">2</span>])</span>
<span id="cb2-7"><a href="#cb2-7" tabindex="-1"></a>  delta <span class="ot">&lt;-</span> <span class="fu">rmnorm</span>(N, <span class="at">mean =</span> <span class="fu">rep</span>(<span class="dv">0</span>, <span class="fu">length</span>(<span class="fu">diag</span>(Theta))), <span class="at">varcov =</span> Theta) <span class="co"># Errors/Residuals of Indicators</span></span>
<span id="cb2-8"><a href="#cb2-8" tabindex="-1"></a>  item_scores <span class="ot">&lt;-</span> <span class="fu">tcrossprod</span>(eta_scores, Lambda) <span class="sc">+</span> delta <span class="co"># Item/Indicator scores</span></span>
<span id="cb2-9"><a href="#cb2-9" tabindex="-1"></a></span>
<span id="cb2-10"><a href="#cb2-10" tabindex="-1"></a>  y_scores <span class="ot">&lt;-</span> <span class="fu">tcrossprod</span>(eta_scores_int, Gamma) <span class="sc">+</span> <span class="fu">rnorm</span>(N, <span class="dv">0</span>, SD_y) <span class="co"># Y scores / DV scores</span></span>
<span id="cb2-11"><a href="#cb2-11" tabindex="-1"></a></span>
<span id="cb2-12"><a href="#cb2-12" tabindex="-1"></a>  <span class="co"># Parsing formula</span></span>
<span id="cb2-13"><a href="#cb2-13" tabindex="-1"></a>  indicator_terms <span class="ot">&lt;-</span> <span class="fu">unlist</span>(<span class="fu">strsplit</span>(<span class="fu">gsub</span>(<span class="st">&quot; &quot;</span>, <span class="st">&quot;&quot;</span>,</span>
<span id="cb2-14"><a href="#cb2-14" tabindex="-1"></a>                                          <span class="fu">unlist</span>(<span class="fu">strsplit</span>(model, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>))[<span class="fu">grep</span>(<span class="st">&quot;=~&quot;</span>,</span>
<span id="cb2-15"><a href="#cb2-15" tabindex="-1"></a>                                                                             <span class="fu">unlist</span>(<span class="fu">strsplit</span>(model, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)))]),</span>
<span id="cb2-16"><a href="#cb2-16" tabindex="-1"></a>                                     <span class="at">split =</span> <span class="st">&quot;=~&quot;</span>))</span>
<span id="cb2-17"><a href="#cb2-17" tabindex="-1"></a>  indicator_vars <span class="ot">&lt;-</span> indicator_terms[<span class="fu">grepl</span>(<span class="st">&quot;+&quot;</span>, indicator_terms, <span class="at">fixed =</span> <span class="cn">TRUE</span>) <span class="sc">==</span> <span class="st">&quot;FALSE&quot;</span>]</span>
<span id="cb2-18"><a href="#cb2-18" tabindex="-1"></a>  indicator_num <span class="ot">&lt;-</span> <span class="fu">as.vector</span>(<span class="fu">unlist</span>(<span class="fu">lapply</span>(<span class="fu">strsplit</span>(indicator_terms[<span class="fu">grepl</span>(<span class="st">&quot;+&quot;</span>, indicator_terms, <span class="at">fixed =</span> <span class="cn">TRUE</span>) <span class="sc">==</span> <span class="st">&quot;TRUE&quot;</span>],</span>
<span id="cb2-19"><a href="#cb2-19" tabindex="-1"></a>                                                    <span class="at">split =</span> <span class="st">&quot;+&quot;</span>, <span class="at">fixed =</span> <span class="cn">TRUE</span>), length)))</span>
<span id="cb2-20"><a href="#cb2-20" tabindex="-1"></a></span>
<span id="cb2-21"><a href="#cb2-21" tabindex="-1"></a>  df <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">cbind</span>(item_scores, y_scores))</span>
<span id="cb2-22"><a href="#cb2-22" tabindex="-1"></a>  names <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb2-23"><a href="#cb2-23" tabindex="-1"></a>  <span class="cf">for</span> (n <span class="cf">in</span> <span class="fu">seq</span>(<span class="fu">length</span>(indicator_vars))) {</span>
<span id="cb2-24"><a href="#cb2-24" tabindex="-1"></a>    names[[n]] <span class="ot">&lt;-</span> <span class="fu">tolower</span>(<span class="fu">paste0</span>(indicator_vars[n], <span class="fu">seq</span>(indicator_num[n])))</span>
<span id="cb2-25"><a href="#cb2-25" tabindex="-1"></a>  }</span>
<span id="cb2-26"><a href="#cb2-26" tabindex="-1"></a>  <span class="fu">colnames</span>(df) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">unlist</span>(names), <span class="st">&quot;Y&quot;</span>)</span>
<span id="cb2-27"><a href="#cb2-27" tabindex="-1"></a>  <span class="fu">return</span>(df)</span>
<span id="cb2-28"><a href="#cb2-28" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">4073</span>)</span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a><span class="co"># Define model parameters </span></span>
<span id="cb3-3"><a href="#cb3-3" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="dv">500</span></span>
<span id="cb3-4"><a href="#cb3-4" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="st">&quot;# Measurement Model</span></span>
<span id="cb3-5"><a href="#cb3-5" tabindex="-1"></a><span class="st">            X =~ x1 + x2 + x3</span></span>
<span id="cb3-6"><a href="#cb3-6" tabindex="-1"></a><span class="st">            M =~ m1 + m2 + m3</span></span>
<span id="cb3-7"><a href="#cb3-7" tabindex="-1"></a><span class="st">          # Structural Model</span></span>
<span id="cb3-8"><a href="#cb3-8" tabindex="-1"></a><span class="st">            Y ~ b1*X + b2*M + b3*X:M&quot;</span></span>
<span id="cb3-9"><a href="#cb3-9" tabindex="-1"></a>Alpha <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>) <span class="co"># Latent means of 0</span></span>
<span id="cb3-10"><a href="#cb3-10" tabindex="-1"></a>Phi <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">1</span>, <span class="fl">0.6</span>,</span>
<span id="cb3-11"><a href="#cb3-11" tabindex="-1"></a>                <span class="fl">0.6</span>, <span class="dv">1</span>), </span>
<span id="cb3-12"><a href="#cb3-12" tabindex="-1"></a>              <span class="at">nrow =</span> <span class="dv">2</span>) <span class="co"># Latent correlation of 0.6</span></span>
<span id="cb3-13"><a href="#cb3-13" tabindex="-1"></a>Lambda <span class="ot">&lt;-</span> <span class="fu">cbind</span>(<span class="fu">c</span>(<span class="dv">1</span>, <span class="fl">0.9</span>, <span class="fl">0.75</span>, <span class="fu">rep</span>(<span class="dv">0</span>, <span class="dv">3</span>)),</span>
<span id="cb3-14"><a href="#cb3-14" tabindex="-1"></a>                <span class="fu">c</span>(<span class="fu">rep</span>(<span class="dv">0</span>, <span class="dv">3</span>), <span class="dv">1</span>, <span class="fl">0.9</span>, <span class="fl">0.75</span>)) <span class="co"># Factor loadings</span></span>
<span id="cb3-15"><a href="#cb3-15" tabindex="-1"></a>Gamma <span class="ot">&lt;-</span> <span class="fu">t</span>(<span class="fu">c</span>(<span class="fl">0.3</span>, <span class="fl">0.3</span>, <span class="fl">0.3</span>)) <span class="co"># Path coefficients</span></span>
<span id="cb3-16"><a href="#cb3-16" tabindex="-1"></a>Theta <span class="ot">&lt;-</span> <span class="fu">diag</span>(<span class="fu">c</span>(<span class="fl">1.32</span>, <span class="fl">0.99</span>, <span class="fl">0.69</span>), <span class="at">nrow =</span> <span class="dv">6</span>) <span class="co"># Residual variance with reliability of 0.7</span></span>
<span id="cb3-17"><a href="#cb3-17" tabindex="-1"></a>SD_y <span class="ot">&lt;-</span> <span class="fl">0.7678542</span> <span class="co"># Error variance at cor_xm = 0.6</span></span>
<span id="cb3-18"><a href="#cb3-18" tabindex="-1"></a></span>
<span id="cb3-19"><a href="#cb3-19" tabindex="-1"></a><span class="co"># Simulate Data</span></span>
<span id="cb3-20"><a href="#cb3-20" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">generate_sem_data</span>(N, model, Alpha, Phi, Lambda, Gamma, Theta, SD_y)</span></code></pre></div>
<div id="regression-based-approach" class="section level2">
<h2>Regression-Based Approach</h2>
<p>Empirically the most widely used approach is moderated multiple
regression (MMR) method.</p>
<p><span class="math display">\[\begin{equation}
y = \gamma_{1}X + \gamma_{2}M + \gamma_{3}XM + \zeta,
\end{equation}\]</span></p>
<p>X and M are not latent but observed variables.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a>df_reg <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span></span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">x_c =</span> <span class="fu">rowSums</span>(df[<span class="fu">c</span>(<span class="st">&quot;x1&quot;</span>, <span class="st">&quot;x2&quot;</span>, <span class="st">&quot;x3&quot;</span>)]) <span class="sc">-</span> <span class="fu">mean</span>(<span class="fu">rowSums</span>(df[<span class="fu">c</span>(<span class="st">&quot;x1&quot;</span>, <span class="st">&quot;x2&quot;</span>, <span class="st">&quot;x3&quot;</span>)])),</span>
<span id="cb4-3"><a href="#cb4-3" tabindex="-1"></a>           <span class="at">m_c =</span> <span class="fu">rowSums</span>(df[<span class="fu">c</span>(<span class="st">&quot;m1&quot;</span>, <span class="st">&quot;m2&quot;</span>, <span class="st">&quot;m3&quot;</span>)]) <span class="sc">-</span> <span class="fu">mean</span>(<span class="fu">rowSums</span>(df[<span class="fu">c</span>(<span class="st">&quot;m1&quot;</span>, <span class="st">&quot;m2&quot;</span>, <span class="st">&quot;m3&quot;</span>)])),</span>
<span id="cb4-4"><a href="#cb4-4" tabindex="-1"></a>           <span class="at">xm =</span> x_c<span class="sc">*</span>m_c)</span>
<span id="cb4-5"><a href="#cb4-5" tabindex="-1"></a>fit_reg <span class="ot">&lt;-</span> <span class="fu">sem</span>(<span class="at">model =</span> <span class="st">&quot;Y ~ c0*x_c + c1*m_c + c2*xm&quot;</span>,</span>
<span id="cb4-6"><a href="#cb4-6" tabindex="-1"></a>              <span class="at">data =</span> df_reg)</span>
<span id="cb4-7"><a href="#cb4-7" tabindex="-1"></a><span class="fu">summary</span>(fit_reg)</span>
<span id="cb4-8"><a href="#cb4-8" tabindex="-1"></a><span class="co">#&gt; lavaan 0.6-18 ended normally after 1 iteration</span></span>
<span id="cb4-9"><a href="#cb4-9" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb4-10"><a href="#cb4-10" tabindex="-1"></a><span class="co">#&gt;   Estimator                                         ML</span></span>
<span id="cb4-11"><a href="#cb4-11" tabindex="-1"></a><span class="co">#&gt;   Optimization method                           NLMINB</span></span>
<span id="cb4-12"><a href="#cb4-12" tabindex="-1"></a><span class="co">#&gt;   Number of model parameters                         4</span></span>
<span id="cb4-13"><a href="#cb4-13" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb4-14"><a href="#cb4-14" tabindex="-1"></a><span class="co">#&gt;   Number of observations                           500</span></span>
<span id="cb4-15"><a href="#cb4-15" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb4-16"><a href="#cb4-16" tabindex="-1"></a><span class="co">#&gt; Model Test User Model:</span></span>
<span id="cb4-17"><a href="#cb4-17" tabindex="-1"></a><span class="co">#&gt;                                                       </span></span>
<span id="cb4-18"><a href="#cb4-18" tabindex="-1"></a><span class="co">#&gt;   Test statistic                                 0.000</span></span>
<span id="cb4-19"><a href="#cb4-19" tabindex="-1"></a><span class="co">#&gt;   Degrees of freedom                                 0</span></span>
<span id="cb4-20"><a href="#cb4-20" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb4-21"><a href="#cb4-21" tabindex="-1"></a><span class="co">#&gt; Parameter Estimates:</span></span>
<span id="cb4-22"><a href="#cb4-22" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb4-23"><a href="#cb4-23" tabindex="-1"></a><span class="co">#&gt;   Standard errors                             Standard</span></span>
<span id="cb4-24"><a href="#cb4-24" tabindex="-1"></a><span class="co">#&gt;   Information                                 Expected</span></span>
<span id="cb4-25"><a href="#cb4-25" tabindex="-1"></a><span class="co">#&gt;   Information saturated (h1) model          Structured</span></span>
<span id="cb4-26"><a href="#cb4-26" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb4-27"><a href="#cb4-27" tabindex="-1"></a><span class="co">#&gt; Regressions:</span></span>
<span id="cb4-28"><a href="#cb4-28" tabindex="-1"></a><span class="co">#&gt;                    Estimate  Std.Err  z-value  P(&gt;|z|)</span></span>
<span id="cb4-29"><a href="#cb4-29" tabindex="-1"></a><span class="co">#&gt;   Y ~                                                 </span></span>
<span id="cb4-30"><a href="#cb4-30" tabindex="-1"></a><span class="co">#&gt;     x_c       (c0)    0.070    0.013    5.352    0.000</span></span>
<span id="cb4-31"><a href="#cb4-31" tabindex="-1"></a><span class="co">#&gt;     m_c       (c1)    0.085    0.013    6.300    0.000</span></span>
<span id="cb4-32"><a href="#cb4-32" tabindex="-1"></a><span class="co">#&gt;     xm        (c2)    0.023    0.004    5.939    0.000</span></span>
<span id="cb4-33"><a href="#cb4-33" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb4-34"><a href="#cb4-34" tabindex="-1"></a><span class="co">#&gt; Variances:</span></span>
<span id="cb4-35"><a href="#cb4-35" tabindex="-1"></a><span class="co">#&gt;                    Estimate  Std.Err  z-value  P(&gt;|z|)</span></span>
<span id="cb4-36"><a href="#cb4-36" tabindex="-1"></a><span class="co">#&gt;    .Y                 0.658    0.042   15.811    0.000</span></span></code></pre></div>
<p>Without accounting for measurement error, the path coefficients
estimated using MMR are far deviated from true values.</p>
<div id="lrt-based-p-value" class="section level3">
<h3>LRT Based P-value</h3>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a>reg_lrtp <span class="ot">&lt;-</span> <span class="fu">lrtp</span>(fit_reg)</span>
<span id="cb5-2"><a href="#cb5-2" tabindex="-1"></a>reg_lrtp</span>
<span id="cb5-3"><a href="#cb5-3" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb5-4"><a href="#cb5-4" tabindex="-1"></a><span class="co">#&gt; Parameter Estimates:</span></span>
<span id="cb5-5"><a href="#cb5-5" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb5-6"><a href="#cb5-6" tabindex="-1"></a><span class="co">#&gt;   Standard errors                             Standard</span></span>
<span id="cb5-7"><a href="#cb5-7" tabindex="-1"></a><span class="co">#&gt;   Information                                 Expected</span></span>
<span id="cb5-8"><a href="#cb5-8" tabindex="-1"></a><span class="co">#&gt;   Information saturated (h1) model          Structured</span></span>
<span id="cb5-9"><a href="#cb5-9" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb5-10"><a href="#cb5-10" tabindex="-1"></a><span class="co">#&gt; Regressions:</span></span>
<span id="cb5-11"><a href="#cb5-11" tabindex="-1"></a><span class="co">#&gt;                    Estimate  Std.Err    Chisq     LRTp</span></span>
<span id="cb5-12"><a href="#cb5-12" tabindex="-1"></a><span class="co">#&gt;   Y ~                                                 </span></span>
<span id="cb5-13"><a href="#cb5-13" tabindex="-1"></a><span class="co">#&gt;     x_c       (c0)    0.070    0.013   27.854    0.000</span></span>
<span id="cb5-14"><a href="#cb5-14" tabindex="-1"></a><span class="co">#&gt;     m_c       (c1)    0.085    0.013   38.190    0.000</span></span>
<span id="cb5-15"><a href="#cb5-15" tabindex="-1"></a><span class="co">#&gt;     xm        (c2)    0.023    0.004   34.088    0.000</span></span></code></pre></div>
</div>
</div>
<div id="upi" class="section level2">
<h2>UPI</h2>
<p>The procedure of fitting the UPI model is adapted from Schoemann
<span class="math inline">\(\&amp;\)</span> Jorgensen (2021):</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a><span class="co"># Step 1: Create product indicators</span></span>
<span id="cb6-2"><a href="#cb6-2" tabindex="-1"></a>x_value <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">&quot;x&quot;</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>)</span>
<span id="cb6-3"><a href="#cb6-3" tabindex="-1"></a>m_value <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">&quot;m&quot;</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>)</span>
<span id="cb6-4"><a href="#cb6-4" tabindex="-1"></a>intNames <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="fu">rep</span>(x_value, <span class="at">each =</span> <span class="fu">length</span>(m_value)), m_value) <span class="co"># Create product indicator names</span></span>
<span id="cb6-5"><a href="#cb6-5" tabindex="-1"></a>mod_df <span class="ot">&lt;-</span> <span class="fu">indProd</span>(df, </span>
<span id="cb6-6"><a href="#cb6-6" tabindex="-1"></a>                  <span class="at">var1 =</span> <span class="fu">c</span>(<span class="st">&quot;x1&quot;</span>, <span class="st">&quot;x2&quot;</span>, <span class="st">&quot;x3&quot;</span>),</span>
<span id="cb6-7"><a href="#cb6-7" tabindex="-1"></a>                  <span class="at">var2 =</span> <span class="fu">c</span>(<span class="st">&quot;m1&quot;</span>, <span class="st">&quot;m2&quot;</span>, <span class="st">&quot;m3&quot;</span>),</span>
<span id="cb6-8"><a href="#cb6-8" tabindex="-1"></a>                  <span class="at">match =</span> <span class="cn">FALSE</span>, </span>
<span id="cb6-9"><a href="#cb6-9" tabindex="-1"></a>                  <span class="at">meanC =</span> T, </span>
<span id="cb6-10"><a href="#cb6-10" tabindex="-1"></a>                  <span class="at">residualC =</span> F, </span>
<span id="cb6-11"><a href="#cb6-11" tabindex="-1"></a>                  <span class="at">doubleMC =</span> T,</span>
<span id="cb6-12"><a href="#cb6-12" tabindex="-1"></a>                  <span class="at">namesProd =</span> intNames) <span class="co"># using the DMC strategy</span></span>
<span id="cb6-13"><a href="#cb6-13" tabindex="-1"></a></span>
<span id="cb6-14"><a href="#cb6-14" tabindex="-1"></a><span class="co"># Step 2: Draft the model syntax</span></span>
<span id="cb6-15"><a href="#cb6-15" tabindex="-1"></a>mod_upi <span class="ot">&lt;-</span> <span class="st">&#39;# Measurement Model</span></span>
<span id="cb6-16"><a href="#cb6-16" tabindex="-1"></a><span class="st">            X =~ x1 + x2 + x3</span></span>
<span id="cb6-17"><a href="#cb6-17" tabindex="-1"></a><span class="st">            M =~ m1 + m2 + m3</span></span>
<span id="cb6-18"><a href="#cb6-18" tabindex="-1"></a><span class="st">            XM =~ x1m1 + x1m2 + x1m3 + </span></span>
<span id="cb6-19"><a href="#cb6-19" tabindex="-1"></a><span class="st">                  x2m1 + x2m2 + x2m3 +</span></span>
<span id="cb6-20"><a href="#cb6-20" tabindex="-1"></a><span class="st">                  x3m1 + x3m2 + x3m3</span></span>
<span id="cb6-21"><a href="#cb6-21" tabindex="-1"></a><span class="st">                   </span></span>
<span id="cb6-22"><a href="#cb6-22" tabindex="-1"></a><span class="st">            # Structural Model</span></span>
<span id="cb6-23"><a href="#cb6-23" tabindex="-1"></a><span class="st">            Y ~ b1*X + b2*M + b3*XM</span></span>
<span id="cb6-24"><a href="#cb6-24" tabindex="-1"></a><span class="st">            </span></span>
<span id="cb6-25"><a href="#cb6-25" tabindex="-1"></a><span class="st">            # Covariances between the same indicators are constrained to equality</span></span>
<span id="cb6-26"><a href="#cb6-26" tabindex="-1"></a><span class="st">              x1m1 ~~ th1*x1m2 + th1*x1m3 </span></span>
<span id="cb6-27"><a href="#cb6-27" tabindex="-1"></a><span class="st">              x1m2 ~~ th1*x1m3 </span></span>
<span id="cb6-28"><a href="#cb6-28" tabindex="-1"></a><span class="st">              x2m1 ~~ th2*x2m2 + th2*x2m3 </span></span>
<span id="cb6-29"><a href="#cb6-29" tabindex="-1"></a><span class="st">              x2m2 ~~ th2*x2m3 </span></span>
<span id="cb6-30"><a href="#cb6-30" tabindex="-1"></a><span class="st">              x3m1 ~~ th3*x3m2 + th3*x3m3 </span></span>
<span id="cb6-31"><a href="#cb6-31" tabindex="-1"></a><span class="st">              x3m2 ~~ th3*x3m3</span></span>
<span id="cb6-32"><a href="#cb6-32" tabindex="-1"></a><span class="st">              x1m1 ~~ th4*x2m1 + th4*x3m1 </span></span>
<span id="cb6-33"><a href="#cb6-33" tabindex="-1"></a><span class="st">              x2m1 ~~ th4*x3m1 </span></span>
<span id="cb6-34"><a href="#cb6-34" tabindex="-1"></a><span class="st">              x1m2 ~~ th5*x2m2 + th5*x3m2 </span></span>
<span id="cb6-35"><a href="#cb6-35" tabindex="-1"></a><span class="st">              x2m2 ~~ th5*x3m2 </span></span>
<span id="cb6-36"><a href="#cb6-36" tabindex="-1"></a><span class="st">              x1m3 ~~ th6*x2m3 + th6*x3m3 </span></span>
<span id="cb6-37"><a href="#cb6-37" tabindex="-1"></a><span class="st">              x2m3 ~~ th6*x3m3</span></span>
<span id="cb6-38"><a href="#cb6-38" tabindex="-1"></a></span>
<span id="cb6-39"><a href="#cb6-39" tabindex="-1"></a><span class="st">            # Define Standardized Coefficients</span></span>
<span id="cb6-40"><a href="#cb6-40" tabindex="-1"></a><span class="st">              X ~~ v1*X</span></span>
<span id="cb6-41"><a href="#cb6-41" tabindex="-1"></a><span class="st">              M ~~ v2*M</span></span>
<span id="cb6-42"><a href="#cb6-42" tabindex="-1"></a><span class="st">              beta1 := b1*sqrt(v1)</span></span>
<span id="cb6-43"><a href="#cb6-43" tabindex="-1"></a><span class="st">              beta2 := b2*sqrt(v2)</span></span>
<span id="cb6-44"><a href="#cb6-44" tabindex="-1"></a><span class="st">              beta3 := b3*sqrt(v1)*sqrt(v2)&#39;</span></span>
<span id="cb6-45"><a href="#cb6-45" tabindex="-1"></a></span>
<span id="cb6-46"><a href="#cb6-46" tabindex="-1"></a><span class="co"># Step 3: Fit the model</span></span>
<span id="cb6-47"><a href="#cb6-47" tabindex="-1"></a>fit_upi <span class="ot">&lt;-</span> <span class="fu">sem</span>(mod_upi, mod_df)</span>
<span id="cb6-48"><a href="#cb6-48" tabindex="-1"></a><span class="fu">summary</span>(fit_upi, <span class="at">fit.measure =</span> <span class="cn">TRUE</span>, <span class="at">standardized =</span> <span class="cn">TRUE</span>)</span>
<span id="cb6-49"><a href="#cb6-49" tabindex="-1"></a><span class="co">#&gt; lavaan 0.6-18 ended normally after 61 iterations</span></span>
<span id="cb6-50"><a href="#cb6-50" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb6-51"><a href="#cb6-51" tabindex="-1"></a><span class="co">#&gt;   Estimator                                         ML</span></span>
<span id="cb6-52"><a href="#cb6-52" tabindex="-1"></a><span class="co">#&gt;   Optimization method                           NLMINB</span></span>
<span id="cb6-53"><a href="#cb6-53" tabindex="-1"></a><span class="co">#&gt;   Number of model parameters                        55</span></span>
<span id="cb6-54"><a href="#cb6-54" tabindex="-1"></a><span class="co">#&gt;   Number of equality constraints                    12</span></span>
<span id="cb6-55"><a href="#cb6-55" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb6-56"><a href="#cb6-56" tabindex="-1"></a><span class="co">#&gt;   Number of observations                           500</span></span>
<span id="cb6-57"><a href="#cb6-57" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb6-58"><a href="#cb6-58" tabindex="-1"></a><span class="co">#&gt; Model Test User Model:</span></span>
<span id="cb6-59"><a href="#cb6-59" tabindex="-1"></a><span class="co">#&gt;                                                       </span></span>
<span id="cb6-60"><a href="#cb6-60" tabindex="-1"></a><span class="co">#&gt;   Test statistic                               189.944</span></span>
<span id="cb6-61"><a href="#cb6-61" tabindex="-1"></a><span class="co">#&gt;   Degrees of freedom                                93</span></span>
<span id="cb6-62"><a href="#cb6-62" tabindex="-1"></a><span class="co">#&gt;   P-value (Chi-square)                           0.000</span></span>
<span id="cb6-63"><a href="#cb6-63" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb6-64"><a href="#cb6-64" tabindex="-1"></a><span class="co">#&gt; Model Test Baseline Model:</span></span>
<span id="cb6-65"><a href="#cb6-65" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb6-66"><a href="#cb6-66" tabindex="-1"></a><span class="co">#&gt;   Test statistic                              2380.285</span></span>
<span id="cb6-67"><a href="#cb6-67" tabindex="-1"></a><span class="co">#&gt;   Degrees of freedom                               120</span></span>
<span id="cb6-68"><a href="#cb6-68" tabindex="-1"></a><span class="co">#&gt;   P-value                                        0.000</span></span>
<span id="cb6-69"><a href="#cb6-69" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb6-70"><a href="#cb6-70" tabindex="-1"></a><span class="co">#&gt; User Model versus Baseline Model:</span></span>
<span id="cb6-71"><a href="#cb6-71" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb6-72"><a href="#cb6-72" tabindex="-1"></a><span class="co">#&gt;   Comparative Fit Index (CFI)                    0.957</span></span>
<span id="cb6-73"><a href="#cb6-73" tabindex="-1"></a><span class="co">#&gt;   Tucker-Lewis Index (TLI)                       0.945</span></span>
<span id="cb6-74"><a href="#cb6-74" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb6-75"><a href="#cb6-75" tabindex="-1"></a><span class="co">#&gt; Loglikelihood and Information Criteria:</span></span>
<span id="cb6-76"><a href="#cb6-76" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb6-77"><a href="#cb6-77" tabindex="-1"></a><span class="co">#&gt;   Loglikelihood user model (H0)             -13231.951</span></span>
<span id="cb6-78"><a href="#cb6-78" tabindex="-1"></a><span class="co">#&gt;   Loglikelihood unrestricted model (H1)     -13136.979</span></span>
<span id="cb6-79"><a href="#cb6-79" tabindex="-1"></a><span class="co">#&gt;                                                       </span></span>
<span id="cb6-80"><a href="#cb6-80" tabindex="-1"></a><span class="co">#&gt;   Akaike (AIC)                               26549.902</span></span>
<span id="cb6-81"><a href="#cb6-81" tabindex="-1"></a><span class="co">#&gt;   Bayesian (BIC)                             26731.130</span></span>
<span id="cb6-82"><a href="#cb6-82" tabindex="-1"></a><span class="co">#&gt;   Sample-size adjusted Bayesian (SABIC)      26594.646</span></span>
<span id="cb6-83"><a href="#cb6-83" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb6-84"><a href="#cb6-84" tabindex="-1"></a><span class="co">#&gt; Root Mean Square Error of Approximation:</span></span>
<span id="cb6-85"><a href="#cb6-85" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb6-86"><a href="#cb6-86" tabindex="-1"></a><span class="co">#&gt;   RMSEA                                          0.046</span></span>
<span id="cb6-87"><a href="#cb6-87" tabindex="-1"></a><span class="co">#&gt;   90 Percent confidence interval - lower         0.036</span></span>
<span id="cb6-88"><a href="#cb6-88" tabindex="-1"></a><span class="co">#&gt;   90 Percent confidence interval - upper         0.055</span></span>
<span id="cb6-89"><a href="#cb6-89" tabindex="-1"></a><span class="co">#&gt;   P-value H_0: RMSEA &lt;= 0.050                    0.771</span></span>
<span id="cb6-90"><a href="#cb6-90" tabindex="-1"></a><span class="co">#&gt;   P-value H_0: RMSEA &gt;= 0.080                    0.000</span></span>
<span id="cb6-91"><a href="#cb6-91" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb6-92"><a href="#cb6-92" tabindex="-1"></a><span class="co">#&gt; Standardized Root Mean Square Residual:</span></span>
<span id="cb6-93"><a href="#cb6-93" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb6-94"><a href="#cb6-94" tabindex="-1"></a><span class="co">#&gt;   SRMR                                           0.038</span></span>
<span id="cb6-95"><a href="#cb6-95" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb6-96"><a href="#cb6-96" tabindex="-1"></a><span class="co">#&gt; Parameter Estimates:</span></span>
<span id="cb6-97"><a href="#cb6-97" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb6-98"><a href="#cb6-98" tabindex="-1"></a><span class="co">#&gt;   Standard errors                             Standard</span></span>
<span id="cb6-99"><a href="#cb6-99" tabindex="-1"></a><span class="co">#&gt;   Information                                 Expected</span></span>
<span id="cb6-100"><a href="#cb6-100" tabindex="-1"></a><span class="co">#&gt;   Information saturated (h1) model          Structured</span></span>
<span id="cb6-101"><a href="#cb6-101" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb6-102"><a href="#cb6-102" tabindex="-1"></a><span class="co">#&gt; Latent Variables:</span></span>
<span id="cb6-103"><a href="#cb6-103" tabindex="-1"></a><span class="co">#&gt;                    Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all</span></span>
<span id="cb6-104"><a href="#cb6-104" tabindex="-1"></a><span class="co">#&gt;   X =~                                                                  </span></span>
<span id="cb6-105"><a href="#cb6-105" tabindex="-1"></a><span class="co">#&gt;     x1                1.000                               0.944    0.638</span></span>
<span id="cb6-106"><a href="#cb6-106" tabindex="-1"></a><span class="co">#&gt;     x2                0.867    0.088    9.839    0.000    0.818    0.664</span></span>
<span id="cb6-107"><a href="#cb6-107" tabindex="-1"></a><span class="co">#&gt;     x3                0.773    0.080    9.662    0.000    0.730    0.631</span></span>
<span id="cb6-108"><a href="#cb6-108" tabindex="-1"></a><span class="co">#&gt;   M =~                                                                  </span></span>
<span id="cb6-109"><a href="#cb6-109" tabindex="-1"></a><span class="co">#&gt;     m1                1.000                               0.884    0.624</span></span>
<span id="cb6-110"><a href="#cb6-110" tabindex="-1"></a><span class="co">#&gt;     m2                0.989    0.102    9.653    0.000    0.875    0.649</span></span>
<span id="cb6-111"><a href="#cb6-111" tabindex="-1"></a><span class="co">#&gt;     m3                0.746    0.078    9.565    0.000    0.660    0.634</span></span>
<span id="cb6-112"><a href="#cb6-112" tabindex="-1"></a><span class="co">#&gt;   XM =~                                                                 </span></span>
<span id="cb6-113"><a href="#cb6-113" tabindex="-1"></a><span class="co">#&gt;     x1m1              1.000                               0.976    0.452</span></span>
<span id="cb6-114"><a href="#cb6-114" tabindex="-1"></a><span class="co">#&gt;     x1m2              0.843    0.130    6.480    0.000    0.822    0.420</span></span>
<span id="cb6-115"><a href="#cb6-115" tabindex="-1"></a><span class="co">#&gt;     x1m3              0.716    0.107    6.672    0.000    0.699    0.410</span></span>
<span id="cb6-116"><a href="#cb6-116" tabindex="-1"></a><span class="co">#&gt;     x2m1              0.781    0.122    6.377    0.000    0.762    0.423</span></span>
<span id="cb6-117"><a href="#cb6-117" tabindex="-1"></a><span class="co">#&gt;     x2m2              0.877    0.156    5.634    0.000    0.856    0.474</span></span>
<span id="cb6-118"><a href="#cb6-118" tabindex="-1"></a><span class="co">#&gt;     x2m3              0.669    0.115    5.831    0.000    0.653    0.513</span></span>
<span id="cb6-119"><a href="#cb6-119" tabindex="-1"></a><span class="co">#&gt;     x3m1              0.760    0.115    6.606    0.000    0.741    0.445</span></span>
<span id="cb6-120"><a href="#cb6-120" tabindex="-1"></a><span class="co">#&gt;     x3m2              0.881    0.148    5.950    0.000    0.860    0.541</span></span>
<span id="cb6-121"><a href="#cb6-121" tabindex="-1"></a><span class="co">#&gt;     x3m3              0.638    0.113    5.670    0.000    0.623    0.498</span></span>
<span id="cb6-122"><a href="#cb6-122" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb6-123"><a href="#cb6-123" tabindex="-1"></a><span class="co">#&gt; Regressions:</span></span>
<span id="cb6-124"><a href="#cb6-124" tabindex="-1"></a><span class="co">#&gt;                    Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all</span></span>
<span id="cb6-125"><a href="#cb6-125" tabindex="-1"></a><span class="co">#&gt;   Y ~                                                                   </span></span>
<span id="cb6-126"><a href="#cb6-126" tabindex="-1"></a><span class="co">#&gt;     X         (b1)    0.188    0.075    2.516    0.012    0.177    0.192</span></span>
<span id="cb6-127"><a href="#cb6-127" tabindex="-1"></a><span class="co">#&gt;     M         (b2)    0.375    0.085    4.393    0.000    0.331    0.360</span></span>
<span id="cb6-128"><a href="#cb6-128" tabindex="-1"></a><span class="co">#&gt;     XM        (b3)    0.324    0.068    4.785    0.000    0.316    0.343</span></span>
<span id="cb6-129"><a href="#cb6-129" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb6-130"><a href="#cb6-130" tabindex="-1"></a><span class="co">#&gt; Covariances:</span></span>
<span id="cb6-131"><a href="#cb6-131" tabindex="-1"></a><span class="co">#&gt;                    Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all</span></span>
<span id="cb6-132"><a href="#cb6-132" tabindex="-1"></a><span class="co">#&gt;  .x1m1 ~~                                                               </span></span>
<span id="cb6-133"><a href="#cb6-133" tabindex="-1"></a><span class="co">#&gt;    .x1m2     (th1)    1.124    0.124    9.025    0.000    1.124    0.328</span></span>
<span id="cb6-134"><a href="#cb6-134" tabindex="-1"></a><span class="co">#&gt;    .x1m3     (th1)    1.124    0.124    9.025    0.000    1.124    0.374</span></span>
<span id="cb6-135"><a href="#cb6-135" tabindex="-1"></a><span class="co">#&gt;  .x1m2 ~~                                                               </span></span>
<span id="cb6-136"><a href="#cb6-136" tabindex="-1"></a><span class="co">#&gt;    .x1m3     (th1)    1.124    0.124    9.025    0.000    1.124    0.406</span></span>
<span id="cb6-137"><a href="#cb6-137" tabindex="-1"></a><span class="co">#&gt;  .x2m1 ~~                                                               </span></span>
<span id="cb6-138"><a href="#cb6-138" tabindex="-1"></a><span class="co">#&gt;    .x2m2     (th2)    0.462    0.076    6.123    0.000    0.462    0.178</span></span>
<span id="cb6-139"><a href="#cb6-139" tabindex="-1"></a><span class="co">#&gt;    .x2m3     (th2)    0.462    0.076    6.123    0.000    0.462    0.259</span></span>
<span id="cb6-140"><a href="#cb6-140" tabindex="-1"></a><span class="co">#&gt;  .x2m2 ~~                                                               </span></span>
<span id="cb6-141"><a href="#cb6-141" tabindex="-1"></a><span class="co">#&gt;    .x2m3     (th2)    0.462    0.076    6.123    0.000    0.462    0.266</span></span>
<span id="cb6-142"><a href="#cb6-142" tabindex="-1"></a><span class="co">#&gt;  .x3m1 ~~                                                               </span></span>
<span id="cb6-143"><a href="#cb6-143" tabindex="-1"></a><span class="co">#&gt;    .x3m2     (th3)    0.384    0.068    5.630    0.000    0.384    0.193</span></span>
<span id="cb6-144"><a href="#cb6-144" tabindex="-1"></a><span class="co">#&gt;    .x3m3     (th3)    0.384    0.068    5.630    0.000    0.384    0.237</span></span>
<span id="cb6-145"><a href="#cb6-145" tabindex="-1"></a><span class="co">#&gt;  .x3m2 ~~                                                               </span></span>
<span id="cb6-146"><a href="#cb6-146" tabindex="-1"></a><span class="co">#&gt;    .x3m3     (th3)    0.384    0.068    5.630    0.000    0.384    0.265</span></span>
<span id="cb6-147"><a href="#cb6-147" tabindex="-1"></a><span class="co">#&gt;  .x1m1 ~~                                                               </span></span>
<span id="cb6-148"><a href="#cb6-148" tabindex="-1"></a><span class="co">#&gt;    .x2m1     (th4)    0.851    0.111    7.702    0.000    0.851    0.270</span></span>
<span id="cb6-149"><a href="#cb6-149" tabindex="-1"></a><span class="co">#&gt;    .x3m1     (th4)    0.851    0.111    7.702    0.000    0.851    0.296</span></span>
<span id="cb6-150"><a href="#cb6-150" tabindex="-1"></a><span class="co">#&gt;  .x2m1 ~~                                                               </span></span>
<span id="cb6-151"><a href="#cb6-151" tabindex="-1"></a><span class="co">#&gt;    .x3m1     (th4)    0.851    0.111    7.702    0.000    0.851    0.350</span></span>
<span id="cb6-152"><a href="#cb6-152" tabindex="-1"></a><span class="co">#&gt;  .x1m2 ~~                                                               </span></span>
<span id="cb6-153"><a href="#cb6-153" tabindex="-1"></a><span class="co">#&gt;    .x2m2     (th5)    0.625    0.101    6.196    0.000    0.625    0.221</span></span>
<span id="cb6-154"><a href="#cb6-154" tabindex="-1"></a><span class="co">#&gt;    .x3m2     (th5)    0.625    0.101    6.196    0.000    0.625    0.263</span></span>
<span id="cb6-155"><a href="#cb6-155" tabindex="-1"></a><span class="co">#&gt;  .x2m2 ~~                                                               </span></span>
<span id="cb6-156"><a href="#cb6-156" tabindex="-1"></a><span class="co">#&gt;    .x3m2     (th5)    0.625    0.101    6.196    0.000    0.625    0.295</span></span>
<span id="cb6-157"><a href="#cb6-157" tabindex="-1"></a><span class="co">#&gt;  .x1m3 ~~                                                               </span></span>
<span id="cb6-158"><a href="#cb6-158" tabindex="-1"></a><span class="co">#&gt;    .x2m3     (th6)    0.390    0.059    6.648    0.000    0.390    0.229</span></span>
<span id="cb6-159"><a href="#cb6-159" tabindex="-1"></a><span class="co">#&gt;    .x3m3     (th6)    0.390    0.059    6.648    0.000    0.390    0.231</span></span>
<span id="cb6-160"><a href="#cb6-160" tabindex="-1"></a><span class="co">#&gt;  .x2m3 ~~                                                               </span></span>
<span id="cb6-161"><a href="#cb6-161" tabindex="-1"></a><span class="co">#&gt;    .x3m3     (th6)    0.390    0.059    6.648    0.000    0.390    0.329</span></span>
<span id="cb6-162"><a href="#cb6-162" tabindex="-1"></a><span class="co">#&gt;   X ~~                                                                  </span></span>
<span id="cb6-163"><a href="#cb6-163" tabindex="-1"></a><span class="co">#&gt;     M                 0.498    0.074    6.772    0.000    0.597    0.597</span></span>
<span id="cb6-164"><a href="#cb6-164" tabindex="-1"></a><span class="co">#&gt;     XM                0.037    0.067    0.545    0.586    0.040    0.040</span></span>
<span id="cb6-165"><a href="#cb6-165" tabindex="-1"></a><span class="co">#&gt;   M ~~                                                                  </span></span>
<span id="cb6-166"><a href="#cb6-166" tabindex="-1"></a><span class="co">#&gt;     XM               -0.136    0.066   -2.064    0.039   -0.158   -0.158</span></span>
<span id="cb6-167"><a href="#cb6-167" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb6-168"><a href="#cb6-168" tabindex="-1"></a><span class="co">#&gt; Variances:</span></span>
<span id="cb6-169"><a href="#cb6-169" tabindex="-1"></a><span class="co">#&gt;                    Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all</span></span>
<span id="cb6-170"><a href="#cb6-170" tabindex="-1"></a><span class="co">#&gt;     X         (v1)    0.891    0.137    6.520    0.000    1.000    1.000</span></span>
<span id="cb6-171"><a href="#cb6-171" tabindex="-1"></a><span class="co">#&gt;     M         (v2)    0.782    0.123    6.376    0.000    1.000    1.000</span></span>
<span id="cb6-172"><a href="#cb6-172" tabindex="-1"></a><span class="co">#&gt;    .x1                1.300    0.114   11.400    0.000    1.300    0.593</span></span>
<span id="cb6-173"><a href="#cb6-173" tabindex="-1"></a><span class="co">#&gt;    .x2                0.848    0.079   10.723    0.000    0.848    0.559</span></span>
<span id="cb6-174"><a href="#cb6-174" tabindex="-1"></a><span class="co">#&gt;    .x3                0.803    0.069   11.550    0.000    0.803    0.601</span></span>
<span id="cb6-175"><a href="#cb6-175" tabindex="-1"></a><span class="co">#&gt;    .m1                1.224    0.105   11.705    0.000    1.224    0.610</span></span>
<span id="cb6-176"><a href="#cb6-176" tabindex="-1"></a><span class="co">#&gt;    .m2                1.053    0.095   11.130    0.000    1.053    0.579</span></span>
<span id="cb6-177"><a href="#cb6-177" tabindex="-1"></a><span class="co">#&gt;    .m3                0.649    0.056   11.490    0.000    0.649    0.598</span></span>
<span id="cb6-178"><a href="#cb6-178" tabindex="-1"></a><span class="co">#&gt;    .x1m1              3.719    0.231   16.069    0.000    3.719    0.796</span></span>
<span id="cb6-179"><a href="#cb6-179" tabindex="-1"></a><span class="co">#&gt;    .x1m2              3.158    0.200   15.777    0.000    3.158    0.824</span></span>
<span id="cb6-180"><a href="#cb6-180" tabindex="-1"></a><span class="co">#&gt;    .x1m3              2.422    0.156   15.565    0.000    2.422    0.832</span></span>
<span id="cb6-181"><a href="#cb6-181" tabindex="-1"></a><span class="co">#&gt;    .x2m1              2.666    0.175   15.246    0.000    2.666    0.821</span></span>
<span id="cb6-182"><a href="#cb6-182" tabindex="-1"></a><span class="co">#&gt;    .x2m2              2.523    0.176   14.341    0.000    2.523    0.775</span></span>
<span id="cb6-183"><a href="#cb6-183" tabindex="-1"></a><span class="co">#&gt;    .x2m3              1.194    0.095   12.532    0.000    1.194    0.737</span></span>
<span id="cb6-184"><a href="#cb6-184" tabindex="-1"></a><span class="co">#&gt;    .x3m1              2.223    0.152   14.621    0.000    2.223    0.802</span></span>
<span id="cb6-185"><a href="#cb6-185" tabindex="-1"></a><span class="co">#&gt;    .x3m2              1.785    0.144   12.431    0.000    1.785    0.707</span></span>
<span id="cb6-186"><a href="#cb6-186" tabindex="-1"></a><span class="co">#&gt;    .x3m3              1.176    0.092   12.768    0.000    1.176    0.752</span></span>
<span id="cb6-187"><a href="#cb6-187" tabindex="-1"></a><span class="co">#&gt;    .Y                 0.566    0.045   12.462    0.000    0.566    0.667</span></span>
<span id="cb6-188"><a href="#cb6-188" tabindex="-1"></a><span class="co">#&gt;     XM                0.952    0.240    3.968    0.000    1.000    1.000</span></span>
<span id="cb6-189"><a href="#cb6-189" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb6-190"><a href="#cb6-190" tabindex="-1"></a><span class="co">#&gt; Defined Parameters:</span></span>
<span id="cb6-191"><a href="#cb6-191" tabindex="-1"></a><span class="co">#&gt;                    Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all</span></span>
<span id="cb6-192"><a href="#cb6-192" tabindex="-1"></a><span class="co">#&gt;     beta1             0.177    0.069    2.559    0.011    0.177    0.192</span></span>
<span id="cb6-193"><a href="#cb6-193" tabindex="-1"></a><span class="co">#&gt;     beta2             0.331    0.071    4.656    0.000    0.331    0.360</span></span>
<span id="cb6-194"><a href="#cb6-194" tabindex="-1"></a><span class="co">#&gt;     beta3             0.271    0.064    4.220    0.000    0.316    0.343</span></span></code></pre></div>
<p>The steps above have been wrapped up into a function
<code>upi</code>. Here is an example demonstration:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a><span class="co"># Draft the model syntax</span></span>
<span id="cb7-2"><a href="#cb7-2" tabindex="-1"></a>mod_upi <span class="ot">&lt;-</span> <span class="st">&#39;# Measurement Model</span></span>
<span id="cb7-3"><a href="#cb7-3" tabindex="-1"></a><span class="st">              X =~ x1 + x2 + x3</span></span>
<span id="cb7-4"><a href="#cb7-4" tabindex="-1"></a><span class="st">              M =~ m1 + m2 + m3</span></span>
<span id="cb7-5"><a href="#cb7-5" tabindex="-1"></a><span class="st">            # Structural Model</span></span>
<span id="cb7-6"><a href="#cb7-6" tabindex="-1"></a><span class="st">              Y ~ b1 * X + b2 * M + b3 * X:M</span></span>
<span id="cb7-7"><a href="#cb7-7" tabindex="-1"></a><span class="st">            # Define Standardized Coefficients</span></span>
<span id="cb7-8"><a href="#cb7-8" tabindex="-1"></a><span class="st">              X ~~ v1*X</span></span>
<span id="cb7-9"><a href="#cb7-9" tabindex="-1"></a><span class="st">              M ~~ v2*M</span></span>
<span id="cb7-10"><a href="#cb7-10" tabindex="-1"></a><span class="st">              </span></span>
<span id="cb7-11"><a href="#cb7-11" tabindex="-1"></a><span class="st">              beta1 := b1*sqrt(v1)</span></span>
<span id="cb7-12"><a href="#cb7-12" tabindex="-1"></a><span class="st">              beta2 := b2*sqrt(v2)</span></span>
<span id="cb7-13"><a href="#cb7-13" tabindex="-1"></a><span class="st">              beta3 := b3*sqrt(v1)*sqrt(v2)&#39;</span></span>
<span id="cb7-14"><a href="#cb7-14" tabindex="-1"></a></span>
<span id="cb7-15"><a href="#cb7-15" tabindex="-1"></a><span class="co"># Fit the model using upi()</span></span>
<span id="cb7-16"><a href="#cb7-16" tabindex="-1"></a>fit_upi <span class="ot">&lt;-</span> <span class="fu">upi</span>(mod_upi, df, <span class="at">mode =</span> <span class="st">&quot;all&quot;</span>) <span class="co"># All-pair UPI</span></span>
<span id="cb7-17"><a href="#cb7-17" tabindex="-1"></a><span class="fu">summary</span>(fit_upi, <span class="at">fit.measure =</span> <span class="cn">TRUE</span>, <span class="at">standardized =</span> <span class="cn">TRUE</span>)</span>
<span id="cb7-18"><a href="#cb7-18" tabindex="-1"></a><span class="co">#&gt; lavaan 0.6-18 ended normally after 61 iterations</span></span>
<span id="cb7-19"><a href="#cb7-19" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb7-20"><a href="#cb7-20" tabindex="-1"></a><span class="co">#&gt;   Estimator                                         ML</span></span>
<span id="cb7-21"><a href="#cb7-21" tabindex="-1"></a><span class="co">#&gt;   Optimization method                           NLMINB</span></span>
<span id="cb7-22"><a href="#cb7-22" tabindex="-1"></a><span class="co">#&gt;   Number of model parameters                        55</span></span>
<span id="cb7-23"><a href="#cb7-23" tabindex="-1"></a><span class="co">#&gt;   Number of equality constraints                    12</span></span>
<span id="cb7-24"><a href="#cb7-24" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb7-25"><a href="#cb7-25" tabindex="-1"></a><span class="co">#&gt;   Number of observations                           500</span></span>
<span id="cb7-26"><a href="#cb7-26" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb7-27"><a href="#cb7-27" tabindex="-1"></a><span class="co">#&gt; Model Test User Model:</span></span>
<span id="cb7-28"><a href="#cb7-28" tabindex="-1"></a><span class="co">#&gt;                                                       </span></span>
<span id="cb7-29"><a href="#cb7-29" tabindex="-1"></a><span class="co">#&gt;   Test statistic                               189.944</span></span>
<span id="cb7-30"><a href="#cb7-30" tabindex="-1"></a><span class="co">#&gt;   Degrees of freedom                                93</span></span>
<span id="cb7-31"><a href="#cb7-31" tabindex="-1"></a><span class="co">#&gt;   P-value (Chi-square)                           0.000</span></span>
<span id="cb7-32"><a href="#cb7-32" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb7-33"><a href="#cb7-33" tabindex="-1"></a><span class="co">#&gt; Model Test Baseline Model:</span></span>
<span id="cb7-34"><a href="#cb7-34" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb7-35"><a href="#cb7-35" tabindex="-1"></a><span class="co">#&gt;   Test statistic                              2380.285</span></span>
<span id="cb7-36"><a href="#cb7-36" tabindex="-1"></a><span class="co">#&gt;   Degrees of freedom                               120</span></span>
<span id="cb7-37"><a href="#cb7-37" tabindex="-1"></a><span class="co">#&gt;   P-value                                        0.000</span></span>
<span id="cb7-38"><a href="#cb7-38" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb7-39"><a href="#cb7-39" tabindex="-1"></a><span class="co">#&gt; User Model versus Baseline Model:</span></span>
<span id="cb7-40"><a href="#cb7-40" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb7-41"><a href="#cb7-41" tabindex="-1"></a><span class="co">#&gt;   Comparative Fit Index (CFI)                    0.957</span></span>
<span id="cb7-42"><a href="#cb7-42" tabindex="-1"></a><span class="co">#&gt;   Tucker-Lewis Index (TLI)                       0.945</span></span>
<span id="cb7-43"><a href="#cb7-43" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb7-44"><a href="#cb7-44" tabindex="-1"></a><span class="co">#&gt; Loglikelihood and Information Criteria:</span></span>
<span id="cb7-45"><a href="#cb7-45" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb7-46"><a href="#cb7-46" tabindex="-1"></a><span class="co">#&gt;   Loglikelihood user model (H0)             -13231.951</span></span>
<span id="cb7-47"><a href="#cb7-47" tabindex="-1"></a><span class="co">#&gt;   Loglikelihood unrestricted model (H1)     -13136.979</span></span>
<span id="cb7-48"><a href="#cb7-48" tabindex="-1"></a><span class="co">#&gt;                                                       </span></span>
<span id="cb7-49"><a href="#cb7-49" tabindex="-1"></a><span class="co">#&gt;   Akaike (AIC)                               26549.902</span></span>
<span id="cb7-50"><a href="#cb7-50" tabindex="-1"></a><span class="co">#&gt;   Bayesian (BIC)                             26731.130</span></span>
<span id="cb7-51"><a href="#cb7-51" tabindex="-1"></a><span class="co">#&gt;   Sample-size adjusted Bayesian (SABIC)      26594.646</span></span>
<span id="cb7-52"><a href="#cb7-52" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb7-53"><a href="#cb7-53" tabindex="-1"></a><span class="co">#&gt; Root Mean Square Error of Approximation:</span></span>
<span id="cb7-54"><a href="#cb7-54" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb7-55"><a href="#cb7-55" tabindex="-1"></a><span class="co">#&gt;   RMSEA                                          0.046</span></span>
<span id="cb7-56"><a href="#cb7-56" tabindex="-1"></a><span class="co">#&gt;   90 Percent confidence interval - lower         0.036</span></span>
<span id="cb7-57"><a href="#cb7-57" tabindex="-1"></a><span class="co">#&gt;   90 Percent confidence interval - upper         0.055</span></span>
<span id="cb7-58"><a href="#cb7-58" tabindex="-1"></a><span class="co">#&gt;   P-value H_0: RMSEA &lt;= 0.050                    0.771</span></span>
<span id="cb7-59"><a href="#cb7-59" tabindex="-1"></a><span class="co">#&gt;   P-value H_0: RMSEA &gt;= 0.080                    0.000</span></span>
<span id="cb7-60"><a href="#cb7-60" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb7-61"><a href="#cb7-61" tabindex="-1"></a><span class="co">#&gt; Standardized Root Mean Square Residual:</span></span>
<span id="cb7-62"><a href="#cb7-62" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb7-63"><a href="#cb7-63" tabindex="-1"></a><span class="co">#&gt;   SRMR                                           0.038</span></span>
<span id="cb7-64"><a href="#cb7-64" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb7-65"><a href="#cb7-65" tabindex="-1"></a><span class="co">#&gt; Parameter Estimates:</span></span>
<span id="cb7-66"><a href="#cb7-66" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb7-67"><a href="#cb7-67" tabindex="-1"></a><span class="co">#&gt;   Standard errors                             Standard</span></span>
<span id="cb7-68"><a href="#cb7-68" tabindex="-1"></a><span class="co">#&gt;   Information                                 Expected</span></span>
<span id="cb7-69"><a href="#cb7-69" tabindex="-1"></a><span class="co">#&gt;   Information saturated (h1) model          Structured</span></span>
<span id="cb7-70"><a href="#cb7-70" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb7-71"><a href="#cb7-71" tabindex="-1"></a><span class="co">#&gt; Latent Variables:</span></span>
<span id="cb7-72"><a href="#cb7-72" tabindex="-1"></a><span class="co">#&gt;                    Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all</span></span>
<span id="cb7-73"><a href="#cb7-73" tabindex="-1"></a><span class="co">#&gt;   X =~                                                                  </span></span>
<span id="cb7-74"><a href="#cb7-74" tabindex="-1"></a><span class="co">#&gt;     x1                1.000                               0.944    0.638</span></span>
<span id="cb7-75"><a href="#cb7-75" tabindex="-1"></a><span class="co">#&gt;     x2                0.867    0.088    9.839    0.000    0.818    0.664</span></span>
<span id="cb7-76"><a href="#cb7-76" tabindex="-1"></a><span class="co">#&gt;     x3                0.773    0.080    9.662    0.000    0.730    0.631</span></span>
<span id="cb7-77"><a href="#cb7-77" tabindex="-1"></a><span class="co">#&gt;   M =~                                                                  </span></span>
<span id="cb7-78"><a href="#cb7-78" tabindex="-1"></a><span class="co">#&gt;     m1                1.000                               0.884    0.624</span></span>
<span id="cb7-79"><a href="#cb7-79" tabindex="-1"></a><span class="co">#&gt;     m2                0.989    0.102    9.653    0.000    0.875    0.649</span></span>
<span id="cb7-80"><a href="#cb7-80" tabindex="-1"></a><span class="co">#&gt;     m3                0.746    0.078    9.565    0.000    0.660    0.634</span></span>
<span id="cb7-81"><a href="#cb7-81" tabindex="-1"></a><span class="co">#&gt;   X_int_M =~                                                            </span></span>
<span id="cb7-82"><a href="#cb7-82" tabindex="-1"></a><span class="co">#&gt;     x1m1              1.000                               0.976    0.452</span></span>
<span id="cb7-83"><a href="#cb7-83" tabindex="-1"></a><span class="co">#&gt;     x1m2              0.843    0.130    6.480    0.000    0.822    0.420</span></span>
<span id="cb7-84"><a href="#cb7-84" tabindex="-1"></a><span class="co">#&gt;     x1m3              0.716    0.107    6.672    0.000    0.699    0.410</span></span>
<span id="cb7-85"><a href="#cb7-85" tabindex="-1"></a><span class="co">#&gt;     x2m1              0.781    0.122    6.377    0.000    0.762    0.423</span></span>
<span id="cb7-86"><a href="#cb7-86" tabindex="-1"></a><span class="co">#&gt;     x2m2              0.877    0.156    5.634    0.000    0.856    0.474</span></span>
<span id="cb7-87"><a href="#cb7-87" tabindex="-1"></a><span class="co">#&gt;     x2m3              0.669    0.115    5.831    0.000    0.653    0.513</span></span>
<span id="cb7-88"><a href="#cb7-88" tabindex="-1"></a><span class="co">#&gt;     x3m1              0.760    0.115    6.606    0.000    0.741    0.445</span></span>
<span id="cb7-89"><a href="#cb7-89" tabindex="-1"></a><span class="co">#&gt;     x3m2              0.881    0.148    5.950    0.000    0.860    0.541</span></span>
<span id="cb7-90"><a href="#cb7-90" tabindex="-1"></a><span class="co">#&gt;     x3m3              0.638    0.113    5.670    0.000    0.623    0.498</span></span>
<span id="cb7-91"><a href="#cb7-91" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb7-92"><a href="#cb7-92" tabindex="-1"></a><span class="co">#&gt; Regressions:</span></span>
<span id="cb7-93"><a href="#cb7-93" tabindex="-1"></a><span class="co">#&gt;                    Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all</span></span>
<span id="cb7-94"><a href="#cb7-94" tabindex="-1"></a><span class="co">#&gt;   Y ~                                                                   </span></span>
<span id="cb7-95"><a href="#cb7-95" tabindex="-1"></a><span class="co">#&gt;     X         (b1)    0.188    0.075    2.516    0.012    0.177    0.192</span></span>
<span id="cb7-96"><a href="#cb7-96" tabindex="-1"></a><span class="co">#&gt;     M         (b2)    0.375    0.085    4.393    0.000    0.331    0.360</span></span>
<span id="cb7-97"><a href="#cb7-97" tabindex="-1"></a><span class="co">#&gt;     X_int_M   (b3)    0.324    0.068    4.785    0.000    0.316    0.343</span></span>
<span id="cb7-98"><a href="#cb7-98" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb7-99"><a href="#cb7-99" tabindex="-1"></a><span class="co">#&gt; Covariances:</span></span>
<span id="cb7-100"><a href="#cb7-100" tabindex="-1"></a><span class="co">#&gt;                    Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all</span></span>
<span id="cb7-101"><a href="#cb7-101" tabindex="-1"></a><span class="co">#&gt;  .x1m1 ~~                                                               </span></span>
<span id="cb7-102"><a href="#cb7-102" tabindex="-1"></a><span class="co">#&gt;    .x1m2     (th1)    1.124    0.124    9.025    0.000    1.124    0.328</span></span>
<span id="cb7-103"><a href="#cb7-103" tabindex="-1"></a><span class="co">#&gt;    .x1m3     (th1)    1.124    0.124    9.025    0.000    1.124    0.374</span></span>
<span id="cb7-104"><a href="#cb7-104" tabindex="-1"></a><span class="co">#&gt;  .x1m2 ~~                                                               </span></span>
<span id="cb7-105"><a href="#cb7-105" tabindex="-1"></a><span class="co">#&gt;    .x1m3     (th1)    1.124    0.124    9.025    0.000    1.124    0.406</span></span>
<span id="cb7-106"><a href="#cb7-106" tabindex="-1"></a><span class="co">#&gt;  .x2m1 ~~                                                               </span></span>
<span id="cb7-107"><a href="#cb7-107" tabindex="-1"></a><span class="co">#&gt;    .x2m2     (th2)    0.462    0.076    6.123    0.000    0.462    0.178</span></span>
<span id="cb7-108"><a href="#cb7-108" tabindex="-1"></a><span class="co">#&gt;    .x2m3     (th2)    0.462    0.076    6.123    0.000    0.462    0.259</span></span>
<span id="cb7-109"><a href="#cb7-109" tabindex="-1"></a><span class="co">#&gt;  .x2m2 ~~                                                               </span></span>
<span id="cb7-110"><a href="#cb7-110" tabindex="-1"></a><span class="co">#&gt;    .x2m3     (th2)    0.462    0.076    6.123    0.000    0.462    0.266</span></span>
<span id="cb7-111"><a href="#cb7-111" tabindex="-1"></a><span class="co">#&gt;  .x3m1 ~~                                                               </span></span>
<span id="cb7-112"><a href="#cb7-112" tabindex="-1"></a><span class="co">#&gt;    .x3m2     (th3)    0.384    0.068    5.630    0.000    0.384    0.193</span></span>
<span id="cb7-113"><a href="#cb7-113" tabindex="-1"></a><span class="co">#&gt;    .x3m3     (th3)    0.384    0.068    5.630    0.000    0.384    0.237</span></span>
<span id="cb7-114"><a href="#cb7-114" tabindex="-1"></a><span class="co">#&gt;  .x3m2 ~~                                                               </span></span>
<span id="cb7-115"><a href="#cb7-115" tabindex="-1"></a><span class="co">#&gt;    .x3m3     (th3)    0.384    0.068    5.630    0.000    0.384    0.265</span></span>
<span id="cb7-116"><a href="#cb7-116" tabindex="-1"></a><span class="co">#&gt;  .x1m1 ~~                                                               </span></span>
<span id="cb7-117"><a href="#cb7-117" tabindex="-1"></a><span class="co">#&gt;    .x2m1     (th4)    0.851    0.111    7.702    0.000    0.851    0.270</span></span>
<span id="cb7-118"><a href="#cb7-118" tabindex="-1"></a><span class="co">#&gt;    .x3m1     (th4)    0.851    0.111    7.702    0.000    0.851    0.296</span></span>
<span id="cb7-119"><a href="#cb7-119" tabindex="-1"></a><span class="co">#&gt;  .x2m1 ~~                                                               </span></span>
<span id="cb7-120"><a href="#cb7-120" tabindex="-1"></a><span class="co">#&gt;    .x3m1     (th4)    0.851    0.111    7.702    0.000    0.851    0.350</span></span>
<span id="cb7-121"><a href="#cb7-121" tabindex="-1"></a><span class="co">#&gt;  .x1m2 ~~                                                               </span></span>
<span id="cb7-122"><a href="#cb7-122" tabindex="-1"></a><span class="co">#&gt;    .x2m2     (th5)    0.625    0.101    6.196    0.000    0.625    0.221</span></span>
<span id="cb7-123"><a href="#cb7-123" tabindex="-1"></a><span class="co">#&gt;    .x3m2     (th5)    0.625    0.101    6.196    0.000    0.625    0.263</span></span>
<span id="cb7-124"><a href="#cb7-124" tabindex="-1"></a><span class="co">#&gt;  .x2m2 ~~                                                               </span></span>
<span id="cb7-125"><a href="#cb7-125" tabindex="-1"></a><span class="co">#&gt;    .x3m2     (th5)    0.625    0.101    6.196    0.000    0.625    0.295</span></span>
<span id="cb7-126"><a href="#cb7-126" tabindex="-1"></a><span class="co">#&gt;  .x1m3 ~~                                                               </span></span>
<span id="cb7-127"><a href="#cb7-127" tabindex="-1"></a><span class="co">#&gt;    .x2m3     (th6)    0.390    0.059    6.648    0.000    0.390    0.229</span></span>
<span id="cb7-128"><a href="#cb7-128" tabindex="-1"></a><span class="co">#&gt;    .x3m3     (th6)    0.390    0.059    6.648    0.000    0.390    0.231</span></span>
<span id="cb7-129"><a href="#cb7-129" tabindex="-1"></a><span class="co">#&gt;  .x2m3 ~~                                                               </span></span>
<span id="cb7-130"><a href="#cb7-130" tabindex="-1"></a><span class="co">#&gt;    .x3m3     (th6)    0.390    0.059    6.648    0.000    0.390    0.329</span></span>
<span id="cb7-131"><a href="#cb7-131" tabindex="-1"></a><span class="co">#&gt;   X ~~                                                                  </span></span>
<span id="cb7-132"><a href="#cb7-132" tabindex="-1"></a><span class="co">#&gt;     M                 0.498    0.074    6.772    0.000    0.597    0.597</span></span>
<span id="cb7-133"><a href="#cb7-133" tabindex="-1"></a><span class="co">#&gt;     X_int_M           0.037    0.067    0.545    0.586    0.040    0.040</span></span>
<span id="cb7-134"><a href="#cb7-134" tabindex="-1"></a><span class="co">#&gt;   M ~~                                                                  </span></span>
<span id="cb7-135"><a href="#cb7-135" tabindex="-1"></a><span class="co">#&gt;     X_int_M          -0.136    0.066   -2.064    0.039   -0.158   -0.158</span></span>
<span id="cb7-136"><a href="#cb7-136" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb7-137"><a href="#cb7-137" tabindex="-1"></a><span class="co">#&gt; Variances:</span></span>
<span id="cb7-138"><a href="#cb7-138" tabindex="-1"></a><span class="co">#&gt;                    Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all</span></span>
<span id="cb7-139"><a href="#cb7-139" tabindex="-1"></a><span class="co">#&gt;     X         (v1)    0.891    0.137    6.520    0.000    1.000    1.000</span></span>
<span id="cb7-140"><a href="#cb7-140" tabindex="-1"></a><span class="co">#&gt;     M         (v2)    0.782    0.123    6.376    0.000    1.000    1.000</span></span>
<span id="cb7-141"><a href="#cb7-141" tabindex="-1"></a><span class="co">#&gt;    .x1                1.300    0.114   11.400    0.000    1.300    0.593</span></span>
<span id="cb7-142"><a href="#cb7-142" tabindex="-1"></a><span class="co">#&gt;    .x2                0.848    0.079   10.723    0.000    0.848    0.559</span></span>
<span id="cb7-143"><a href="#cb7-143" tabindex="-1"></a><span class="co">#&gt;    .x3                0.803    0.069   11.550    0.000    0.803    0.601</span></span>
<span id="cb7-144"><a href="#cb7-144" tabindex="-1"></a><span class="co">#&gt;    .m1                1.224    0.105   11.705    0.000    1.224    0.610</span></span>
<span id="cb7-145"><a href="#cb7-145" tabindex="-1"></a><span class="co">#&gt;    .m2                1.053    0.095   11.130    0.000    1.053    0.579</span></span>
<span id="cb7-146"><a href="#cb7-146" tabindex="-1"></a><span class="co">#&gt;    .m3                0.649    0.056   11.490    0.000    0.649    0.598</span></span>
<span id="cb7-147"><a href="#cb7-147" tabindex="-1"></a><span class="co">#&gt;    .x1m1              3.719    0.231   16.069    0.000    3.719    0.796</span></span>
<span id="cb7-148"><a href="#cb7-148" tabindex="-1"></a><span class="co">#&gt;    .x1m2              3.158    0.200   15.777    0.000    3.158    0.824</span></span>
<span id="cb7-149"><a href="#cb7-149" tabindex="-1"></a><span class="co">#&gt;    .x1m3              2.422    0.156   15.565    0.000    2.422    0.832</span></span>
<span id="cb7-150"><a href="#cb7-150" tabindex="-1"></a><span class="co">#&gt;    .x2m1              2.666    0.175   15.246    0.000    2.666    0.821</span></span>
<span id="cb7-151"><a href="#cb7-151" tabindex="-1"></a><span class="co">#&gt;    .x2m2              2.523    0.176   14.341    0.000    2.523    0.775</span></span>
<span id="cb7-152"><a href="#cb7-152" tabindex="-1"></a><span class="co">#&gt;    .x2m3              1.194    0.095   12.532    0.000    1.194    0.737</span></span>
<span id="cb7-153"><a href="#cb7-153" tabindex="-1"></a><span class="co">#&gt;    .x3m1              2.223    0.152   14.621    0.000    2.223    0.802</span></span>
<span id="cb7-154"><a href="#cb7-154" tabindex="-1"></a><span class="co">#&gt;    .x3m2              1.785    0.144   12.431    0.000    1.785    0.707</span></span>
<span id="cb7-155"><a href="#cb7-155" tabindex="-1"></a><span class="co">#&gt;    .x3m3              1.176    0.092   12.768    0.000    1.176    0.752</span></span>
<span id="cb7-156"><a href="#cb7-156" tabindex="-1"></a><span class="co">#&gt;    .Y                 0.566    0.045   12.462    0.000    0.566    0.667</span></span>
<span id="cb7-157"><a href="#cb7-157" tabindex="-1"></a><span class="co">#&gt;     X_int_M           0.952    0.240    3.968    0.000    1.000    1.000</span></span>
<span id="cb7-158"><a href="#cb7-158" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb7-159"><a href="#cb7-159" tabindex="-1"></a><span class="co">#&gt; Defined Parameters:</span></span>
<span id="cb7-160"><a href="#cb7-160" tabindex="-1"></a><span class="co">#&gt;                    Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all</span></span>
<span id="cb7-161"><a href="#cb7-161" tabindex="-1"></a><span class="co">#&gt;     beta1             0.177    0.069    2.559    0.011    0.177    0.192</span></span>
<span id="cb7-162"><a href="#cb7-162" tabindex="-1"></a><span class="co">#&gt;     beta2             0.331    0.071    4.656    0.000    0.331    0.360</span></span>
<span id="cb7-163"><a href="#cb7-163" tabindex="-1"></a><span class="co">#&gt;     beta3             0.271    0.064    4.220    0.000    0.316    0.343</span></span>
<span id="cb7-164"><a href="#cb7-164" tabindex="-1"></a></span>
<span id="cb7-165"><a href="#cb7-165" tabindex="-1"></a><span class="co"># Matched-pair</span></span>
<span id="cb7-166"><a href="#cb7-166" tabindex="-1"></a>fit_upi_matched <span class="ot">&lt;-</span> <span class="fu">upi</span>(mod_upi, df, <span class="at">mode =</span> <span class="st">&quot;match&quot;</span>)</span>
<span id="cb7-167"><a href="#cb7-167" tabindex="-1"></a><span class="fu">summary</span>(fit_upi_matched, <span class="at">fit.measure =</span> <span class="cn">TRUE</span>, <span class="at">standardized =</span> <span class="cn">TRUE</span>)</span>
<span id="cb7-168"><a href="#cb7-168" tabindex="-1"></a><span class="co">#&gt; lavaan 0.6-18 ended normally after 45 iterations</span></span>
<span id="cb7-169"><a href="#cb7-169" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb7-170"><a href="#cb7-170" tabindex="-1"></a><span class="co">#&gt;   Estimator                                         ML</span></span>
<span id="cb7-171"><a href="#cb7-171" tabindex="-1"></a><span class="co">#&gt;   Optimization method                           NLMINB</span></span>
<span id="cb7-172"><a href="#cb7-172" tabindex="-1"></a><span class="co">#&gt;   Number of model parameters                        25</span></span>
<span id="cb7-173"><a href="#cb7-173" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb7-174"><a href="#cb7-174" tabindex="-1"></a><span class="co">#&gt;   Number of observations                           500</span></span>
<span id="cb7-175"><a href="#cb7-175" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb7-176"><a href="#cb7-176" tabindex="-1"></a><span class="co">#&gt; Model Test User Model:</span></span>
<span id="cb7-177"><a href="#cb7-177" tabindex="-1"></a><span class="co">#&gt;                                                       </span></span>
<span id="cb7-178"><a href="#cb7-178" tabindex="-1"></a><span class="co">#&gt;   Test statistic                                53.858</span></span>
<span id="cb7-179"><a href="#cb7-179" tabindex="-1"></a><span class="co">#&gt;   Degrees of freedom                                30</span></span>
<span id="cb7-180"><a href="#cb7-180" tabindex="-1"></a><span class="co">#&gt;   P-value (Chi-square)                           0.005</span></span>
<span id="cb7-181"><a href="#cb7-181" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb7-182"><a href="#cb7-182" tabindex="-1"></a><span class="co">#&gt; Model Test Baseline Model:</span></span>
<span id="cb7-183"><a href="#cb7-183" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb7-184"><a href="#cb7-184" tabindex="-1"></a><span class="co">#&gt;   Test statistic                               786.415</span></span>
<span id="cb7-185"><a href="#cb7-185" tabindex="-1"></a><span class="co">#&gt;   Degrees of freedom                                45</span></span>
<span id="cb7-186"><a href="#cb7-186" tabindex="-1"></a><span class="co">#&gt;   P-value                                        0.000</span></span>
<span id="cb7-187"><a href="#cb7-187" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb7-188"><a href="#cb7-188" tabindex="-1"></a><span class="co">#&gt; User Model versus Baseline Model:</span></span>
<span id="cb7-189"><a href="#cb7-189" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb7-190"><a href="#cb7-190" tabindex="-1"></a><span class="co">#&gt;   Comparative Fit Index (CFI)                    0.968</span></span>
<span id="cb7-191"><a href="#cb7-191" tabindex="-1"></a><span class="co">#&gt;   Tucker-Lewis Index (TLI)                       0.952</span></span>
<span id="cb7-192"><a href="#cb7-192" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb7-193"><a href="#cb7-193" tabindex="-1"></a><span class="co">#&gt; Loglikelihood and Information Criteria:</span></span>
<span id="cb7-194"><a href="#cb7-194" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb7-195"><a href="#cb7-195" tabindex="-1"></a><span class="co">#&gt;   Loglikelihood user model (H0)              -8216.332</span></span>
<span id="cb7-196"><a href="#cb7-196" tabindex="-1"></a><span class="co">#&gt;   Loglikelihood unrestricted model (H1)      -8189.403</span></span>
<span id="cb7-197"><a href="#cb7-197" tabindex="-1"></a><span class="co">#&gt;                                                       </span></span>
<span id="cb7-198"><a href="#cb7-198" tabindex="-1"></a><span class="co">#&gt;   Akaike (AIC)                               16482.664</span></span>
<span id="cb7-199"><a href="#cb7-199" tabindex="-1"></a><span class="co">#&gt;   Bayesian (BIC)                             16588.029</span></span>
<span id="cb7-200"><a href="#cb7-200" tabindex="-1"></a><span class="co">#&gt;   Sample-size adjusted Bayesian (SABIC)      16508.678</span></span>
<span id="cb7-201"><a href="#cb7-201" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb7-202"><a href="#cb7-202" tabindex="-1"></a><span class="co">#&gt; Root Mean Square Error of Approximation:</span></span>
<span id="cb7-203"><a href="#cb7-203" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb7-204"><a href="#cb7-204" tabindex="-1"></a><span class="co">#&gt;   RMSEA                                          0.040</span></span>
<span id="cb7-205"><a href="#cb7-205" tabindex="-1"></a><span class="co">#&gt;   90 Percent confidence interval - lower         0.022</span></span>
<span id="cb7-206"><a href="#cb7-206" tabindex="-1"></a><span class="co">#&gt;   90 Percent confidence interval - upper         0.057</span></span>
<span id="cb7-207"><a href="#cb7-207" tabindex="-1"></a><span class="co">#&gt;   P-value H_0: RMSEA &lt;= 0.050                    0.826</span></span>
<span id="cb7-208"><a href="#cb7-208" tabindex="-1"></a><span class="co">#&gt;   P-value H_0: RMSEA &gt;= 0.080                    0.000</span></span>
<span id="cb7-209"><a href="#cb7-209" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb7-210"><a href="#cb7-210" tabindex="-1"></a><span class="co">#&gt; Standardized Root Mean Square Residual:</span></span>
<span id="cb7-211"><a href="#cb7-211" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb7-212"><a href="#cb7-212" tabindex="-1"></a><span class="co">#&gt;   SRMR                                           0.034</span></span>
<span id="cb7-213"><a href="#cb7-213" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb7-214"><a href="#cb7-214" tabindex="-1"></a><span class="co">#&gt; Parameter Estimates:</span></span>
<span id="cb7-215"><a href="#cb7-215" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb7-216"><a href="#cb7-216" tabindex="-1"></a><span class="co">#&gt;   Standard errors                             Standard</span></span>
<span id="cb7-217"><a href="#cb7-217" tabindex="-1"></a><span class="co">#&gt;   Information                                 Expected</span></span>
<span id="cb7-218"><a href="#cb7-218" tabindex="-1"></a><span class="co">#&gt;   Information saturated (h1) model          Structured</span></span>
<span id="cb7-219"><a href="#cb7-219" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb7-220"><a href="#cb7-220" tabindex="-1"></a><span class="co">#&gt; Latent Variables:</span></span>
<span id="cb7-221"><a href="#cb7-221" tabindex="-1"></a><span class="co">#&gt;                    Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all</span></span>
<span id="cb7-222"><a href="#cb7-222" tabindex="-1"></a><span class="co">#&gt;   X =~                                                                  </span></span>
<span id="cb7-223"><a href="#cb7-223" tabindex="-1"></a><span class="co">#&gt;     x1                1.000                               0.943    0.637</span></span>
<span id="cb7-224"><a href="#cb7-224" tabindex="-1"></a><span class="co">#&gt;     x2                0.868    0.088    9.836    0.000    0.818    0.664</span></span>
<span id="cb7-225"><a href="#cb7-225" tabindex="-1"></a><span class="co">#&gt;     x3                0.774    0.080    9.664    0.000    0.730    0.632</span></span>
<span id="cb7-226"><a href="#cb7-226" tabindex="-1"></a><span class="co">#&gt;   M =~                                                                  </span></span>
<span id="cb7-227"><a href="#cb7-227" tabindex="-1"></a><span class="co">#&gt;     m1                1.000                               0.885    0.625</span></span>
<span id="cb7-228"><a href="#cb7-228" tabindex="-1"></a><span class="co">#&gt;     m2                0.979    0.102    9.620    0.000    0.866    0.642</span></span>
<span id="cb7-229"><a href="#cb7-229" tabindex="-1"></a><span class="co">#&gt;     m3                0.753    0.078    9.603    0.000    0.666    0.640</span></span>
<span id="cb7-230"><a href="#cb7-230" tabindex="-1"></a><span class="co">#&gt;   X_int_M =~                                                            </span></span>
<span id="cb7-231"><a href="#cb7-231" tabindex="-1"></a><span class="co">#&gt;     x1m1              1.000                               0.841    0.378</span></span>
<span id="cb7-232"><a href="#cb7-232" tabindex="-1"></a><span class="co">#&gt;     x2m2              0.902    0.212    4.248    0.000    0.759    0.415</span></span>
<span id="cb7-233"><a href="#cb7-233" tabindex="-1"></a><span class="co">#&gt;     x3m3              0.818    0.191    4.288    0.000    0.689    0.552</span></span>
<span id="cb7-234"><a href="#cb7-234" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb7-235"><a href="#cb7-235" tabindex="-1"></a><span class="co">#&gt; Regressions:</span></span>
<span id="cb7-236"><a href="#cb7-236" tabindex="-1"></a><span class="co">#&gt;                    Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all</span></span>
<span id="cb7-237"><a href="#cb7-237" tabindex="-1"></a><span class="co">#&gt;   Y ~                                                                   </span></span>
<span id="cb7-238"><a href="#cb7-238" tabindex="-1"></a><span class="co">#&gt;     X         (b1)    0.184    0.078    2.365    0.018    0.174    0.189</span></span>
<span id="cb7-239"><a href="#cb7-239" tabindex="-1"></a><span class="co">#&gt;     M         (b2)    0.396    0.092    4.331    0.000    0.351    0.381</span></span>
<span id="cb7-240"><a href="#cb7-240" tabindex="-1"></a><span class="co">#&gt;     X_int_M   (b3)    0.403    0.102    3.954    0.000    0.339    0.368</span></span>
<span id="cb7-241"><a href="#cb7-241" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb7-242"><a href="#cb7-242" tabindex="-1"></a><span class="co">#&gt; Covariances:</span></span>
<span id="cb7-243"><a href="#cb7-243" tabindex="-1"></a><span class="co">#&gt;                    Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all</span></span>
<span id="cb7-244"><a href="#cb7-244" tabindex="-1"></a><span class="co">#&gt;   X ~~                                                                  </span></span>
<span id="cb7-245"><a href="#cb7-245" tabindex="-1"></a><span class="co">#&gt;     M                 0.498    0.074    6.773    0.000    0.597    0.597</span></span>
<span id="cb7-246"><a href="#cb7-246" tabindex="-1"></a><span class="co">#&gt;     X_int_M           0.009    0.064    0.147    0.884    0.012    0.012</span></span>
<span id="cb7-247"><a href="#cb7-247" tabindex="-1"></a><span class="co">#&gt;   M ~~                                                                  </span></span>
<span id="cb7-248"><a href="#cb7-248" tabindex="-1"></a><span class="co">#&gt;     X_int_M          -0.149    0.066   -2.236    0.025   -0.200   -0.200</span></span>
<span id="cb7-249"><a href="#cb7-249" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb7-250"><a href="#cb7-250" tabindex="-1"></a><span class="co">#&gt; Variances:</span></span>
<span id="cb7-251"><a href="#cb7-251" tabindex="-1"></a><span class="co">#&gt;                    Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all</span></span>
<span id="cb7-252"><a href="#cb7-252" tabindex="-1"></a><span class="co">#&gt;     X         (v1)    0.889    0.137    6.514    0.000    1.000    1.000</span></span>
<span id="cb7-253"><a href="#cb7-253" tabindex="-1"></a><span class="co">#&gt;     M         (v2)    0.782    0.123    6.378    0.000    1.000    1.000</span></span>
<span id="cb7-254"><a href="#cb7-254" tabindex="-1"></a><span class="co">#&gt;    .x1                1.302    0.114   11.418    0.000    1.302    0.594</span></span>
<span id="cb7-255"><a href="#cb7-255" tabindex="-1"></a><span class="co">#&gt;    .x2                0.848    0.079   10.725    0.000    0.848    0.559</span></span>
<span id="cb7-256"><a href="#cb7-256" tabindex="-1"></a><span class="co">#&gt;    .x3                0.801    0.069   11.534    0.000    0.801    0.600</span></span>
<span id="cb7-257"><a href="#cb7-257" tabindex="-1"></a><span class="co">#&gt;    .m1                1.223    0.105   11.702    0.000    1.223    0.610</span></span>
<span id="cb7-258"><a href="#cb7-258" tabindex="-1"></a><span class="co">#&gt;    .m2                1.068    0.095   11.287    0.000    1.068    0.587</span></span>
<span id="cb7-259"><a href="#cb7-259" tabindex="-1"></a><span class="co">#&gt;    .m3                0.641    0.056   11.354    0.000    0.641    0.591</span></span>
<span id="cb7-260"><a href="#cb7-260" tabindex="-1"></a><span class="co">#&gt;    .x1m1              4.258    0.326   13.061    0.000    4.258    0.857</span></span>
<span id="cb7-261"><a href="#cb7-261" tabindex="-1"></a><span class="co">#&gt;    .x2m2              2.768    0.225   12.307    0.000    2.768    0.828</span></span>
<span id="cb7-262"><a href="#cb7-262" tabindex="-1"></a><span class="co">#&gt;    .x3m3              1.080    0.126    8.556    0.000    1.080    0.695</span></span>
<span id="cb7-263"><a href="#cb7-263" tabindex="-1"></a><span class="co">#&gt;    .Y                 0.554    0.050   11.173    0.000    0.554    0.652</span></span>
<span id="cb7-264"><a href="#cb7-264" tabindex="-1"></a><span class="co">#&gt;     X_int_M           0.708    0.245    2.892    0.004    1.000    1.000</span></span>
<span id="cb7-265"><a href="#cb7-265" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb7-266"><a href="#cb7-266" tabindex="-1"></a><span class="co">#&gt; Defined Parameters:</span></span>
<span id="cb7-267"><a href="#cb7-267" tabindex="-1"></a><span class="co">#&gt;                    Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all</span></span>
<span id="cb7-268"><a href="#cb7-268" tabindex="-1"></a><span class="co">#&gt;     beta1             0.174    0.072    2.400    0.016    0.174    0.189</span></span>
<span id="cb7-269"><a href="#cb7-269" tabindex="-1"></a><span class="co">#&gt;     beta2             0.351    0.076    4.585    0.000    0.351    0.381</span></span>
<span id="cb7-270"><a href="#cb7-270" tabindex="-1"></a><span class="co">#&gt;     beta3             0.337    0.093    3.618    0.000    0.339    0.368</span></span>
<span id="cb7-271"><a href="#cb7-271" tabindex="-1"></a></span>
<span id="cb7-272"><a href="#cb7-272" tabindex="-1"></a><span class="co"># Using modsem</span></span>
<span id="cb7-273"><a href="#cb7-273" tabindex="-1"></a>mod_upi <span class="ot">&lt;-</span> <span class="st">&#39;# Measurement Model</span></span>
<span id="cb7-274"><a href="#cb7-274" tabindex="-1"></a><span class="st">              X =~ x1 + x2 + x3</span></span>
<span id="cb7-275"><a href="#cb7-275" tabindex="-1"></a><span class="st">              M =~ m1 + m2 + m3</span></span>
<span id="cb7-276"><a href="#cb7-276" tabindex="-1"></a><span class="st">            # Structural Model</span></span>
<span id="cb7-277"><a href="#cb7-277" tabindex="-1"></a><span class="st">              Y ~ b1 * X + b2 * M + b3 * X:M&#39;</span></span>
<span id="cb7-278"><a href="#cb7-278" tabindex="-1"></a>mod_upi <span class="ot">&lt;-</span> <span class="fu">modsem_pi</span>(mod_upi, <span class="at">data =</span> df, <span class="at">method =</span> <span class="st">&quot;uca&quot;</span>, <span class="at">match =</span> T)</span>
<span id="cb7-279"><a href="#cb7-279" tabindex="-1"></a><span class="fu">summary</span>(mod_upi)</span>
<span id="cb7-280"><a href="#cb7-280" tabindex="-1"></a><span class="co">#&gt; modsem: </span></span>
<span id="cb7-281"><a href="#cb7-281" tabindex="-1"></a><span class="co">#&gt; Method = uca</span></span>
<span id="cb7-282"><a href="#cb7-282" tabindex="-1"></a><span class="co">#&gt; lavaan 0.6-18 ended normally after 53 iterations</span></span>
<span id="cb7-283"><a href="#cb7-283" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb7-284"><a href="#cb7-284" tabindex="-1"></a><span class="co">#&gt;   Estimator                                         ML</span></span>
<span id="cb7-285"><a href="#cb7-285" tabindex="-1"></a><span class="co">#&gt;   Optimization method                           NLMINB</span></span>
<span id="cb7-286"><a href="#cb7-286" tabindex="-1"></a><span class="co">#&gt;   Number of model parameters                        36</span></span>
<span id="cb7-287"><a href="#cb7-287" tabindex="-1"></a><span class="co">#&gt;   Number of equality constraints                     1</span></span>
<span id="cb7-288"><a href="#cb7-288" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb7-289"><a href="#cb7-289" tabindex="-1"></a><span class="co">#&gt;   Number of observations                           500</span></span>
<span id="cb7-290"><a href="#cb7-290" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb7-291"><a href="#cb7-291" tabindex="-1"></a><span class="co">#&gt; Model Test User Model:</span></span>
<span id="cb7-292"><a href="#cb7-292" tabindex="-1"></a><span class="co">#&gt;                                                       </span></span>
<span id="cb7-293"><a href="#cb7-293" tabindex="-1"></a><span class="co">#&gt;   Test statistic                                53.858</span></span>
<span id="cb7-294"><a href="#cb7-294" tabindex="-1"></a><span class="co">#&gt;   Degrees of freedom                                30</span></span>
<span id="cb7-295"><a href="#cb7-295" tabindex="-1"></a><span class="co">#&gt;   P-value (Chi-square)                           0.005</span></span>
<span id="cb7-296"><a href="#cb7-296" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb7-297"><a href="#cb7-297" tabindex="-1"></a><span class="co">#&gt; Parameter Estimates:</span></span>
<span id="cb7-298"><a href="#cb7-298" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb7-299"><a href="#cb7-299" tabindex="-1"></a><span class="co">#&gt;   Standard errors                             Standard</span></span>
<span id="cb7-300"><a href="#cb7-300" tabindex="-1"></a><span class="co">#&gt;   Information                                 Expected</span></span>
<span id="cb7-301"><a href="#cb7-301" tabindex="-1"></a><span class="co">#&gt;   Information saturated (h1) model          Structured</span></span>
<span id="cb7-302"><a href="#cb7-302" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb7-303"><a href="#cb7-303" tabindex="-1"></a><span class="co">#&gt; Latent Variables:</span></span>
<span id="cb7-304"><a href="#cb7-304" tabindex="-1"></a><span class="co">#&gt;                    Estimate  Std.Err  z-value  P(&gt;|z|)</span></span>
<span id="cb7-305"><a href="#cb7-305" tabindex="-1"></a><span class="co">#&gt;   X =~                                                </span></span>
<span id="cb7-306"><a href="#cb7-306" tabindex="-1"></a><span class="co">#&gt;     x1     (l_1_X)    1.000                           </span></span>
<span id="cb7-307"><a href="#cb7-307" tabindex="-1"></a><span class="co">#&gt;     x2     (l_2_X)    0.868    0.088    9.836    0.000</span></span>
<span id="cb7-308"><a href="#cb7-308" tabindex="-1"></a><span class="co">#&gt;     x3     (l_3_X)    0.774    0.080    9.664    0.000</span></span>
<span id="cb7-309"><a href="#cb7-309" tabindex="-1"></a><span class="co">#&gt;   M =~                                                </span></span>
<span id="cb7-310"><a href="#cb7-310" tabindex="-1"></a><span class="co">#&gt;     m1     (l_1_M)    1.000                           </span></span>
<span id="cb7-311"><a href="#cb7-311" tabindex="-1"></a><span class="co">#&gt;     m2     (l_2_M)    0.979    0.102    9.620    0.000</span></span>
<span id="cb7-312"><a href="#cb7-312" tabindex="-1"></a><span class="co">#&gt;     m3     (l_3_M)    0.753    0.078    9.603    0.000</span></span>
<span id="cb7-313"><a href="#cb7-313" tabindex="-1"></a><span class="co">#&gt;   XM =~                                               </span></span>
<span id="cb7-314"><a href="#cb7-314" tabindex="-1"></a><span class="co">#&gt;     x1m1    (l_11)    1.000                           </span></span>
<span id="cb7-315"><a href="#cb7-315" tabindex="-1"></a><span class="co">#&gt;     x2m2    (l_22)    0.902    0.212    4.248    0.000</span></span>
<span id="cb7-316"><a href="#cb7-316" tabindex="-1"></a><span class="co">#&gt;     x3m3    (l_33)    0.818    0.191    4.288    0.000</span></span>
<span id="cb7-317"><a href="#cb7-317" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb7-318"><a href="#cb7-318" tabindex="-1"></a><span class="co">#&gt; Regressions:</span></span>
<span id="cb7-319"><a href="#cb7-319" tabindex="-1"></a><span class="co">#&gt;                    Estimate  Std.Err  z-value  P(&gt;|z|)</span></span>
<span id="cb7-320"><a href="#cb7-320" tabindex="-1"></a><span class="co">#&gt;   Y ~                                                 </span></span>
<span id="cb7-321"><a href="#cb7-321" tabindex="-1"></a><span class="co">#&gt;     X       (G_X_)    0.184    0.078    2.365    0.018</span></span>
<span id="cb7-322"><a href="#cb7-322" tabindex="-1"></a><span class="co">#&gt;     M       (G_M_)    0.396    0.092    4.331    0.000</span></span>
<span id="cb7-323"><a href="#cb7-323" tabindex="-1"></a><span class="co">#&gt;     XM      (G_XM)    0.403    0.102    3.954    0.000</span></span>
<span id="cb7-324"><a href="#cb7-324" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb7-325"><a href="#cb7-325" tabindex="-1"></a><span class="co">#&gt; Covariances:</span></span>
<span id="cb7-326"><a href="#cb7-326" tabindex="-1"></a><span class="co">#&gt;                    Estimate  Std.Err  z-value  P(&gt;|z|)</span></span>
<span id="cb7-327"><a href="#cb7-327" tabindex="-1"></a><span class="co">#&gt;   X ~~                                                </span></span>
<span id="cb7-328"><a href="#cb7-328" tabindex="-1"></a><span class="co">#&gt;     M      (C_X_M)    0.498    0.074    6.773    0.000</span></span>
<span id="cb7-329"><a href="#cb7-329" tabindex="-1"></a><span class="co">#&gt;     XM     (C_X_X)    0.009    0.064    0.147    0.884</span></span>
<span id="cb7-330"><a href="#cb7-330" tabindex="-1"></a><span class="co">#&gt;   M ~~                                                </span></span>
<span id="cb7-331"><a href="#cb7-331" tabindex="-1"></a><span class="co">#&gt;     XM      (C_M_)   -0.149    0.066   -2.236    0.025</span></span>
<span id="cb7-332"><a href="#cb7-332" tabindex="-1"></a><span class="co">#&gt;  .x1m1 ~~                                             </span></span>
<span id="cb7-333"><a href="#cb7-333" tabindex="-1"></a><span class="co">#&gt;    .x2m2              0.000                           </span></span>
<span id="cb7-334"><a href="#cb7-334" tabindex="-1"></a><span class="co">#&gt;    .x3m3              0.000                           </span></span>
<span id="cb7-335"><a href="#cb7-335" tabindex="-1"></a><span class="co">#&gt;  .x2m2 ~~                                             </span></span>
<span id="cb7-336"><a href="#cb7-336" tabindex="-1"></a><span class="co">#&gt;    .x3m3              0.000                           </span></span>
<span id="cb7-337"><a href="#cb7-337" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb7-338"><a href="#cb7-338" tabindex="-1"></a><span class="co">#&gt; Intercepts:</span></span>
<span id="cb7-339"><a href="#cb7-339" tabindex="-1"></a><span class="co">#&gt;                    Estimate  Std.Err  z-value  P(&gt;|z|)</span></span>
<span id="cb7-340"><a href="#cb7-340" tabindex="-1"></a><span class="co">#&gt;     XM      (M_XM)    0.498    0.074    6.773    0.000</span></span>
<span id="cb7-341"><a href="#cb7-341" tabindex="-1"></a><span class="co">#&gt;    .x1               -0.124    0.066   -1.870    0.062</span></span>
<span id="cb7-342"><a href="#cb7-342" tabindex="-1"></a><span class="co">#&gt;    .x2               -0.164    0.055   -2.975    0.003</span></span>
<span id="cb7-343"><a href="#cb7-343" tabindex="-1"></a><span class="co">#&gt;    .x3               -0.063    0.052   -1.216    0.224</span></span>
<span id="cb7-344"><a href="#cb7-344" tabindex="-1"></a><span class="co">#&gt;    .m1               -0.122    0.063   -1.924    0.054</span></span>
<span id="cb7-345"><a href="#cb7-345" tabindex="-1"></a><span class="co">#&gt;    .m2               -0.046    0.060   -0.759    0.448</span></span>
<span id="cb7-346"><a href="#cb7-346" tabindex="-1"></a><span class="co">#&gt;    .m3               -0.029    0.047   -0.629    0.529</span></span>
<span id="cb7-347"><a href="#cb7-347" tabindex="-1"></a><span class="co">#&gt;    .x1m1             -0.005    0.124   -0.043    0.966</span></span>
<span id="cb7-348"><a href="#cb7-348" tabindex="-1"></a><span class="co">#&gt;    .x2m2             -0.024    0.149   -0.160    0.873</span></span>
<span id="cb7-349"><a href="#cb7-349" tabindex="-1"></a><span class="co">#&gt;    .x3m3             -0.118    0.126   -0.939    0.348</span></span>
<span id="cb7-350"><a href="#cb7-350" tabindex="-1"></a><span class="co">#&gt;    .Y                -0.123    0.072   -1.718    0.086</span></span>
<span id="cb7-351"><a href="#cb7-351" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb7-352"><a href="#cb7-352" tabindex="-1"></a><span class="co">#&gt; Variances:</span></span>
<span id="cb7-353"><a href="#cb7-353" tabindex="-1"></a><span class="co">#&gt;                    Estimate  Std.Err  z-value  P(&gt;|z|)</span></span>
<span id="cb7-354"><a href="#cb7-354" tabindex="-1"></a><span class="co">#&gt;     X       (Vr_X)    0.889    0.137    6.514    0.000</span></span>
<span id="cb7-355"><a href="#cb7-355" tabindex="-1"></a><span class="co">#&gt;     M       (Vr_M)    0.782    0.123    6.378    0.000</span></span>
<span id="cb7-356"><a href="#cb7-356" tabindex="-1"></a><span class="co">#&gt;     XM      (V_XM)    0.708    0.245    2.892    0.004</span></span>
<span id="cb7-357"><a href="#cb7-357" tabindex="-1"></a><span class="co">#&gt;    .x1     (Vr_x1)    1.302    0.114   11.418    0.000</span></span>
<span id="cb7-358"><a href="#cb7-358" tabindex="-1"></a><span class="co">#&gt;    .x2     (Vr_x2)    0.848    0.079   10.725    0.000</span></span>
<span id="cb7-359"><a href="#cb7-359" tabindex="-1"></a><span class="co">#&gt;    .x3     (Vr_x3)    0.801    0.069   11.534    0.000</span></span>
<span id="cb7-360"><a href="#cb7-360" tabindex="-1"></a><span class="co">#&gt;    .m1     (Vr_m1)    1.223    0.105   11.702    0.000</span></span>
<span id="cb7-361"><a href="#cb7-361" tabindex="-1"></a><span class="co">#&gt;    .m2     (Vr_m2)    1.068    0.095   11.287    0.000</span></span>
<span id="cb7-362"><a href="#cb7-362" tabindex="-1"></a><span class="co">#&gt;    .m3     (Vr_m3)    0.641    0.056   11.354    0.000</span></span>
<span id="cb7-363"><a href="#cb7-363" tabindex="-1"></a><span class="co">#&gt;    .x1m1    (V_11)    4.258    0.326   13.061    0.000</span></span>
<span id="cb7-364"><a href="#cb7-364" tabindex="-1"></a><span class="co">#&gt;    .x2m2    (V_22)    2.768    0.225   12.307    0.000</span></span>
<span id="cb7-365"><a href="#cb7-365" tabindex="-1"></a><span class="co">#&gt;    .x3m3    (V_33)    1.080    0.126    8.556    0.000</span></span>
<span id="cb7-366"><a href="#cb7-366" tabindex="-1"></a><span class="co">#&gt;    .Y                 0.554    0.050   11.173    0.000</span></span>
<span id="cb7-367"><a href="#cb7-367" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb7-368"><a href="#cb7-368" tabindex="-1"></a><span class="co">#&gt; Constraints:</span></span>
<span id="cb7-369"><a href="#cb7-369" tabindex="-1"></a><span class="co">#&gt;                                                |Slack|</span></span>
<span id="cb7-370"><a href="#cb7-370" tabindex="-1"></a><span class="co">#&gt;     Mean_XM - ((Cov_X_M))                        0.000</span></span></code></pre></div>
<div id="lrt-based-p-value-1" class="section level3">
<h3>LRT Based P-value</h3>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a>all_lrtp <span class="ot">&lt;-</span> <span class="fu">lrtp</span>(fit_upi)</span>
<span id="cb8-2"><a href="#cb8-2" tabindex="-1"></a>all_lrtp</span>
<span id="cb8-3"><a href="#cb8-3" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb8-4"><a href="#cb8-4" tabindex="-1"></a><span class="co">#&gt; Parameter Estimates:</span></span>
<span id="cb8-5"><a href="#cb8-5" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb8-6"><a href="#cb8-6" tabindex="-1"></a><span class="co">#&gt;   Standard errors                             Standard</span></span>
<span id="cb8-7"><a href="#cb8-7" tabindex="-1"></a><span class="co">#&gt;   Information                                 Expected</span></span>
<span id="cb8-8"><a href="#cb8-8" tabindex="-1"></a><span class="co">#&gt;   Information saturated (h1) model          Structured</span></span>
<span id="cb8-9"><a href="#cb8-9" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb8-10"><a href="#cb8-10" tabindex="-1"></a><span class="co">#&gt; Regressions:</span></span>
<span id="cb8-11"><a href="#cb8-11" tabindex="-1"></a><span class="co">#&gt;                    Estimate  Std.Err    Chisq     LRTp</span></span>
<span id="cb8-12"><a href="#cb8-12" tabindex="-1"></a><span class="co">#&gt;   Y ~                                                 </span></span>
<span id="cb8-13"><a href="#cb8-13" tabindex="-1"></a><span class="co">#&gt;     X         (b1)    0.188    0.075    5.727    0.017</span></span>
<span id="cb8-14"><a href="#cb8-14" tabindex="-1"></a><span class="co">#&gt;     M         (b2)    0.375    0.085   21.132    0.000</span></span>
<span id="cb8-15"><a href="#cb8-15" tabindex="-1"></a><span class="co">#&gt;     X_int_M   (b3)    0.324    0.068   33.459    0.000</span></span>
<span id="cb8-16"><a href="#cb8-16" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb8-17"><a href="#cb8-17" tabindex="-1"></a><span class="co">#&gt; Covariances:</span></span>
<span id="cb8-18"><a href="#cb8-18" tabindex="-1"></a><span class="co">#&gt;                    Estimate  Std.Err    Chisq     LRTp</span></span>
<span id="cb8-19"><a href="#cb8-19" tabindex="-1"></a><span class="co">#&gt;   X ~~                                                </span></span>
<span id="cb8-20"><a href="#cb8-20" tabindex="-1"></a><span class="co">#&gt;     M                 0.498    0.074   88.392    0.000</span></span>
<span id="cb8-21"><a href="#cb8-21" tabindex="-1"></a><span class="co">#&gt;     X_int_M           0.037    0.067    0.288    0.592</span></span>
<span id="cb8-22"><a href="#cb8-22" tabindex="-1"></a><span class="co">#&gt;   M ~~                                                </span></span>
<span id="cb8-23"><a href="#cb8-23" tabindex="-1"></a><span class="co">#&gt;     X_int_M          -0.136    0.066    4.554    0.033</span></span>
<span id="cb8-24"><a href="#cb8-24" tabindex="-1"></a></span>
<span id="cb8-25"><a href="#cb8-25" tabindex="-1"></a>matched_lrtp <span class="ot">&lt;-</span> <span class="fu">lrtp</span>(fit_upi_matched)</span>
<span id="cb8-26"><a href="#cb8-26" tabindex="-1"></a>matched_lrtp</span>
<span id="cb8-27"><a href="#cb8-27" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb8-28"><a href="#cb8-28" tabindex="-1"></a><span class="co">#&gt; Parameter Estimates:</span></span>
<span id="cb8-29"><a href="#cb8-29" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb8-30"><a href="#cb8-30" tabindex="-1"></a><span class="co">#&gt;   Standard errors                             Standard</span></span>
<span id="cb8-31"><a href="#cb8-31" tabindex="-1"></a><span class="co">#&gt;   Information                                 Expected</span></span>
<span id="cb8-32"><a href="#cb8-32" tabindex="-1"></a><span class="co">#&gt;   Information saturated (h1) model          Structured</span></span>
<span id="cb8-33"><a href="#cb8-33" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb8-34"><a href="#cb8-34" tabindex="-1"></a><span class="co">#&gt; Regressions:</span></span>
<span id="cb8-35"><a href="#cb8-35" tabindex="-1"></a><span class="co">#&gt;                    Estimate  Std.Err    Chisq     LRTp</span></span>
<span id="cb8-36"><a href="#cb8-36" tabindex="-1"></a><span class="co">#&gt;   Y ~                                                 </span></span>
<span id="cb8-37"><a href="#cb8-37" tabindex="-1"></a><span class="co">#&gt;     X         (b1)    0.184    0.078    4.789    0.029</span></span>
<span id="cb8-38"><a href="#cb8-38" tabindex="-1"></a><span class="co">#&gt;     M         (b2)    0.396    0.092   21.938    0.000</span></span>
<span id="cb8-39"><a href="#cb8-39" tabindex="-1"></a><span class="co">#&gt;     X_int_M   (b3)    0.403    0.102   30.128    0.000</span></span>
<span id="cb8-40"><a href="#cb8-40" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb8-41"><a href="#cb8-41" tabindex="-1"></a><span class="co">#&gt; Covariances:</span></span>
<span id="cb8-42"><a href="#cb8-42" tabindex="-1"></a><span class="co">#&gt;                    Estimate  Std.Err    Chisq     LRTp</span></span>
<span id="cb8-43"><a href="#cb8-43" tabindex="-1"></a><span class="co">#&gt;   X ~~                                                </span></span>
<span id="cb8-44"><a href="#cb8-44" tabindex="-1"></a><span class="co">#&gt;     M                 0.498    0.074   88.516    0.000</span></span>
<span id="cb8-45"><a href="#cb8-45" tabindex="-1"></a><span class="co">#&gt;     X_int_M           0.009    0.064    0.021    0.884</span></span>
<span id="cb8-46"><a href="#cb8-46" tabindex="-1"></a><span class="co">#&gt;   M ~~                                                </span></span>
<span id="cb8-47"><a href="#cb8-47" tabindex="-1"></a><span class="co">#&gt;     X_int_M          -0.149    0.066    5.845    0.016</span></span></code></pre></div>
</div>
</div>
<div id="rapi" class="section level2">
<h2>RAPI</h2>
<p>The steps of applying RAPI method is based on technical details in
Hsiao et al.(2018).</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a><span class="co"># Step 1: Prepare mean-centered df</span></span>
<span id="cb9-2"><a href="#cb9-2" tabindex="-1"></a>df_centered <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span></span>
<span id="cb9-3"><a href="#cb9-3" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">c</span>(x1<span class="sc">:</span>m3), <span class="sc">~</span> . <span class="sc">-</span> <span class="fu">mean</span>(.)))</span>
<span id="cb9-4"><a href="#cb9-4" tabindex="-1"></a></span>
<span id="cb9-5"><a href="#cb9-5" tabindex="-1"></a><span class="co"># Step 2: Using sum scores as the single indicators</span></span>
<span id="cb9-6"><a href="#cb9-6" tabindex="-1"></a>df_centered<span class="sc">$</span>x_mean <span class="ot">&lt;-</span> <span class="fu">rowSums</span>(df_centered[, <span class="fu">c</span>(<span class="st">&quot;x1&quot;</span>, <span class="st">&quot;x2&quot;</span>, <span class="st">&quot;x3&quot;</span>)])<span class="sc">/</span><span class="dv">3</span></span>
<span id="cb9-7"><a href="#cb9-7" tabindex="-1"></a>df_centered<span class="sc">$</span>m_mean <span class="ot">&lt;-</span> <span class="fu">rowSums</span>(df_centered[, <span class="fu">c</span>(<span class="st">&quot;m1&quot;</span>, <span class="st">&quot;m2&quot;</span>, <span class="st">&quot;m3&quot;</span>)])<span class="sc">/</span><span class="dv">3</span></span>
<span id="cb9-8"><a href="#cb9-8" tabindex="-1"></a></span>
<span id="cb9-9"><a href="#cb9-9" tabindex="-1"></a><span class="co"># Step 3: Create the interaction indicator</span></span>
<span id="cb9-10"><a href="#cb9-10" tabindex="-1"></a>df_centered<span class="sc">$</span>xm <span class="ot">&lt;-</span> df_centered<span class="sc">$</span>x_mean<span class="sc">*</span>df_centered<span class="sc">$</span>m_mean</span>
<span id="cb9-11"><a href="#cb9-11" tabindex="-1"></a></span>
<span id="cb9-12"><a href="#cb9-12" tabindex="-1"></a><span class="co"># Step 4: Calculate reliability of indicators</span></span>
<span id="cb9-13"><a href="#cb9-13" tabindex="-1"></a>X_rel <span class="ot">&lt;-</span> psych<span class="sc">::</span><span class="fu">alpha</span>(df_centered[, <span class="fu">c</span>(<span class="st">&quot;x1&quot;</span>, <span class="st">&quot;x2&quot;</span>, <span class="st">&quot;x3&quot;</span>)])<span class="sc">$</span>total<span class="sc">$</span>raw_alpha</span>
<span id="cb9-14"><a href="#cb9-14" tabindex="-1"></a><span class="co">#&gt; Number of categories should be increased  in order to count frequencies.</span></span>
<span id="cb9-15"><a href="#cb9-15" tabindex="-1"></a>M_rel <span class="ot">&lt;-</span> psych<span class="sc">::</span><span class="fu">alpha</span>(df_centered[, <span class="fu">c</span>(<span class="st">&quot;m1&quot;</span>, <span class="st">&quot;m2&quot;</span>, <span class="st">&quot;m3&quot;</span>)])<span class="sc">$</span>total<span class="sc">$</span>raw_alpha</span>
<span id="cb9-16"><a href="#cb9-16" tabindex="-1"></a><span class="co">#&gt; Number of categories should be increased  in order to count frequencies.</span></span>
<span id="cb9-17"><a href="#cb9-17" tabindex="-1"></a></span>
<span id="cb9-18"><a href="#cb9-18" tabindex="-1"></a><span class="co"># Step 5: Draft the model syntax</span></span>
<span id="cb9-19"><a href="#cb9-19" tabindex="-1"></a>mod_rapi <span class="ot">&lt;-</span> <span class="st">&#39;X =~ 1 * x_mean</span></span>
<span id="cb9-20"><a href="#cb9-20" tabindex="-1"></a><span class="st">             M =~ 1 * m_mean</span></span>
<span id="cb9-21"><a href="#cb9-21" tabindex="-1"></a><span class="st">             XM =~ 1 * xm</span></span>
<span id="cb9-22"><a href="#cb9-22" tabindex="-1"></a><span class="st">             </span></span>
<span id="cb9-23"><a href="#cb9-23" tabindex="-1"></a><span class="st">             # Error variance</span></span>
<span id="cb9-24"><a href="#cb9-24" tabindex="-1"></a><span class="st">             x_mean ~~ ev_x * x_mean</span></span>
<span id="cb9-25"><a href="#cb9-25" tabindex="-1"></a><span class="st">             m_mean ~~ ev_m * m_mean</span></span>
<span id="cb9-26"><a href="#cb9-26" tabindex="-1"></a><span class="st">             xm ~~ ev_xm * xm</span></span>
<span id="cb9-27"><a href="#cb9-27" tabindex="-1"></a><span class="st">             </span></span>
<span id="cb9-28"><a href="#cb9-28" tabindex="-1"></a><span class="st">             # Regression</span></span>
<span id="cb9-29"><a href="#cb9-29" tabindex="-1"></a><span class="st">             Y ~ b1 * X + b2 * M + b3 * XM</span></span>
<span id="cb9-30"><a href="#cb9-30" tabindex="-1"></a><span class="st">             </span></span>
<span id="cb9-31"><a href="#cb9-31" tabindex="-1"></a><span class="st">             # Latent variance</span></span>
<span id="cb9-32"><a href="#cb9-32" tabindex="-1"></a><span class="st">             X ~~ v_x * X</span></span>
<span id="cb9-33"><a href="#cb9-33" tabindex="-1"></a><span class="st">             M ~~ v_m * M</span></span>
<span id="cb9-34"><a href="#cb9-34" tabindex="-1"></a><span class="st">             XM ~~ v_xm * XM</span></span>
<span id="cb9-35"><a href="#cb9-35" tabindex="-1"></a><span class="st">             </span></span>
<span id="cb9-36"><a href="#cb9-36" tabindex="-1"></a><span class="st">             # Error Constraints</span></span>
<span id="cb9-37"><a href="#cb9-37" tabindex="-1"></a><span class="st">             ev_x == (1 - X_rel) * v_x / X_rel</span></span>
<span id="cb9-38"><a href="#cb9-38" tabindex="-1"></a><span class="st">             ev_m == (1 - M_rel) * v_m / M_rel</span></span>
<span id="cb9-39"><a href="#cb9-39" tabindex="-1"></a><span class="st">             ev_xm == ev_x * v_m + ev_m * v_x + ev_x * ev_m</span></span>
<span id="cb9-40"><a href="#cb9-40" tabindex="-1"></a><span class="st">             </span></span>
<span id="cb9-41"><a href="#cb9-41" tabindex="-1"></a><span class="st">             # x-standardized interaction</span></span>
<span id="cb9-42"><a href="#cb9-42" tabindex="-1"></a><span class="st">             beta1 := b1 * sqrt(v_x)</span></span>
<span id="cb9-43"><a href="#cb9-43" tabindex="-1"></a><span class="st">             beta2 := b2 * sqrt(v_m)</span></span>
<span id="cb9-44"><a href="#cb9-44" tabindex="-1"></a><span class="st">             beta3 := b3 * sqrt(v_x) * sqrt(v_m)&#39;</span></span>
<span id="cb9-45"><a href="#cb9-45" tabindex="-1"></a></span>
<span id="cb9-46"><a href="#cb9-46" tabindex="-1"></a><span class="co"># Substitute in the actual reliability estimates</span></span>
<span id="cb9-47"><a href="#cb9-47" tabindex="-1"></a>mod_rapi <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">&quot;X_rel&quot;</span>, <span class="at">replacement =</span> X_rel, <span class="at">x =</span> mod_rapi)</span>
<span id="cb9-48"><a href="#cb9-48" tabindex="-1"></a>mod_rapi <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">&quot;M_rel&quot;</span>, <span class="at">replacement =</span> M_rel, <span class="at">x =</span> mod_rapi)</span>
<span id="cb9-49"><a href="#cb9-49" tabindex="-1"></a></span>
<span id="cb9-50"><a href="#cb9-50" tabindex="-1"></a><span class="co"># Step 6: Fit the RAPI model</span></span>
<span id="cb9-51"><a href="#cb9-51" tabindex="-1"></a>rapi_fit <span class="ot">&lt;-</span> <span class="fu">sem</span>(mod_rapi, <span class="at">data =</span> df_centered)</span>
<span id="cb9-52"><a href="#cb9-52" tabindex="-1"></a><span class="fu">summary</span>(rapi_fit)</span>
<span id="cb9-53"><a href="#cb9-53" tabindex="-1"></a><span class="co">#&gt; lavaan 0.6-18 ended normally after 74 iterations</span></span>
<span id="cb9-54"><a href="#cb9-54" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb9-55"><a href="#cb9-55" tabindex="-1"></a><span class="co">#&gt;   Estimator                                         ML</span></span>
<span id="cb9-56"><a href="#cb9-56" tabindex="-1"></a><span class="co">#&gt;   Optimization method                           NLMINB</span></span>
<span id="cb9-57"><a href="#cb9-57" tabindex="-1"></a><span class="co">#&gt;   Number of model parameters                        13</span></span>
<span id="cb9-58"><a href="#cb9-58" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb9-59"><a href="#cb9-59" tabindex="-1"></a><span class="co">#&gt;   Number of observations                           500</span></span>
<span id="cb9-60"><a href="#cb9-60" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb9-61"><a href="#cb9-61" tabindex="-1"></a><span class="co">#&gt; Model Test User Model:</span></span>
<span id="cb9-62"><a href="#cb9-62" tabindex="-1"></a><span class="co">#&gt;                                                       </span></span>
<span id="cb9-63"><a href="#cb9-63" tabindex="-1"></a><span class="co">#&gt;   Test statistic                                 0.000</span></span>
<span id="cb9-64"><a href="#cb9-64" tabindex="-1"></a><span class="co">#&gt;   Degrees of freedom                                 0</span></span>
<span id="cb9-65"><a href="#cb9-65" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb9-66"><a href="#cb9-66" tabindex="-1"></a><span class="co">#&gt; Parameter Estimates:</span></span>
<span id="cb9-67"><a href="#cb9-67" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb9-68"><a href="#cb9-68" tabindex="-1"></a><span class="co">#&gt;   Standard errors                             Standard</span></span>
<span id="cb9-69"><a href="#cb9-69" tabindex="-1"></a><span class="co">#&gt;   Information                                 Expected</span></span>
<span id="cb9-70"><a href="#cb9-70" tabindex="-1"></a><span class="co">#&gt;   Information saturated (h1) model          Structured</span></span>
<span id="cb9-71"><a href="#cb9-71" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb9-72"><a href="#cb9-72" tabindex="-1"></a><span class="co">#&gt; Latent Variables:</span></span>
<span id="cb9-73"><a href="#cb9-73" tabindex="-1"></a><span class="co">#&gt;                    Estimate  Std.Err  z-value  P(&gt;|z|)</span></span>
<span id="cb9-74"><a href="#cb9-74" tabindex="-1"></a><span class="co">#&gt;   X =~                                                </span></span>
<span id="cb9-75"><a href="#cb9-75" tabindex="-1"></a><span class="co">#&gt;     x_mean            1.000                           </span></span>
<span id="cb9-76"><a href="#cb9-76" tabindex="-1"></a><span class="co">#&gt;   M =~                                                </span></span>
<span id="cb9-77"><a href="#cb9-77" tabindex="-1"></a><span class="co">#&gt;     m_mean            1.000                           </span></span>
<span id="cb9-78"><a href="#cb9-78" tabindex="-1"></a><span class="co">#&gt;   XM =~                                               </span></span>
<span id="cb9-79"><a href="#cb9-79" tabindex="-1"></a><span class="co">#&gt;     xm                1.000                           </span></span>
<span id="cb9-80"><a href="#cb9-80" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb9-81"><a href="#cb9-81" tabindex="-1"></a><span class="co">#&gt; Regressions:</span></span>
<span id="cb9-82"><a href="#cb9-82" tabindex="-1"></a><span class="co">#&gt;                    Estimate  Std.Err  z-value  P(&gt;|z|)</span></span>
<span id="cb9-83"><a href="#cb9-83" tabindex="-1"></a><span class="co">#&gt;   Y ~                                                 </span></span>
<span id="cb9-84"><a href="#cb9-84" tabindex="-1"></a><span class="co">#&gt;     X         (b1)    0.211    0.086    2.457    0.014</span></span>
<span id="cb9-85"><a href="#cb9-85" tabindex="-1"></a><span class="co">#&gt;     M         (b2)    0.414    0.091    4.557    0.000</span></span>
<span id="cb9-86"><a href="#cb9-86" tabindex="-1"></a><span class="co">#&gt;     XM        (b3)    0.415    0.085    4.874    0.000</span></span>
<span id="cb9-87"><a href="#cb9-87" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb9-88"><a href="#cb9-88" tabindex="-1"></a><span class="co">#&gt; Covariances:</span></span>
<span id="cb9-89"><a href="#cb9-89" tabindex="-1"></a><span class="co">#&gt;                    Estimate  Std.Err  z-value  P(&gt;|z|)</span></span>
<span id="cb9-90"><a href="#cb9-90" tabindex="-1"></a><span class="co">#&gt;   X ~~                                                </span></span>
<span id="cb9-91"><a href="#cb9-91" tabindex="-1"></a><span class="co">#&gt;     M                 0.401    0.048    8.351    0.000</span></span>
<span id="cb9-92"><a href="#cb9-92" tabindex="-1"></a><span class="co">#&gt;     XM                0.025    0.048    0.518    0.605</span></span>
<span id="cb9-93"><a href="#cb9-93" tabindex="-1"></a><span class="co">#&gt;   M ~~                                                </span></span>
<span id="cb9-94"><a href="#cb9-94" tabindex="-1"></a><span class="co">#&gt;     XM               -0.091    0.047   -1.915    0.055</span></span>
<span id="cb9-95"><a href="#cb9-95" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb9-96"><a href="#cb9-96" tabindex="-1"></a><span class="co">#&gt; Variances:</span></span>
<span id="cb9-97"><a href="#cb9-97" tabindex="-1"></a><span class="co">#&gt;                    Estimate  Std.Err  z-value  P(&gt;|z|)</span></span>
<span id="cb9-98"><a href="#cb9-98" tabindex="-1"></a><span class="co">#&gt;    .x_mean  (ev_x)    0.332    0.021   15.811    0.000</span></span>
<span id="cb9-99"><a href="#cb9-99" tabindex="-1"></a><span class="co">#&gt;    .m_mean  (ev_m)    0.331    0.021   15.811    0.000</span></span>
<span id="cb9-100"><a href="#cb9-100" tabindex="-1"></a><span class="co">#&gt;    .xm     (ev_xm)    0.550    0.053   10.371    0.000</span></span>
<span id="cb9-101"><a href="#cb9-101" tabindex="-1"></a><span class="co">#&gt;     X        (v_x)    0.686    0.043   15.811    0.000</span></span>
<span id="cb9-102"><a href="#cb9-102" tabindex="-1"></a><span class="co">#&gt;     M        (v_m)    0.644    0.041   15.811    0.000</span></span>
<span id="cb9-103"><a href="#cb9-103" tabindex="-1"></a><span class="co">#&gt;     XM      (v_xm)    0.594    0.089    6.634    0.000</span></span>
<span id="cb9-104"><a href="#cb9-104" tabindex="-1"></a><span class="co">#&gt;    .Y                 0.562    0.047   11.836    0.000</span></span>
<span id="cb9-105"><a href="#cb9-105" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb9-106"><a href="#cb9-106" tabindex="-1"></a><span class="co">#&gt; Defined Parameters:</span></span>
<span id="cb9-107"><a href="#cb9-107" tabindex="-1"></a><span class="co">#&gt;                    Estimate  Std.Err  z-value  P(&gt;|z|)</span></span>
<span id="cb9-108"><a href="#cb9-108" tabindex="-1"></a><span class="co">#&gt;     beta1             0.175    0.071    2.461    0.014</span></span>
<span id="cb9-109"><a href="#cb9-109" tabindex="-1"></a><span class="co">#&gt;     beta2             0.333    0.075    4.426    0.000</span></span>
<span id="cb9-110"><a href="#cb9-110" tabindex="-1"></a><span class="co">#&gt;     beta3             0.276    0.064    4.312    0.000</span></span>
<span id="cb9-111"><a href="#cb9-111" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb9-112"><a href="#cb9-112" tabindex="-1"></a><span class="co">#&gt; Constraints:</span></span>
<span id="cb9-113"><a href="#cb9-113" tabindex="-1"></a><span class="co">#&gt;                                                |Slack|</span></span>
<span id="cb9-114"><a href="#cb9-114" tabindex="-1"></a><span class="co">#&gt;     e_-((1-0.674129143340008)*_/0.67412914334    0.000</span></span>
<span id="cb9-115"><a href="#cb9-115" tabindex="-1"></a><span class="co">#&gt;     e_-((1-0.660827265063382)*_/0.66082726506    0.000</span></span>
<span id="cb9-116"><a href="#cb9-116" tabindex="-1"></a><span class="co">#&gt;     ev_xm - (ev_x*v_m+ev_m*v_x+ev_x*ev_m)        0.000</span></span></code></pre></div>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" tabindex="-1"></a><span class="co"># Step 1: Retrieve factor loadings from fitted upi</span></span>
<span id="cb10-2"><a href="#cb10-2" tabindex="-1"></a>mod <span class="ot">&lt;-</span> <span class="st">&#39;X =~ x1 + x2 + x3</span></span>
<span id="cb10-3"><a href="#cb10-3" tabindex="-1"></a><span class="st">        M =~ m1 + m2 + m3&#39;</span></span>
<span id="cb10-4"><a href="#cb10-4" tabindex="-1"></a>PE <span class="ot">&lt;-</span> <span class="fu">parameterEstimates</span>(<span class="fu">sem</span>(mod, df))</span>
<span id="cb10-5"><a href="#cb10-5" tabindex="-1"></a></span>
<span id="cb10-6"><a href="#cb10-6" tabindex="-1"></a><span class="co"># Step 2: Caculate sum of factor loadings, error variance</span></span>
<span id="cb10-7"><a href="#cb10-7" tabindex="-1"></a><span class="co"># Sum of factor loadings</span></span>
<span id="cb10-8"><a href="#cb10-8" tabindex="-1"></a>X_lambda <span class="ot">&lt;-</span> <span class="fu">sum</span>(PE[<span class="fu">match</span>(<span class="fu">c</span>(<span class="st">&quot;x1&quot;</span>, <span class="st">&quot;x2&quot;</span>, <span class="st">&quot;x3&quot;</span>), PE<span class="sc">$</span>rhs), <span class="st">&quot;est&quot;</span>])</span>
<span id="cb10-9"><a href="#cb10-9" tabindex="-1"></a>M_lambda <span class="ot">&lt;-</span> <span class="fu">sum</span>(PE[<span class="fu">match</span>(<span class="fu">c</span>(<span class="st">&quot;m1&quot;</span>, <span class="st">&quot;m2&quot;</span>, <span class="st">&quot;m3&quot;</span>), PE<span class="sc">$</span>rhs), <span class="st">&quot;est&quot;</span>])</span>
<span id="cb10-10"><a href="#cb10-10" tabindex="-1"></a>  </span>
<span id="cb10-11"><a href="#cb10-11" tabindex="-1"></a><span class="co"># Sum of error variances</span></span>
<span id="cb10-12"><a href="#cb10-12" tabindex="-1"></a>PE_vcov <span class="ot">&lt;-</span> PE[PE<span class="sc">$</span>op <span class="sc">==</span> <span class="st">&quot;~~&quot;</span>, ]</span>
<span id="cb10-13"><a href="#cb10-13" tabindex="-1"></a>x_ev <span class="ot">&lt;-</span> <span class="fu">sum</span>(PE_vcov[<span class="fu">match</span>(<span class="fu">c</span>(<span class="st">&quot;x1&quot;</span>, <span class="st">&quot;x2&quot;</span>, <span class="st">&quot;x3&quot;</span>), PE_vcov<span class="sc">$</span>rhs), <span class="st">&quot;est&quot;</span>])</span>
<span id="cb10-14"><a href="#cb10-14" tabindex="-1"></a>m_ev <span class="ot">&lt;-</span> <span class="fu">sum</span>(PE_vcov[<span class="fu">match</span>(<span class="fu">c</span>(<span class="st">&quot;m1&quot;</span>, <span class="st">&quot;m2&quot;</span>, <span class="st">&quot;m3&quot;</span>), PE_vcov<span class="sc">$</span>rhs), <span class="st">&quot;est&quot;</span>])</span>
<span id="cb10-15"><a href="#cb10-15" tabindex="-1"></a>  </span>
<span id="cb10-16"><a href="#cb10-16" tabindex="-1"></a><span class="co"># Mean of item scores</span></span>
<span id="cb10-17"><a href="#cb10-17" tabindex="-1"></a>df_centered <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span></span>
<span id="cb10-18"><a href="#cb10-18" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">c</span>(x1<span class="sc">:</span>m3), <span class="sc">~</span> . <span class="sc">-</span> <span class="fu">mean</span>(.)))</span>
<span id="cb10-19"><a href="#cb10-19" tabindex="-1"></a>df_centered<span class="sc">$</span>x_sum <span class="ot">&lt;-</span> <span class="fu">rowSums</span>(df_centered[, <span class="fu">c</span>(<span class="st">&quot;x1&quot;</span>, <span class="st">&quot;x2&quot;</span>, <span class="st">&quot;x3&quot;</span>)])</span>
<span id="cb10-20"><a href="#cb10-20" tabindex="-1"></a>df_centered<span class="sc">$</span>m_sum <span class="ot">&lt;-</span> <span class="fu">rowSums</span>(df_centered[, <span class="fu">c</span>(<span class="st">&quot;m1&quot;</span>, <span class="st">&quot;m2&quot;</span>, <span class="st">&quot;m3&quot;</span>)])</span>
<span id="cb10-21"><a href="#cb10-21" tabindex="-1"></a>  </span>
<span id="cb10-22"><a href="#cb10-22" tabindex="-1"></a><span class="co"># Step 3: Create the interaction indicator</span></span>
<span id="cb10-23"><a href="#cb10-23" tabindex="-1"></a>df_centered<span class="sc">$</span>xm <span class="ot">&lt;-</span> df_centered<span class="sc">$</span>x_sum<span class="sc">*</span>df_centered<span class="sc">$</span>m_sum</span>
<span id="cb10-24"><a href="#cb10-24" tabindex="-1"></a></span>
<span id="cb10-25"><a href="#cb10-25" tabindex="-1"></a><span class="co"># Step 4: Calculate reliability of indicators and error constraint for the interaction term</span></span>
<span id="cb10-26"><a href="#cb10-26" tabindex="-1"></a>x_rel <span class="ot">&lt;-</span> psych<span class="sc">::</span><span class="fu">alpha</span>(df_centered[, <span class="fu">c</span>(<span class="st">&quot;x1&quot;</span>, <span class="st">&quot;x2&quot;</span>, <span class="st">&quot;x3&quot;</span>)])<span class="sc">$</span>total<span class="sc">$</span>raw_alpha</span>
<span id="cb10-27"><a href="#cb10-27" tabindex="-1"></a><span class="co">#&gt; Number of categories should be increased  in order to count frequencies.</span></span>
<span id="cb10-28"><a href="#cb10-28" tabindex="-1"></a>m_rel <span class="ot">&lt;-</span> psych<span class="sc">::</span><span class="fu">alpha</span>(df_centered[, <span class="fu">c</span>(<span class="st">&quot;m1&quot;</span>, <span class="st">&quot;m2&quot;</span>, <span class="st">&quot;m3&quot;</span>)])<span class="sc">$</span>total<span class="sc">$</span>raw_alpha</span>
<span id="cb10-29"><a href="#cb10-29" tabindex="-1"></a><span class="co">#&gt; Number of categories should be increased  in order to count frequencies.</span></span>
<span id="cb10-30"><a href="#cb10-30" tabindex="-1"></a>int_ev <span class="ot">&lt;-</span> x_rel<span class="sc">*</span><span class="fu">var</span>(df_centered<span class="sc">$</span>x_sum, <span class="at">na.rm =</span> T)<span class="sc">*</span>(<span class="dv">1</span> <span class="sc">-</span> m_rel)<span class="sc">*</span><span class="fu">var</span>(df_centered<span class="sc">$</span>m_sum, <span class="at">na.rm =</span> T) <span class="sc">+</span></span>
<span id="cb10-31"><a href="#cb10-31" tabindex="-1"></a>    m_rel<span class="sc">*</span><span class="fu">var</span>(df_centered<span class="sc">$</span>m_sum, <span class="at">na.rm =</span> T)<span class="sc">*</span>(<span class="dv">1</span> <span class="sc">-</span> x_rel)<span class="sc">*</span><span class="fu">var</span>(df_centered<span class="sc">$</span>x_sum, <span class="at">na.rm =</span> T) <span class="sc">+</span></span>
<span id="cb10-32"><a href="#cb10-32" tabindex="-1"></a>    (<span class="dv">1</span> <span class="sc">-</span> m_rel)<span class="sc">*</span><span class="fu">var</span>(df_centered<span class="sc">$</span>m_sum, <span class="at">na.rm =</span> T)<span class="sc">*</span>(<span class="dv">1</span> <span class="sc">-</span> x_rel)<span class="sc">*</span><span class="fu">var</span>(df_centered<span class="sc">$</span>x_sum, <span class="at">na.rm =</span> T)</span>
<span id="cb10-33"><a href="#cb10-33" tabindex="-1"></a></span>
<span id="cb10-34"><a href="#cb10-34" tabindex="-1"></a><span class="co"># Step 5: Draft the model syntax</span></span>
<span id="cb10-35"><a href="#cb10-35" tabindex="-1"></a>mod_rapi <span class="ot">&lt;-</span> <span class="st">&#39;X =~ X_lambda * x_sum</span></span>
<span id="cb10-36"><a href="#cb10-36" tabindex="-1"></a><span class="st">             M =~ M_lambda * m_sum</span></span>
<span id="cb10-37"><a href="#cb10-37" tabindex="-1"></a><span class="st">             XM =~ X_lambda * M_lambda * xm</span></span>
<span id="cb10-38"><a href="#cb10-38" tabindex="-1"></a><span class="st">             </span></span>
<span id="cb10-39"><a href="#cb10-39" tabindex="-1"></a><span class="st">             # Error variance</span></span>
<span id="cb10-40"><a href="#cb10-40" tabindex="-1"></a><span class="st">             x_sum ~~ x_ev * x_sum</span></span>
<span id="cb10-41"><a href="#cb10-41" tabindex="-1"></a><span class="st">             m_sum ~~ m_ev * m_sum</span></span>
<span id="cb10-42"><a href="#cb10-42" tabindex="-1"></a><span class="st">             xm ~~ int_ev * xm</span></span>
<span id="cb10-43"><a href="#cb10-43" tabindex="-1"></a><span class="st">             </span></span>
<span id="cb10-44"><a href="#cb10-44" tabindex="-1"></a><span class="st">             # Regression</span></span>
<span id="cb10-45"><a href="#cb10-45" tabindex="-1"></a><span class="st">             Y ~ X + M + b3 * XM</span></span>
<span id="cb10-46"><a href="#cb10-46" tabindex="-1"></a><span class="st">             </span></span>
<span id="cb10-47"><a href="#cb10-47" tabindex="-1"></a><span class="st">             # Latent variance</span></span>
<span id="cb10-48"><a href="#cb10-48" tabindex="-1"></a><span class="st">             X ~~ v_x * X</span></span>
<span id="cb10-49"><a href="#cb10-49" tabindex="-1"></a><span class="st">             M ~~ v_m * M</span></span>
<span id="cb10-50"><a href="#cb10-50" tabindex="-1"></a><span class="st">             XM ~~ v_xm * XM</span></span>
<span id="cb10-51"><a href="#cb10-51" tabindex="-1"></a><span class="st">             </span></span>
<span id="cb10-52"><a href="#cb10-52" tabindex="-1"></a><span class="st">             # x-standardized interaction</span></span>
<span id="cb10-53"><a href="#cb10-53" tabindex="-1"></a><span class="st">             beta3 := b3 * sqrt(v_x) * sqrt(v_m)&#39;</span></span>
<span id="cb10-54"><a href="#cb10-54" tabindex="-1"></a></span>
<span id="cb10-55"><a href="#cb10-55" tabindex="-1"></a><span class="co"># Substitute in the actual reliability estimates</span></span>
<span id="cb10-56"><a href="#cb10-56" tabindex="-1"></a><span class="co"># Define patterns and their replacements</span></span>
<span id="cb10-57"><a href="#cb10-57" tabindex="-1"></a>replacements <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb10-58"><a href="#cb10-58" tabindex="-1"></a>  <span class="at">X_lambda =</span> X_lambda,</span>
<span id="cb10-59"><a href="#cb10-59" tabindex="-1"></a>  <span class="at">M_lambda =</span> M_lambda,</span>
<span id="cb10-60"><a href="#cb10-60" tabindex="-1"></a>  <span class="at">x_ev =</span> x_ev,</span>
<span id="cb10-61"><a href="#cb10-61" tabindex="-1"></a>  <span class="at">m_ev =</span> m_ev,</span>
<span id="cb10-62"><a href="#cb10-62" tabindex="-1"></a>  <span class="at">int_ev =</span> int_ev</span>
<span id="cb10-63"><a href="#cb10-63" tabindex="-1"></a>)</span>
<span id="cb10-64"><a href="#cb10-64" tabindex="-1"></a></span>
<span id="cb10-65"><a href="#cb10-65" tabindex="-1"></a><span class="co"># Iterate over the replacements and update the model string</span></span>
<span id="cb10-66"><a href="#cb10-66" tabindex="-1"></a><span class="cf">for</span> (pattern <span class="cf">in</span> <span class="fu">names</span>(replacements)) {</span>
<span id="cb10-67"><a href="#cb10-67" tabindex="-1"></a>  mod_rapi <span class="ot">&lt;-</span> <span class="fu">gsub</span>(pattern, replacements[[pattern]], mod_rapi)</span>
<span id="cb10-68"><a href="#cb10-68" tabindex="-1"></a>}</span>
<span id="cb10-69"><a href="#cb10-69" tabindex="-1"></a></span>
<span id="cb10-70"><a href="#cb10-70" tabindex="-1"></a><span class="co"># Step 6: Fit the RAPI model</span></span>
<span id="cb10-71"><a href="#cb10-71" tabindex="-1"></a>rapi_fit <span class="ot">&lt;-</span> <span class="fu">sem</span>(mod_rapi, <span class="at">data =</span> df_centered)</span>
<span id="cb10-72"><a href="#cb10-72" tabindex="-1"></a><span class="fu">summary</span>(rapi_fit)</span>
<span id="cb10-73"><a href="#cb10-73" tabindex="-1"></a><span class="co">#&gt; lavaan 0.6-18 ended normally after 39 iterations</span></span>
<span id="cb10-74"><a href="#cb10-74" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb10-75"><a href="#cb10-75" tabindex="-1"></a><span class="co">#&gt;   Estimator                                         ML</span></span>
<span id="cb10-76"><a href="#cb10-76" tabindex="-1"></a><span class="co">#&gt;   Optimization method                           NLMINB</span></span>
<span id="cb10-77"><a href="#cb10-77" tabindex="-1"></a><span class="co">#&gt;   Number of model parameters                        10</span></span>
<span id="cb10-78"><a href="#cb10-78" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb10-79"><a href="#cb10-79" tabindex="-1"></a><span class="co">#&gt;   Number of observations                           500</span></span>
<span id="cb10-80"><a href="#cb10-80" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb10-81"><a href="#cb10-81" tabindex="-1"></a><span class="co">#&gt; Model Test User Model:</span></span>
<span id="cb10-82"><a href="#cb10-82" tabindex="-1"></a><span class="co">#&gt;                                                       </span></span>
<span id="cb10-83"><a href="#cb10-83" tabindex="-1"></a><span class="co">#&gt;   Test statistic                                 0.000</span></span>
<span id="cb10-84"><a href="#cb10-84" tabindex="-1"></a><span class="co">#&gt;   Degrees of freedom                                 0</span></span>
<span id="cb10-85"><a href="#cb10-85" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb10-86"><a href="#cb10-86" tabindex="-1"></a><span class="co">#&gt; Parameter Estimates:</span></span>
<span id="cb10-87"><a href="#cb10-87" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb10-88"><a href="#cb10-88" tabindex="-1"></a><span class="co">#&gt;   Standard errors                             Standard</span></span>
<span id="cb10-89"><a href="#cb10-89" tabindex="-1"></a><span class="co">#&gt;   Information                                 Expected</span></span>
<span id="cb10-90"><a href="#cb10-90" tabindex="-1"></a><span class="co">#&gt;   Information saturated (h1) model          Structured</span></span>
<span id="cb10-91"><a href="#cb10-91" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb10-92"><a href="#cb10-92" tabindex="-1"></a><span class="co">#&gt; Latent Variables:</span></span>
<span id="cb10-93"><a href="#cb10-93" tabindex="-1"></a><span class="co">#&gt;                    Estimate  Std.Err  z-value  P(&gt;|z|)</span></span>
<span id="cb10-94"><a href="#cb10-94" tabindex="-1"></a><span class="co">#&gt;   X =~                                                </span></span>
<span id="cb10-95"><a href="#cb10-95" tabindex="-1"></a><span class="co">#&gt;     x_sum             2.636                           </span></span>
<span id="cb10-96"><a href="#cb10-96" tabindex="-1"></a><span class="co">#&gt;   M =~                                                </span></span>
<span id="cb10-97"><a href="#cb10-97" tabindex="-1"></a><span class="co">#&gt;     m_sum             2.736                           </span></span>
<span id="cb10-98"><a href="#cb10-98" tabindex="-1"></a><span class="co">#&gt;   XM =~                                               </span></span>
<span id="cb10-99"><a href="#cb10-99" tabindex="-1"></a><span class="co">#&gt;     xm                2.736                           </span></span>
<span id="cb10-100"><a href="#cb10-100" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb10-101"><a href="#cb10-101" tabindex="-1"></a><span class="co">#&gt; Regressions:</span></span>
<span id="cb10-102"><a href="#cb10-102" tabindex="-1"></a><span class="co">#&gt;                    Estimate  Std.Err  z-value  P(&gt;|z|)</span></span>
<span id="cb10-103"><a href="#cb10-103" tabindex="-1"></a><span class="co">#&gt;   Y ~                                                 </span></span>
<span id="cb10-104"><a href="#cb10-104" tabindex="-1"></a><span class="co">#&gt;     X                 0.187    0.074    2.526    0.012</span></span>
<span id="cb10-105"><a href="#cb10-105" tabindex="-1"></a><span class="co">#&gt;     M                 0.374    0.082    4.565    0.000</span></span>
<span id="cb10-106"><a href="#cb10-106" tabindex="-1"></a><span class="co">#&gt;     XM        (b3)    0.126    0.023    5.531    0.000</span></span>
<span id="cb10-107"><a href="#cb10-107" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb10-108"><a href="#cb10-108" tabindex="-1"></a><span class="co">#&gt; Covariances:</span></span>
<span id="cb10-109"><a href="#cb10-109" tabindex="-1"></a><span class="co">#&gt;                    Estimate  Std.Err  z-value  P(&gt;|z|)</span></span>
<span id="cb10-110"><a href="#cb10-110" tabindex="-1"></a><span class="co">#&gt;   X ~~                                                </span></span>
<span id="cb10-111"><a href="#cb10-111" tabindex="-1"></a><span class="co">#&gt;     M                 0.500    0.060    8.351    0.000</span></span>
<span id="cb10-112"><a href="#cb10-112" tabindex="-1"></a><span class="co">#&gt;     XM                0.094    0.181    0.518    0.605</span></span>
<span id="cb10-113"><a href="#cb10-113" tabindex="-1"></a><span class="co">#&gt;   M ~~                                                </span></span>
<span id="cb10-114"><a href="#cb10-114" tabindex="-1"></a><span class="co">#&gt;     XM               -0.327    0.171   -1.915    0.055</span></span>
<span id="cb10-115"><a href="#cb10-115" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb10-116"><a href="#cb10-116" tabindex="-1"></a><span class="co">#&gt; Variances:</span></span>
<span id="cb10-117"><a href="#cb10-117" tabindex="-1"></a><span class="co">#&gt;                    Estimate  Std.Err  z-value  P(&gt;|z|)</span></span>
<span id="cb10-118"><a href="#cb10-118" tabindex="-1"></a><span class="co">#&gt;    .x_sum             2.950                           </span></span>
<span id="cb10-119"><a href="#cb10-119" tabindex="-1"></a><span class="co">#&gt;    .m_sum             2.924                           </span></span>
<span id="cb10-120"><a href="#cb10-120" tabindex="-1"></a><span class="co">#&gt;    .xm               44.745                           </span></span>
<span id="cb10-121"><a href="#cb10-121" tabindex="-1"></a><span class="co">#&gt;     X        (v_x)    0.894    0.083   10.720    0.000</span></span>
<span id="cb10-122"><a href="#cb10-122" tabindex="-1"></a><span class="co">#&gt;     M        (v_m)    0.781    0.074   10.542    0.000</span></span>
<span id="cb10-123"><a href="#cb10-123" tabindex="-1"></a><span class="co">#&gt;     XM      (v_xm)    6.398    0.783    8.175    0.000</span></span>
<span id="cb10-124"><a href="#cb10-124" tabindex="-1"></a><span class="co">#&gt;    .Y                 0.563    0.046   12.230    0.000</span></span>
<span id="cb10-125"><a href="#cb10-125" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb10-126"><a href="#cb10-126" tabindex="-1"></a><span class="co">#&gt; Defined Parameters:</span></span>
<span id="cb10-127"><a href="#cb10-127" tabindex="-1"></a><span class="co">#&gt;                    Estimate  Std.Err  z-value  P(&gt;|z|)</span></span>
<span id="cb10-128"><a href="#cb10-128" tabindex="-1"></a><span class="co">#&gt;     beta3             0.106    0.020    5.154    0.000</span></span></code></pre></div>
<p>The RAPI method using factor loading constraints as 1s above have
been wrapped up into a function <code>rapi</code>. Here is an example
demonstration:</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" tabindex="-1"></a><span class="co"># Draft the model syntax</span></span>
<span id="cb11-2"><a href="#cb11-2" tabindex="-1"></a>mod_rapi <span class="ot">&lt;-</span> <span class="st">&#39;# Measurement Model</span></span>
<span id="cb11-3"><a href="#cb11-3" tabindex="-1"></a><span class="st">              X =~ x1 + x2 + x3</span></span>
<span id="cb11-4"><a href="#cb11-4" tabindex="-1"></a><span class="st">              M =~ m1 + m2 + m3</span></span>
<span id="cb11-5"><a href="#cb11-5" tabindex="-1"></a><span class="st">            # Structural Model</span></span>
<span id="cb11-6"><a href="#cb11-6" tabindex="-1"></a><span class="st">              Y ~ b1*X + b2*M + b3*X:M</span></span>
<span id="cb11-7"><a href="#cb11-7" tabindex="-1"></a><span class="st">            # Define Standardized Coefficients</span></span>
<span id="cb11-8"><a href="#cb11-8" tabindex="-1"></a><span class="st">              X ~~ v1*X</span></span>
<span id="cb11-9"><a href="#cb11-9" tabindex="-1"></a><span class="st">              M ~~ v2*M</span></span>
<span id="cb11-10"><a href="#cb11-10" tabindex="-1"></a><span class="st">              beta1 := b1*sqrt(v1)</span></span>
<span id="cb11-11"><a href="#cb11-11" tabindex="-1"></a><span class="st">              beta2 := b2*sqrt(v2)</span></span>
<span id="cb11-12"><a href="#cb11-12" tabindex="-1"></a><span class="st">              beta3 := b3*sqrt(v1)*sqrt(v2)&#39;</span></span>
<span id="cb11-13"><a href="#cb11-13" tabindex="-1"></a></span>
<span id="cb11-14"><a href="#cb11-14" tabindex="-1"></a><span class="co"># Fit the model using rapi()</span></span>
<span id="cb11-15"><a href="#cb11-15" tabindex="-1"></a>fit_rapi <span class="ot">&lt;-</span> <span class="fu">rapi</span>(<span class="at">model =</span> mod_rapi, <span class="at">data =</span> df) </span>
<span id="cb11-16"><a href="#cb11-16" tabindex="-1"></a><span class="fu">summary</span>(fit_rapi, <span class="at">fit.measure =</span> <span class="cn">TRUE</span>, <span class="at">standardized =</span> <span class="cn">TRUE</span>)</span>
<span id="cb11-17"><a href="#cb11-17" tabindex="-1"></a><span class="co">#&gt; lavaan 0.6-18 ended normally after 74 iterations</span></span>
<span id="cb11-18"><a href="#cb11-18" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb11-19"><a href="#cb11-19" tabindex="-1"></a><span class="co">#&gt;   Estimator                                         ML</span></span>
<span id="cb11-20"><a href="#cb11-20" tabindex="-1"></a><span class="co">#&gt;   Optimization method                           NLMINB</span></span>
<span id="cb11-21"><a href="#cb11-21" tabindex="-1"></a><span class="co">#&gt;   Number of model parameters                        13</span></span>
<span id="cb11-22"><a href="#cb11-22" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb11-23"><a href="#cb11-23" tabindex="-1"></a><span class="co">#&gt;   Number of observations                           500</span></span>
<span id="cb11-24"><a href="#cb11-24" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb11-25"><a href="#cb11-25" tabindex="-1"></a><span class="co">#&gt; Model Test User Model:</span></span>
<span id="cb11-26"><a href="#cb11-26" tabindex="-1"></a><span class="co">#&gt;                                                       </span></span>
<span id="cb11-27"><a href="#cb11-27" tabindex="-1"></a><span class="co">#&gt;   Test statistic                                 0.000</span></span>
<span id="cb11-28"><a href="#cb11-28" tabindex="-1"></a><span class="co">#&gt;   Degrees of freedom                                 0</span></span>
<span id="cb11-29"><a href="#cb11-29" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb11-30"><a href="#cb11-30" tabindex="-1"></a><span class="co">#&gt; Model Test Baseline Model:</span></span>
<span id="cb11-31"><a href="#cb11-31" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb11-32"><a href="#cb11-32" tabindex="-1"></a><span class="co">#&gt;   Test statistic                               221.498</span></span>
<span id="cb11-33"><a href="#cb11-33" tabindex="-1"></a><span class="co">#&gt;   Degrees of freedom                                 6</span></span>
<span id="cb11-34"><a href="#cb11-34" tabindex="-1"></a><span class="co">#&gt;   P-value                                        0.000</span></span>
<span id="cb11-35"><a href="#cb11-35" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb11-36"><a href="#cb11-36" tabindex="-1"></a><span class="co">#&gt; User Model versus Baseline Model:</span></span>
<span id="cb11-37"><a href="#cb11-37" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb11-38"><a href="#cb11-38" tabindex="-1"></a><span class="co">#&gt;   Comparative Fit Index (CFI)                    1.000</span></span>
<span id="cb11-39"><a href="#cb11-39" tabindex="-1"></a><span class="co">#&gt;   Tucker-Lewis Index (TLI)                       1.000</span></span>
<span id="cb11-40"><a href="#cb11-40" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb11-41"><a href="#cb11-41" tabindex="-1"></a><span class="co">#&gt; Loglikelihood and Information Criteria:</span></span>
<span id="cb11-42"><a href="#cb11-42" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb11-43"><a href="#cb11-43" tabindex="-1"></a><span class="co">#&gt;   Loglikelihood user model (H0)              -2717.799</span></span>
<span id="cb11-44"><a href="#cb11-44" tabindex="-1"></a><span class="co">#&gt;   Loglikelihood unrestricted model (H1)      -2717.799</span></span>
<span id="cb11-45"><a href="#cb11-45" tabindex="-1"></a><span class="co">#&gt;                                                       </span></span>
<span id="cb11-46"><a href="#cb11-46" tabindex="-1"></a><span class="co">#&gt;   Akaike (AIC)                                5455.599</span></span>
<span id="cb11-47"><a href="#cb11-47" tabindex="-1"></a><span class="co">#&gt;   Bayesian (BIC)                              5497.745</span></span>
<span id="cb11-48"><a href="#cb11-48" tabindex="-1"></a><span class="co">#&gt;   Sample-size adjusted Bayesian (SABIC)       5466.004</span></span>
<span id="cb11-49"><a href="#cb11-49" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb11-50"><a href="#cb11-50" tabindex="-1"></a><span class="co">#&gt; Root Mean Square Error of Approximation:</span></span>
<span id="cb11-51"><a href="#cb11-51" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb11-52"><a href="#cb11-52" tabindex="-1"></a><span class="co">#&gt;   RMSEA                                          0.000</span></span>
<span id="cb11-53"><a href="#cb11-53" tabindex="-1"></a><span class="co">#&gt;   90 Percent confidence interval - lower         0.000</span></span>
<span id="cb11-54"><a href="#cb11-54" tabindex="-1"></a><span class="co">#&gt;   90 Percent confidence interval - upper         0.000</span></span>
<span id="cb11-55"><a href="#cb11-55" tabindex="-1"></a><span class="co">#&gt;   P-value H_0: RMSEA &lt;= 0.050                       NA</span></span>
<span id="cb11-56"><a href="#cb11-56" tabindex="-1"></a><span class="co">#&gt;   P-value H_0: RMSEA &gt;= 0.080                       NA</span></span>
<span id="cb11-57"><a href="#cb11-57" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb11-58"><a href="#cb11-58" tabindex="-1"></a><span class="co">#&gt; Standardized Root Mean Square Residual:</span></span>
<span id="cb11-59"><a href="#cb11-59" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb11-60"><a href="#cb11-60" tabindex="-1"></a><span class="co">#&gt;   SRMR                                           0.000</span></span>
<span id="cb11-61"><a href="#cb11-61" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb11-62"><a href="#cb11-62" tabindex="-1"></a><span class="co">#&gt; Parameter Estimates:</span></span>
<span id="cb11-63"><a href="#cb11-63" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb11-64"><a href="#cb11-64" tabindex="-1"></a><span class="co">#&gt;   Standard errors                             Standard</span></span>
<span id="cb11-65"><a href="#cb11-65" tabindex="-1"></a><span class="co">#&gt;   Information                                 Expected</span></span>
<span id="cb11-66"><a href="#cb11-66" tabindex="-1"></a><span class="co">#&gt;   Information saturated (h1) model          Structured</span></span>
<span id="cb11-67"><a href="#cb11-67" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb11-68"><a href="#cb11-68" tabindex="-1"></a><span class="co">#&gt; Latent Variables:</span></span>
<span id="cb11-69"><a href="#cb11-69" tabindex="-1"></a><span class="co">#&gt;                    Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all</span></span>
<span id="cb11-70"><a href="#cb11-70" tabindex="-1"></a><span class="co">#&gt;   X =~                                                                  </span></span>
<span id="cb11-71"><a href="#cb11-71" tabindex="-1"></a><span class="co">#&gt;     X_mean            1.000                               0.828    0.821</span></span>
<span id="cb11-72"><a href="#cb11-72" tabindex="-1"></a><span class="co">#&gt;   M =~                                                                  </span></span>
<span id="cb11-73"><a href="#cb11-73" tabindex="-1"></a><span class="co">#&gt;     M_mean            1.000                               0.803    0.813</span></span>
<span id="cb11-74"><a href="#cb11-74" tabindex="-1"></a><span class="co">#&gt;   X_M =~                                                                </span></span>
<span id="cb11-75"><a href="#cb11-75" tabindex="-1"></a><span class="co">#&gt;     X_int_M           1.000                               0.770    0.720</span></span>
<span id="cb11-76"><a href="#cb11-76" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb11-77"><a href="#cb11-77" tabindex="-1"></a><span class="co">#&gt; Regressions:</span></span>
<span id="cb11-78"><a href="#cb11-78" tabindex="-1"></a><span class="co">#&gt;                    Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all</span></span>
<span id="cb11-79"><a href="#cb11-79" tabindex="-1"></a><span class="co">#&gt;   Y ~                                                                   </span></span>
<span id="cb11-80"><a href="#cb11-80" tabindex="-1"></a><span class="co">#&gt;     X         (b1)    0.211    0.086    2.457    0.014    0.175    0.190</span></span>
<span id="cb11-81"><a href="#cb11-81" tabindex="-1"></a><span class="co">#&gt;     M         (b2)    0.414    0.091    4.557    0.000    0.333    0.361</span></span>
<span id="cb11-82"><a href="#cb11-82" tabindex="-1"></a><span class="co">#&gt;     X_M       (b3)    0.415    0.085    4.874    0.000    0.320    0.347</span></span>
<span id="cb11-83"><a href="#cb11-83" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb11-84"><a href="#cb11-84" tabindex="-1"></a><span class="co">#&gt; Covariances:</span></span>
<span id="cb11-85"><a href="#cb11-85" tabindex="-1"></a><span class="co">#&gt;                    Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all</span></span>
<span id="cb11-86"><a href="#cb11-86" tabindex="-1"></a><span class="co">#&gt;   X ~~                                                                  </span></span>
<span id="cb11-87"><a href="#cb11-87" tabindex="-1"></a><span class="co">#&gt;     M                 0.401    0.048    8.351    0.000    0.603    0.603</span></span>
<span id="cb11-88"><a href="#cb11-88" tabindex="-1"></a><span class="co">#&gt;     X_M               0.025    0.048    0.518    0.605    0.039    0.039</span></span>
<span id="cb11-89"><a href="#cb11-89" tabindex="-1"></a><span class="co">#&gt;   M ~~                                                                  </span></span>
<span id="cb11-90"><a href="#cb11-90" tabindex="-1"></a><span class="co">#&gt;     X_M              -0.091    0.047   -1.915    0.055   -0.147   -0.147</span></span>
<span id="cb11-91"><a href="#cb11-91" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb11-92"><a href="#cb11-92" tabindex="-1"></a><span class="co">#&gt; Variances:</span></span>
<span id="cb11-93"><a href="#cb11-93" tabindex="-1"></a><span class="co">#&gt;                    Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all</span></span>
<span id="cb11-94"><a href="#cb11-94" tabindex="-1"></a><span class="co">#&gt;    .X_mean  (ev_X)    0.332    0.021   15.811    0.000    0.332    0.326</span></span>
<span id="cb11-95"><a href="#cb11-95" tabindex="-1"></a><span class="co">#&gt;    .M_mean  (ev_M)    0.331    0.021   15.811    0.000    0.331    0.339</span></span>
<span id="cb11-96"><a href="#cb11-96" tabindex="-1"></a><span class="co">#&gt;    .X_int_M (e_X_)    0.550    0.053   10.371    0.000    0.550    0.481</span></span>
<span id="cb11-97"><a href="#cb11-97" tabindex="-1"></a><span class="co">#&gt;     X         (v1)    0.686    0.043   15.811    0.000    1.000    1.000</span></span>
<span id="cb11-98"><a href="#cb11-98" tabindex="-1"></a><span class="co">#&gt;     M         (v2)    0.644    0.041   15.811    0.000    1.000    1.000</span></span>
<span id="cb11-99"><a href="#cb11-99" tabindex="-1"></a><span class="co">#&gt;    .Y                 0.562    0.047   11.836    0.000    0.562    0.662</span></span>
<span id="cb11-100"><a href="#cb11-100" tabindex="-1"></a><span class="co">#&gt;     X_M               0.594    0.089    6.634    0.000    1.000    1.000</span></span>
<span id="cb11-101"><a href="#cb11-101" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb11-102"><a href="#cb11-102" tabindex="-1"></a><span class="co">#&gt; Defined Parameters:</span></span>
<span id="cb11-103"><a href="#cb11-103" tabindex="-1"></a><span class="co">#&gt;                    Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all</span></span>
<span id="cb11-104"><a href="#cb11-104" tabindex="-1"></a><span class="co">#&gt;     beta1             0.175    0.071    2.461    0.014    0.175    0.190</span></span>
<span id="cb11-105"><a href="#cb11-105" tabindex="-1"></a><span class="co">#&gt;     beta2             0.333    0.075    4.426    0.000    0.333    0.361</span></span>
<span id="cb11-106"><a href="#cb11-106" tabindex="-1"></a><span class="co">#&gt;     beta3             0.276    0.064    4.312    0.000    0.320    0.347</span></span>
<span id="cb11-107"><a href="#cb11-107" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb11-108"><a href="#cb11-108" tabindex="-1"></a><span class="co">#&gt; Constraints:</span></span>
<span id="cb11-109"><a href="#cb11-109" tabindex="-1"></a><span class="co">#&gt;                                                |Slack|</span></span>
<span id="cb11-110"><a href="#cb11-110" tabindex="-1"></a><span class="co">#&gt;     e_X-((1-0.674129143340008)*1/0.6741291433    0.000</span></span>
<span id="cb11-111"><a href="#cb11-111" tabindex="-1"></a><span class="co">#&gt;     e_M-((1-0.660827265063382)*2/0.6608272650    0.000</span></span>
<span id="cb11-112"><a href="#cb11-112" tabindex="-1"></a><span class="co">#&gt;     ev_X_M - (ev_X*v2+ev_M*v1+ev_X*ev_M)         0.000</span></span></code></pre></div>
<div id="lrt-based-p-value-2" class="section level3">
<h3>LRT Based P-value</h3>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" tabindex="-1"></a>rapi_lrtp <span class="ot">&lt;-</span> <span class="fu">lrtp</span>(fit_rapi)</span>
<span id="cb12-2"><a href="#cb12-2" tabindex="-1"></a>rapi_lrtp</span>
<span id="cb12-3"><a href="#cb12-3" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb12-4"><a href="#cb12-4" tabindex="-1"></a><span class="co">#&gt; Parameter Estimates:</span></span>
<span id="cb12-5"><a href="#cb12-5" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb12-6"><a href="#cb12-6" tabindex="-1"></a><span class="co">#&gt;   Standard errors                             Standard</span></span>
<span id="cb12-7"><a href="#cb12-7" tabindex="-1"></a><span class="co">#&gt;   Information                                 Expected</span></span>
<span id="cb12-8"><a href="#cb12-8" tabindex="-1"></a><span class="co">#&gt;   Information saturated (h1) model          Structured</span></span>
<span id="cb12-9"><a href="#cb12-9" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb12-10"><a href="#cb12-10" tabindex="-1"></a><span class="co">#&gt; Regressions:</span></span>
<span id="cb12-11"><a href="#cb12-11" tabindex="-1"></a><span class="co">#&gt;                    Estimate  Std.Err    Chisq     LRTp</span></span>
<span id="cb12-12"><a href="#cb12-12" tabindex="-1"></a><span class="co">#&gt;   Y ~                                                 </span></span>
<span id="cb12-13"><a href="#cb12-13" tabindex="-1"></a><span class="co">#&gt;     X         (b1)    0.211    0.086    5.069    0.024</span></span>
<span id="cb12-14"><a href="#cb12-14" tabindex="-1"></a><span class="co">#&gt;     M         (b2)    0.414    0.091   20.738    0.000</span></span>
<span id="cb12-15"><a href="#cb12-15" tabindex="-1"></a><span class="co">#&gt;     X_M       (b3)    0.415    0.085   34.439    0.000</span></span>
<span id="cb12-16"><a href="#cb12-16" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb12-17"><a href="#cb12-17" tabindex="-1"></a><span class="co">#&gt; Covariances:</span></span>
<span id="cb12-18"><a href="#cb12-18" tabindex="-1"></a><span class="co">#&gt;                    Estimate  Std.Err    Chisq     LRTp</span></span>
<span id="cb12-19"><a href="#cb12-19" tabindex="-1"></a><span class="co">#&gt;   X ~~                                                </span></span>
<span id="cb12-20"><a href="#cb12-20" tabindex="-1"></a><span class="co">#&gt;     M                 0.401    0.048   88.422    0.000</span></span>
<span id="cb12-21"><a href="#cb12-21" tabindex="-1"></a><span class="co">#&gt;     X_M               0.025    0.048    0.268    0.605</span></span>
<span id="cb12-22"><a href="#cb12-22" tabindex="-1"></a><span class="co">#&gt;   M ~~                                                </span></span>
<span id="cb12-23"><a href="#cb12-23" tabindex="-1"></a><span class="co">#&gt;     X_M              -0.091    0.047    3.710    0.054</span></span></code></pre></div>
</div>
</div>
</div>
<div id="s-pa" class="section level1">
<h1>2S-PA</h1>
<p>The 2S-PA interaction model is based on the 2S-PA framework proposed
by Lai &amp; Hsiao (2022).</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" tabindex="-1"></a><span class="co"># Step 1: Get factor scores</span></span>
<span id="cb13-2"><a href="#cb13-2" tabindex="-1"></a>fs_dat <span class="ot">&lt;-</span> <span class="fu">get_fs</span>(df,</span>
<span id="cb13-3"><a href="#cb13-3" tabindex="-1"></a>                 <span class="at">model =</span><span class="st">&#39;X =~ x1 + x2 + x3</span></span>
<span id="cb13-4"><a href="#cb13-4" tabindex="-1"></a><span class="st">                         M =~ m1 + m2 + m3&#39;</span>,</span>
<span id="cb13-5"><a href="#cb13-5" tabindex="-1"></a>                 <span class="at">method =</span> <span class="st">&quot;Bartlett&quot;</span>,</span>
<span id="cb13-6"><a href="#cb13-6" tabindex="-1"></a>                 <span class="at">std.lv =</span> <span class="cn">TRUE</span>)</span>
<span id="cb13-7"><a href="#cb13-7" tabindex="-1"></a></span>
<span id="cb13-8"><a href="#cb13-8" tabindex="-1"></a><span class="co"># Step 2: Obtain mean-centered factor product</span></span>
<span id="cb13-9"><a href="#cb13-9" tabindex="-1"></a>fs_dat<span class="sc">$</span>fs_int <span class="ot">&lt;-</span> fs_dat<span class="sc">$</span>fs_X <span class="sc">*</span> fs_dat<span class="sc">$</span>fs_M</span>
<span id="cb13-10"><a href="#cb13-10" tabindex="-1"></a>fs_dat<span class="sc">$</span>fs_int <span class="ot">&lt;-</span> fs_dat<span class="sc">$</span>fs_int <span class="sc">-</span> <span class="fu">mean</span>(fs_dat<span class="sc">$</span>fs_int)</span>
<span id="cb13-11"><a href="#cb13-11" tabindex="-1"></a>Y <span class="ot">&lt;-</span> df<span class="sc">$</span>Y</span>
<span id="cb13-12"><a href="#cb13-12" tabindex="-1"></a>fs_dat <span class="ot">&lt;-</span> <span class="fu">cbind</span>(fs_dat, Y)</span>
<span id="cb13-13"><a href="#cb13-13" tabindex="-1"></a></span>
<span id="cb13-14"><a href="#cb13-14" tabindex="-1"></a><span class="co"># Step 3: Obtain the standard error of the interaction term</span></span>
<span id="cb13-15"><a href="#cb13-15" tabindex="-1"></a>fs_dat<span class="sc">$</span>fs_int_se <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="dv">1</span> <span class="sc">*</span> fs_dat<span class="sc">$</span>fs_X_se<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> <span class="dv">1</span> <span class="sc">*</span> fs_dat<span class="sc">$</span>fs_M_se<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> fs_dat<span class="sc">$</span>fs_X_se<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span>fs_dat<span class="sc">$</span>fs_M_se<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb13-16"><a href="#cb13-16" tabindex="-1"></a></span>
<span id="cb13-17"><a href="#cb13-17" tabindex="-1"></a><span class="co"># Step 4: </span></span>
<span id="cb13-18"><a href="#cb13-18" tabindex="-1"></a>mod_tspa <span class="ot">=</span> <span class="st">&#39;# latent variables (indicated by factor scores)</span></span>
<span id="cb13-19"><a href="#cb13-19" tabindex="-1"></a><span class="st">            X =~ fs_X</span></span>
<span id="cb13-20"><a href="#cb13-20" tabindex="-1"></a><span class="st">            M =~ fs_M</span></span>
<span id="cb13-21"><a href="#cb13-21" tabindex="-1"></a><span class="st">            XM =~ fs_int</span></span>
<span id="cb13-22"><a href="#cb13-22" tabindex="-1"></a><span class="st">            </span></span>
<span id="cb13-23"><a href="#cb13-23" tabindex="-1"></a><span class="st">            # constrain the errors</span></span>
<span id="cb13-24"><a href="#cb13-24" tabindex="-1"></a><span class="st">            fs_X ~~ rel_X * fs_X</span></span>
<span id="cb13-25"><a href="#cb13-25" tabindex="-1"></a><span class="st">            fs_M ~~ rel_M * fs_M</span></span>
<span id="cb13-26"><a href="#cb13-26" tabindex="-1"></a><span class="st">            fs_int ~~ rel_int * fs_int</span></span>
<span id="cb13-27"><a href="#cb13-27" tabindex="-1"></a><span class="st">            </span></span>
<span id="cb13-28"><a href="#cb13-28" tabindex="-1"></a><span class="st">            # regressions</span></span>
<span id="cb13-29"><a href="#cb13-29" tabindex="-1"></a><span class="st">            Y ~ b1*X + b2*M + b3*XM</span></span>
<span id="cb13-30"><a href="#cb13-30" tabindex="-1"></a></span>
<span id="cb13-31"><a href="#cb13-31" tabindex="-1"></a><span class="st">            X ~~ v1*X</span></span>
<span id="cb13-32"><a href="#cb13-32" tabindex="-1"></a><span class="st">            M ~~ v2*M</span></span>
<span id="cb13-33"><a href="#cb13-33" tabindex="-1"></a><span class="st">            XM ~~ v3*XM</span></span>
<span id="cb13-34"><a href="#cb13-34" tabindex="-1"></a><span class="st">              </span></span>
<span id="cb13-35"><a href="#cb13-35" tabindex="-1"></a><span class="st">            # Define Standardized Coefficients</span></span>
<span id="cb13-36"><a href="#cb13-36" tabindex="-1"></a><span class="st">            beta1 := b1 * sqrt(v1)</span></span>
<span id="cb13-37"><a href="#cb13-37" tabindex="-1"></a><span class="st">            beta2 := b2 * sqrt(v2)</span></span>
<span id="cb13-38"><a href="#cb13-38" tabindex="-1"></a><span class="st">            beta3 := b3 * sqrt(v1) * sqrt(v2)&#39;</span></span>
<span id="cb13-39"><a href="#cb13-39" tabindex="-1"></a></span>
<span id="cb13-40"><a href="#cb13-40" tabindex="-1"></a>mod_tspa <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">&quot;rel_X&quot;</span>, <span class="at">replacement =</span> fs_dat<span class="sc">$</span>fs_X_se[<span class="dv">1</span>]<span class="sc">^</span><span class="dv">2</span>, <span class="at">x =</span> mod_tspa)</span>
<span id="cb13-41"><a href="#cb13-41" tabindex="-1"></a>mod_tspa <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">&quot;rel_M&quot;</span>, <span class="at">replacement =</span> fs_dat<span class="sc">$</span>fs_M_se[<span class="dv">1</span>]<span class="sc">^</span><span class="dv">2</span>, <span class="at">x =</span> mod_tspa)</span>
<span id="cb13-42"><a href="#cb13-42" tabindex="-1"></a>mod_tspa <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">&quot;rel_int&quot;</span>, <span class="at">replacement =</span> fs_dat<span class="sc">$</span>fs_int_se[<span class="dv">1</span>]<span class="sc">^</span><span class="dv">2</span>, <span class="at">x =</span> mod_tspa)</span>
<span id="cb13-43"><a href="#cb13-43" tabindex="-1"></a></span>
<span id="cb13-44"><a href="#cb13-44" tabindex="-1"></a>fit_tspa <span class="ot">&lt;-</span> <span class="fu">sem</span>(mod_tspa, <span class="at">data =</span> fs_dat)</span>
<span id="cb13-45"><a href="#cb13-45" tabindex="-1"></a><span class="fu">summary</span>(fit_tspa)</span>
<span id="cb13-46"><a href="#cb13-46" tabindex="-1"></a><span class="co">#&gt; lavaan 0.6-18 ended normally after 28 iterations</span></span>
<span id="cb13-47"><a href="#cb13-47" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb13-48"><a href="#cb13-48" tabindex="-1"></a><span class="co">#&gt;   Estimator                                         ML</span></span>
<span id="cb13-49"><a href="#cb13-49" tabindex="-1"></a><span class="co">#&gt;   Optimization method                           NLMINB</span></span>
<span id="cb13-50"><a href="#cb13-50" tabindex="-1"></a><span class="co">#&gt;   Number of model parameters                        10</span></span>
<span id="cb13-51"><a href="#cb13-51" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb13-52"><a href="#cb13-52" tabindex="-1"></a><span class="co">#&gt;   Number of observations                           500</span></span>
<span id="cb13-53"><a href="#cb13-53" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb13-54"><a href="#cb13-54" tabindex="-1"></a><span class="co">#&gt; Model Test User Model:</span></span>
<span id="cb13-55"><a href="#cb13-55" tabindex="-1"></a><span class="co">#&gt;                                                       </span></span>
<span id="cb13-56"><a href="#cb13-56" tabindex="-1"></a><span class="co">#&gt;   Test statistic                                 0.000</span></span>
<span id="cb13-57"><a href="#cb13-57" tabindex="-1"></a><span class="co">#&gt;   Degrees of freedom                                 0</span></span>
<span id="cb13-58"><a href="#cb13-58" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb13-59"><a href="#cb13-59" tabindex="-1"></a><span class="co">#&gt; Parameter Estimates:</span></span>
<span id="cb13-60"><a href="#cb13-60" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb13-61"><a href="#cb13-61" tabindex="-1"></a><span class="co">#&gt;   Standard errors                             Standard</span></span>
<span id="cb13-62"><a href="#cb13-62" tabindex="-1"></a><span class="co">#&gt;   Information                                 Expected</span></span>
<span id="cb13-63"><a href="#cb13-63" tabindex="-1"></a><span class="co">#&gt;   Information saturated (h1) model          Structured</span></span>
<span id="cb13-64"><a href="#cb13-64" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb13-65"><a href="#cb13-65" tabindex="-1"></a><span class="co">#&gt; Latent Variables:</span></span>
<span id="cb13-66"><a href="#cb13-66" tabindex="-1"></a><span class="co">#&gt;                    Estimate  Std.Err  z-value  P(&gt;|z|)</span></span>
<span id="cb13-67"><a href="#cb13-67" tabindex="-1"></a><span class="co">#&gt;   X =~                                                </span></span>
<span id="cb13-68"><a href="#cb13-68" tabindex="-1"></a><span class="co">#&gt;     fs_X              1.000                           </span></span>
<span id="cb13-69"><a href="#cb13-69" tabindex="-1"></a><span class="co">#&gt;   M =~                                                </span></span>
<span id="cb13-70"><a href="#cb13-70" tabindex="-1"></a><span class="co">#&gt;     fs_M              1.000                           </span></span>
<span id="cb13-71"><a href="#cb13-71" tabindex="-1"></a><span class="co">#&gt;   XM =~                                               </span></span>
<span id="cb13-72"><a href="#cb13-72" tabindex="-1"></a><span class="co">#&gt;     fs_int            1.000                           </span></span>
<span id="cb13-73"><a href="#cb13-73" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb13-74"><a href="#cb13-74" tabindex="-1"></a><span class="co">#&gt; Regressions:</span></span>
<span id="cb13-75"><a href="#cb13-75" tabindex="-1"></a><span class="co">#&gt;                    Estimate  Std.Err  z-value  P(&gt;|z|)</span></span>
<span id="cb13-76"><a href="#cb13-76" tabindex="-1"></a><span class="co">#&gt;   Y ~                                                 </span></span>
<span id="cb13-77"><a href="#cb13-77" tabindex="-1"></a><span class="co">#&gt;     X         (b1)    0.180    0.069    2.608    0.009</span></span>
<span id="cb13-78"><a href="#cb13-78" tabindex="-1"></a><span class="co">#&gt;     M         (b2)    0.331    0.072    4.610    0.000</span></span>
<span id="cb13-79"><a href="#cb13-79" tabindex="-1"></a><span class="co">#&gt;     XM        (b3)    0.277    0.049    5.628    0.000</span></span>
<span id="cb13-80"><a href="#cb13-80" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb13-81"><a href="#cb13-81" tabindex="-1"></a><span class="co">#&gt; Covariances:</span></span>
<span id="cb13-82"><a href="#cb13-82" tabindex="-1"></a><span class="co">#&gt;                    Estimate  Std.Err  z-value  P(&gt;|z|)</span></span>
<span id="cb13-83"><a href="#cb13-83" tabindex="-1"></a><span class="co">#&gt;   X ~~                                                </span></span>
<span id="cb13-84"><a href="#cb13-84" tabindex="-1"></a><span class="co">#&gt;     M                 0.596    0.071    8.360    0.000</span></span>
<span id="cb13-85"><a href="#cb13-85" tabindex="-1"></a><span class="co">#&gt;     XM                0.035    0.086    0.404    0.686</span></span>
<span id="cb13-86"><a href="#cb13-86" tabindex="-1"></a><span class="co">#&gt;   M ~~                                                </span></span>
<span id="cb13-87"><a href="#cb13-87" tabindex="-1"></a><span class="co">#&gt;     XM               -0.186    0.087   -2.135    0.033</span></span>
<span id="cb13-88"><a href="#cb13-88" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb13-89"><a href="#cb13-89" tabindex="-1"></a><span class="co">#&gt; Variances:</span></span>
<span id="cb13-90"><a href="#cb13-90" tabindex="-1"></a><span class="co">#&gt;                    Estimate  Std.Err  z-value  P(&gt;|z|)</span></span>
<span id="cb13-91"><a href="#cb13-91" tabindex="-1"></a><span class="co">#&gt;    .fs_X              0.468                           </span></span>
<span id="cb13-92"><a href="#cb13-92" tabindex="-1"></a><span class="co">#&gt;    .fs_M              0.491                           </span></span>
<span id="cb13-93"><a href="#cb13-93" tabindex="-1"></a><span class="co">#&gt;    .fs_int            1.188                           </span></span>
<span id="cb13-94"><a href="#cb13-94" tabindex="-1"></a><span class="co">#&gt;     X         (v1)    1.000    0.093   10.772    0.000</span></span>
<span id="cb13-95"><a href="#cb13-95" tabindex="-1"></a><span class="co">#&gt;     M         (v2)    1.000    0.094   10.607    0.000</span></span>
<span id="cb13-96"><a href="#cb13-96" tabindex="-1"></a><span class="co">#&gt;     XM        (v3)    1.342    0.160    8.386    0.000</span></span>
<span id="cb13-97"><a href="#cb13-97" tabindex="-1"></a><span class="co">#&gt;    .Y                 0.563    0.046   12.311    0.000</span></span>
<span id="cb13-98"><a href="#cb13-98" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb13-99"><a href="#cb13-99" tabindex="-1"></a><span class="co">#&gt; Defined Parameters:</span></span>
<span id="cb13-100"><a href="#cb13-100" tabindex="-1"></a><span class="co">#&gt;                    Estimate  Std.Err  z-value  P(&gt;|z|)</span></span>
<span id="cb13-101"><a href="#cb13-101" tabindex="-1"></a><span class="co">#&gt;     beta1             0.180    0.069    2.617    0.009</span></span>
<span id="cb13-102"><a href="#cb13-102" tabindex="-1"></a><span class="co">#&gt;     beta2             0.331    0.071    4.676    0.000</span></span>
<span id="cb13-103"><a href="#cb13-103" tabindex="-1"></a><span class="co">#&gt;     beta3             0.277    0.053    5.236    0.000</span></span></code></pre></div>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" tabindex="-1"></a>fit_tspa <span class="ot">&lt;-</span> <span class="fu">tspa</span>(<span class="at">model =</span> <span class="st">&quot;Y ~ b1*X + b2*M + b3*X:M</span></span>
<span id="cb14-2"><a href="#cb14-2" tabindex="-1"></a><span class="st">                          beta1 := b1 * sqrt(v1)</span></span>
<span id="cb14-3"><a href="#cb14-3" tabindex="-1"></a><span class="st">                          beta2 := b2 * sqrt(v2)</span></span>
<span id="cb14-4"><a href="#cb14-4" tabindex="-1"></a><span class="st">                          beta3 := b3 * sqrt(v1) * sqrt(v2)&quot;</span>,</span>
<span id="cb14-5"><a href="#cb14-5" tabindex="-1"></a>                     <span class="at">data =</span> fs_dat,</span>
<span id="cb14-6"><a href="#cb14-6" tabindex="-1"></a>                     <span class="at">se =</span> <span class="fu">list</span>(<span class="at">X =</span> fs_dat<span class="sc">$</span>fs_X_se[<span class="dv">1</span>],</span>
<span id="cb14-7"><a href="#cb14-7" tabindex="-1"></a>                               <span class="at">M =</span> fs_dat<span class="sc">$</span>fs_M_se[<span class="dv">1</span>]))</span>
<span id="cb14-8"><a href="#cb14-8" tabindex="-1"></a><span class="fu">summary</span>(fit_tspa)</span>
<span id="cb14-9"><a href="#cb14-9" tabindex="-1"></a><span class="co">#&gt; lavaan 0.6-18 ended normally after 29 iterations</span></span>
<span id="cb14-10"><a href="#cb14-10" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb14-11"><a href="#cb14-11" tabindex="-1"></a><span class="co">#&gt;   Estimator                                         ML</span></span>
<span id="cb14-12"><a href="#cb14-12" tabindex="-1"></a><span class="co">#&gt;   Optimization method                           NLMINB</span></span>
<span id="cb14-13"><a href="#cb14-13" tabindex="-1"></a><span class="co">#&gt;   Number of model parameters                        10</span></span>
<span id="cb14-14"><a href="#cb14-14" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb14-15"><a href="#cb14-15" tabindex="-1"></a><span class="co">#&gt;   Number of observations                           500</span></span>
<span id="cb14-16"><a href="#cb14-16" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb14-17"><a href="#cb14-17" tabindex="-1"></a><span class="co">#&gt; Model Test User Model:</span></span>
<span id="cb14-18"><a href="#cb14-18" tabindex="-1"></a><span class="co">#&gt;                                                       </span></span>
<span id="cb14-19"><a href="#cb14-19" tabindex="-1"></a><span class="co">#&gt;   Test statistic                                 0.000</span></span>
<span id="cb14-20"><a href="#cb14-20" tabindex="-1"></a><span class="co">#&gt;   Degrees of freedom                                 0</span></span>
<span id="cb14-21"><a href="#cb14-21" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb14-22"><a href="#cb14-22" tabindex="-1"></a><span class="co">#&gt; Parameter Estimates:</span></span>
<span id="cb14-23"><a href="#cb14-23" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb14-24"><a href="#cb14-24" tabindex="-1"></a><span class="co">#&gt;   Standard errors                             Standard</span></span>
<span id="cb14-25"><a href="#cb14-25" tabindex="-1"></a><span class="co">#&gt;   Information                                 Expected</span></span>
<span id="cb14-26"><a href="#cb14-26" tabindex="-1"></a><span class="co">#&gt;   Information saturated (h1) model          Structured</span></span>
<span id="cb14-27"><a href="#cb14-27" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb14-28"><a href="#cb14-28" tabindex="-1"></a><span class="co">#&gt; Latent Variables:</span></span>
<span id="cb14-29"><a href="#cb14-29" tabindex="-1"></a><span class="co">#&gt;                    Estimate  Std.Err  z-value  P(&gt;|z|)</span></span>
<span id="cb14-30"><a href="#cb14-30" tabindex="-1"></a><span class="co">#&gt;   X =~                                                </span></span>
<span id="cb14-31"><a href="#cb14-31" tabindex="-1"></a><span class="co">#&gt;     fs_X              1.000                           </span></span>
<span id="cb14-32"><a href="#cb14-32" tabindex="-1"></a><span class="co">#&gt;   M =~                                                </span></span>
<span id="cb14-33"><a href="#cb14-33" tabindex="-1"></a><span class="co">#&gt;     fs_M              1.000                           </span></span>
<span id="cb14-34"><a href="#cb14-34" tabindex="-1"></a><span class="co">#&gt;   X.M =~                                              </span></span>
<span id="cb14-35"><a href="#cb14-35" tabindex="-1"></a><span class="co">#&gt;     fs_X.M            1.000                           </span></span>
<span id="cb14-36"><a href="#cb14-36" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb14-37"><a href="#cb14-37" tabindex="-1"></a><span class="co">#&gt; Regressions:</span></span>
<span id="cb14-38"><a href="#cb14-38" tabindex="-1"></a><span class="co">#&gt;                    Estimate  Std.Err  z-value  P(&gt;|z|)</span></span>
<span id="cb14-39"><a href="#cb14-39" tabindex="-1"></a><span class="co">#&gt;   Y ~                                                 </span></span>
<span id="cb14-40"><a href="#cb14-40" tabindex="-1"></a><span class="co">#&gt;     X         (b1)    0.180    0.069    2.608    0.009</span></span>
<span id="cb14-41"><a href="#cb14-41" tabindex="-1"></a><span class="co">#&gt;     M         (b2)    0.331    0.072    4.610    0.000</span></span>
<span id="cb14-42"><a href="#cb14-42" tabindex="-1"></a><span class="co">#&gt;     X.M       (b3)    0.277    0.049    5.628    0.000</span></span>
<span id="cb14-43"><a href="#cb14-43" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb14-44"><a href="#cb14-44" tabindex="-1"></a><span class="co">#&gt; Covariances:</span></span>
<span id="cb14-45"><a href="#cb14-45" tabindex="-1"></a><span class="co">#&gt;                    Estimate  Std.Err  z-value  P(&gt;|z|)</span></span>
<span id="cb14-46"><a href="#cb14-46" tabindex="-1"></a><span class="co">#&gt;   X ~~                                                </span></span>
<span id="cb14-47"><a href="#cb14-47" tabindex="-1"></a><span class="co">#&gt;     M                 0.596    0.071    8.360    0.000</span></span>
<span id="cb14-48"><a href="#cb14-48" tabindex="-1"></a><span class="co">#&gt;     X.M               0.035    0.086    0.404    0.686</span></span>
<span id="cb14-49"><a href="#cb14-49" tabindex="-1"></a><span class="co">#&gt;   M ~~                                                </span></span>
<span id="cb14-50"><a href="#cb14-50" tabindex="-1"></a><span class="co">#&gt;     X.M              -0.186    0.087   -2.135    0.033</span></span>
<span id="cb14-51"><a href="#cb14-51" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb14-52"><a href="#cb14-52" tabindex="-1"></a><span class="co">#&gt; Variances:</span></span>
<span id="cb14-53"><a href="#cb14-53" tabindex="-1"></a><span class="co">#&gt;                    Estimate  Std.Err  z-value  P(&gt;|z|)</span></span>
<span id="cb14-54"><a href="#cb14-54" tabindex="-1"></a><span class="co">#&gt;    .fs_X              0.468                           </span></span>
<span id="cb14-55"><a href="#cb14-55" tabindex="-1"></a><span class="co">#&gt;    .fs_M              0.491                           </span></span>
<span id="cb14-56"><a href="#cb14-56" tabindex="-1"></a><span class="co">#&gt;    .fs_X.M            1.188                           </span></span>
<span id="cb14-57"><a href="#cb14-57" tabindex="-1"></a><span class="co">#&gt;     X         (v1)    1.000    0.093   10.772    0.000</span></span>
<span id="cb14-58"><a href="#cb14-58" tabindex="-1"></a><span class="co">#&gt;     M         (v2)    1.000    0.094   10.607    0.000</span></span>
<span id="cb14-59"><a href="#cb14-59" tabindex="-1"></a><span class="co">#&gt;     X.M       (v3)    1.342    0.160    8.386    0.000</span></span>
<span id="cb14-60"><a href="#cb14-60" tabindex="-1"></a><span class="co">#&gt;    .Y                 0.563    0.046   12.311    0.000</span></span>
<span id="cb14-61"><a href="#cb14-61" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb14-62"><a href="#cb14-62" tabindex="-1"></a><span class="co">#&gt; Defined Parameters:</span></span>
<span id="cb14-63"><a href="#cb14-63" tabindex="-1"></a><span class="co">#&gt;                    Estimate  Std.Err  z-value  P(&gt;|z|)</span></span>
<span id="cb14-64"><a href="#cb14-64" tabindex="-1"></a><span class="co">#&gt;     beta1             0.180    0.069    2.617    0.009</span></span>
<span id="cb14-65"><a href="#cb14-65" tabindex="-1"></a><span class="co">#&gt;     beta2             0.331    0.071    4.676    0.000</span></span>
<span id="cb14-66"><a href="#cb14-66" tabindex="-1"></a><span class="co">#&gt;     beta3             0.277    0.053    5.236    0.000</span></span></code></pre></div>
<div id="lrt-based-p-value-3" class="section level3">
<h3>LRT Based P-value</h3>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" tabindex="-1"></a>tspa_lrtp <span class="ot">&lt;-</span> <span class="fu">lrtp</span>(fit_tspa)</span></code></pre></div>
</div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
